var Pn=Object.defineProperty;var Rn=(t,e,n)=>e in t?Pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Qe=(t,e,n)=>(Rn(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var Rt=(t=>(t[t.SECOND=1e3]="SECOND",t[t.MINUTE=6e4]="MINUTE",t[t.HALF_HOUR=18e5]="HALF_HOUR",t[t.HOUR=36e5]="HOUR",t[t.DAY=864e5]="DAY",t[t.WEEK=6048e5]="WEEK",t[t.MONTH=2592e6]="MONTH",t))(Rt||{});class Je{static set(e,n,l,o){const r=new Date;r.setTime(r.getTime()+l*o);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${n};${i};path=/`}static get(e){const n=`${e}=`,l=document.cookie.split(";");for(let o=0;o<l.length;o++){let r=l[o];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function Le(t){return{ok:!0,value:t}}function oe(t){return{ok:!1,error:t}}var ce=(t=>(t.rs3="rs3",t.osrs="osrs",t))(ce||{}),Ve=(t=>(t.official="Official",t.runelite="RuneLite",t.hdos="HDOS",t))(Ve||{});const jt={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class at{static parseTokenResponse(e){try{const n=JSON.parse(e),l=n.id_token.split(".");if(l.length!==3){const i=`Malformed id_token: ${l.length} sections, expected 3`;return oe(i)}const o=JSON.parse(atob(l[0]));if(o.typ!=="JWT"){const i=`Bad id_token header: typ ${o.typ}, expected JWT`;return oe(i)}const r=JSON.parse(atob(l[1]));return Le({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:r.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return oe("Unable to parse token response")}}static parseSessionResponse(e){try{const n=JSON.parse(e);return n.sessionId?Le(n.sessionId):oe("sessionId does not exist on parsed object")}catch{return oe("Unable to parse session response")}}static decodeBolt(e){const n={};for(const l in e){const o=l,r=e[o];typeof r=="string"?n[o]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?n[o]=r.map(i=>atob(i)):n[o]=r}return n}}var It=(t=>(t.Windows="windows",t.Linux="linux",t.MacOS="mac",t))(It||{});const R={env:at.decodeBolt(s()),platform:null,rs3debInstalledHash:null,rs3exeInstalledHash:null,rs3appInstalledHash:null,osrsexeInstalledHash:null,osrsappInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasLibArchive:!1,hasBoltPlugins:!1,pluginConfig:{}};class yt{static async makeLoginUrl(e){const n=new TextEncoder().encode(e.pkceCodeVerifier),l=await crypto.subtle.digest("SHA-256",n);let o="";const r=new Uint8Array(l);for(let a=0;a<r.byteLength;a++)o+=String.fromCharCode(r[a]);const i=btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(l){return e[l%e.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=n.length-1,o=crypto.getRandomValues(new Uint8Array(12));return Array.from(o).map(r=>Math.round(r*(l-0)/255+0)).map(r=>n[r]).join("")}}const Ge=class Ge{static async openLoginWindow(e,n,l){if(Ge.pendingLoginWindow!==null)return Ge.pendingLoginWindow.window.focus();const o=yt.makeRandomState(),r=yt.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let c="";const u=new Uint8Array(a);for(let g=0;g<u.byteLength;g++)c+=String.fromCharCode(u[g]);const d=btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:l,redirect_uri:n,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:o}),b=`${e}/oauth2/auth?${f.toString()}`;Je.set("auth_verifier",r,10,Rt.MINUTE),Ge.pendingLoginWindow=window.open(b,"","width=480,height=720")}static navigateToAuthConsent(e,n,l){const o=yt.makeRandomState(),r=new URLSearchParams({id_token_hint:n,nonce:l,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:o,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;Je.set("auth_nonce",l,10,Rt.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(n=>{if(e.expiry-Date.now()<3e4){const l=new URLSearchParams({grant_type:"refresh_token",client_id:R.env.clientid,refresh_token:e.refresh_token}),o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=at.parseTokenResponse(o.response);i.ok?n(Le(i.value)):n(oe(0))}else n(oe(o.status))},o.onerror=()=>{n(oe(0))};const r=R.env.origin.concat("/oauth2/token");o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Accept","application/json"),o.send(l)}else n(Le(e))})}static async getOAuthToken(e,n,l,o,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const d=at.parseTokenResponse(c.response);return d.ok?a(Le(d.value)):a(oe(d.error))}else return a(oe(`Error: from ${i}: ${c.status}: ${c.response}`))},c.open("POST",i,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("Accept","application/json");const u=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:r,code_verifier:l,redirect_uri:o});c.send(u)})}static revokeOauthCreds(e){const n=`${R.env.origin}/oauth2/revoke`;return new Promise(l=>{const o=new XMLHttpRequest;o.open("POST",n,!0),o.onreadystatechange=()=>{o.readyState==4&&l(o.status)},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:R.env.clientid});o.send(r)})}static async getSessionId(e,n){const l=`${e}/sessions`;return new Promise(o=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=at.parseSessionResponse(r.response);return a.ok?o(Le(a.value)):o(oe(a.error))}else oe(`Error: from ${l}: ${r.status}: ${r.response}`)},r.open("POST",l,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:n};r.send(JSON.stringify(i))})}static validateIdToken(e,n){const l=e.split(".");if(l.length!==3)return oe(`Malformed id_token: ${l.length} sections, expected 3`);const o=JSON.parse(atob(l[0]));return o.typ!=="JWT"?oe(`Bad id_token header: typ ${o.typ}, expected JWT`):JSON.parse(atob(l[1])).nonce!==n?oe("Incorrect nonce in id_token"):Le(void 0)}};Qe(Ge,"pendingLoginWindow",null);let Se=Ge;class ut{static async buildSession(e,n){const l=await ut.getUser(e.sub,e.access_token);if(!l.ok)return oe(`Failed to fetch user. Status: ${l.error}`);const o=await ut.getUserAccounts(n);return o.ok?Le({user:l.value,accounts:o.value,tokens:e,session_id:n}):oe(`Failed to fetch game accounts. Status: ${o.error}`)}static getUser(e,n){return new Promise(l=>{const o=`${R.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);l(Le(i))}else l(oe(r.status))},r.open("GET",o,!0),r.setRequestHeader("Authorization","Bearer ".concat(n)),r.send()})}static getUserAccounts(e){const n=`${R.env.auth_api}/accounts`;return new Promise(l=>{const o=new XMLHttpRequest;o.onreadystatechange=async()=>{if(o.readyState==4)if(o.status==200){const r=JSON.parse(o.response);l(Le(r))}else l(oe(o.status))},o.open("GET",n,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer ".concat(e)),o.send()})}}function B(){}function In(t,e){for(const n in e)t[n]=e[n];return t}function Un(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function mn(t){return t()}function Et(){return Object.create(null)}function re(t){t.forEach(mn)}function ft(t){return typeof t=="function"}function _e(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let it;function Ut(t,e){return t===e?!0:(it||(it=document.createElement("a")),it.href=e,t===it.href)}function Hn(t){return Object.keys(t).length===0}function bn(t,...e){if(t==null){for(const l of e)l(void 0);return B}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ve(t){let e;return bn(t,n=>e=n)(),e}function ke(t,e,n){t.$$.on_destroy.push(bn(e,n))}function pt(t,e,n,l){if(t){const o=kn(t,e,n,l);return t[0](o)}}function kn(t,e,n,l){return t[1]&&l?In(n.ctx.slice(),t[1](l(e))):n.ctx}function _t(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|o[a];return r}return e.dirty|o}return e.dirty}function gt(t,e,n,l,o,r){if(o){const i=kn(e,n,l,r);t.p(i,o)}}function ht(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function Re(t,e,n){return t.set(n),e}function On(t){return t&&ft(t.destroy)?t.destroy:B}function k(t,e){t.appendChild(e)}function v(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function Ae(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function z(t){return document.createTextNode(t)}function P(){return z(" ")}function Ie(){return z("")}function N(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function Tn(t){return function(e){e.target===this&&t.call(this,e)}}function _(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function xn(t){return Array.from(t.childNodes)}function pe(t,e){e=""+e,t.data!==e&&(t.data=e)}function K(t,e){t.value=e??""}function xe(t,e,n){for(let l=0;l<t.options.length;l+=1){const o=t.options[l];if(o.__value===e){o.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Tt(t){const e=t.querySelector(":checked");return e&&e.__value}function ue(t,e,n){t.classList.toggle(e,!!n)}function Nn(t,e,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:l})}let tt;function He(t){tt=t}function mt(){if(!tt)throw new Error("Function called outside component initialization");return tt}function wn(t){mt().$$.on_mount.push(t)}function jn(t){mt().$$.on_destroy.push(t)}function En(){const t=mt();return(e,n,{cancelable:l=!1}={})=>{const o=t.$$.callbacks[e];if(o){const r=Nn(e,n,{cancelable:l});return o.slice().forEach(i=>{i.call(t,r)}),!r.defaultPrevented}return!0}}const We=[],Pe=[];let Xe=[];const Mt=[],Mn=Promise.resolve();let Ht=!1;function An(){Ht||(Ht=!0,Mn.then(xt))}function Ye(t){Xe.push(t)}const $t=new Set;let De=0;function xt(){if(De!==0)return;const t=tt;do{try{for(;De<We.length;){const e=We[De];De++,He(e),Dn(e.$$)}}catch(e){throw We.length=0,De=0,e}for(He(null),We.length=0,De=0;Pe.length;)Pe.pop()();for(let e=0;e<Xe.length;e+=1){const n=Xe[e];$t.has(n)||($t.add(n),n())}Xe.length=0}while(We.length);for(;Mt.length;)Mt.pop()();Ht=!1,$t.clear(),He(t)}function Dn(t){if(t.fragment!==null){t.update(),re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ye)}}function Bn(t){const e=[],n=[];Xe.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Xe=e}const ct=new Set;let Ee;function nt(){Ee={r:0,c:[],p:Ee}}function st(){Ee.r||re(Ee.c),Ee=Ee.p}function q(t,e){t&&t.i&&(ct.delete(t),t.i(e))}function W(t,e,n,l){if(t&&t.o){if(ct.has(t))return;ct.add(t),Ee.c.push(()=>{ct.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function dt(t,e){const n=e.token={};function l(o,r,i,a){if(e.token!==n)return;e.resolved=a;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=a);const u=o&&(e.current=o)(c);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,b)=>{b!==r&&f&&(nt(),W(f,1,1,()=>{e.blocks[b]===f&&(e.blocks[b]=null)}),st())}):e.block.d(1),u.c(),q(u,1),u.m(e.mount(),e.anchor),d=!0),e.block=u,e.blocks&&(e.blocks[r]=u),d&&xt()}if(Un(t)){const o=mt();if(t.then(r=>{He(o),l(e.then,1,e.value,r),He(null)},r=>{if(He(o),l(e.catch,2,e.error,r),He(null),!e.hasCatch)throw r}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,t),!0;e.resolved=t}}function vn(t,e,n){const l=e.slice(),{resolved:o}=t;t.current===t.then&&(l[t.value]=o),t.current===t.catch&&(l[t.error]=o),t.block.p(l,n)}function ge(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Fn(t,e){t.d(1),e.delete(t.key)}function qn(t,e,n,l,o,r,i,a,c,u,d,f){let b=t.length,g=r.length,p=b;const y={};for(;p--;)y[t[p].key]=p;const h=[],L=new Map,$=new Map,x=[];for(p=g;p--;){const S=f(o,r,p),C=n(S);let T=i.get(C);T?l&&x.push(()=>T.p(S,e)):(T=u(C,S),T.c()),L.set(C,h[p]=T),C in y&&$.set(C,Math.abs(p-y[C]))}const I=new Set,O=new Set;function U(S){q(S,1),S.m(a,d),i.set(S.key,S),d=S.first,g--}for(;b&&g;){const S=h[g-1],C=t[b-1],T=S.key,j=C.key;S===C?(d=S.first,b--,g--):L.has(j)?!i.has(T)||I.has(T)?U(S):O.has(j)?b--:$.get(T)>$.get(j)?(O.add(T),U(S)):(I.add(j),b--):(c(C,i),b--)}for(;b--;){const S=t[b];L.has(S.key)||c(S,i)}for(;g;)U(h[g-1]);return re(x),h}function de(t){t&&t.c()}function ie(t,e,n){const{fragment:l,after_update:o}=t.$$;l&&l.m(e,n),Ye(()=>{const r=t.$$.on_mount.map(mn).filter(ft);t.$$.on_destroy?t.$$.on_destroy.push(...r):re(r),t.$$.on_mount=[]}),o.forEach(Ye)}function ae(t,e){const n=t.$$;n.fragment!==null&&(Bn(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function zn(t,e){t.$$.dirty[0]===-1&&(We.push(t),An(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function he(t,e,n,l,o,r,i=null,a=[-1]){const c=tt;He(t);const u=t.$$={fragment:null,ctx:[],props:r,update:B,not_equal:o,bound:Et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Et(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};i&&i(u.root);let d=!1;if(u.ctx=n?n(t,e.props||{},(f,b,...g)=>{const p=g.length?g[0]:b;return u.ctx&&o(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),d&&zn(t,f)),b}):[],u.update(),d=!0,re(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const f=xn(e.target);u.fragment&&u.fragment.l(f),f.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&q(t.$$.fragment),ie(t,e.target,e.anchor),xt()}He(c)}class me{constructor(){Qe(this,"$$");Qe(this,"$$set")}$destroy(){ae(this,1),this.$destroy=B}$on(e,n){if(!ft(n))return B;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Hn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Wn="4",Be=[];function Me(t,e=B){let n;const l=new Set;function o(a){if(_e(t,a)&&(t=a,n)){const c=!Be.length;for(const u of l)u[1](),Be.push(u,t);if(c){for(let u=0;u<Be.length;u+=2)Be[u][0](Be[u+1]);Be.length=0}}}function r(a){o(a(t))}function i(a,c=B){const u=[a,c];return l.add(u),l.size===1&&(n=e(o,r)||B),a(t),()=>{l.delete(u),l.size===0&&n&&(n(),n=null)}}return{set:o,update:r,subscribe:i}}var et=(t=>(t.info="info",t.warn="warn",t.error="error",t))(et||{});class Jn{constructor(){Qe(this,"logs",Me([]))}_addLog(e,n){this.logs.update(l=>(l.unshift({date:new Date,severity:e,content:n}),l))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,n){this.logs.update(l=>(l[e]&&(l[e].content=n),l))}}const A=new Jn;function Gn(t,e){let n=!1;return t.subscribe(l=>{n?e(l):n=!0})}const Vn={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,discard_expired_sessions:!0,rs_launch_command:null,osrs_launch_command:null,runelite_custom_jar:null,runelite_launch_command:null,hdos_launch_command:null,selected:{game:ce.osrs,client:Ve.runelite,user_id:null},userDetails:{}};function Xn(){const e=new URLSearchParams(window.location.search).get("config");function n(o){return typeof o=="object"&&typeof o.use_dark_theme=="boolean"&&typeof o.rs_plugin_loader=="boolean"&&typeof o.close_after_launch=="boolean"&&typeof o.check_announcements=="boolean"&&typeof o.flatpak_rich_presence=="boolean"&&typeof o.runelite_use_custom_jar=="boolean"&&typeof o.selected=="object"&&Object.values(ce).includes(o.selected.game)&&Object.values(Ve).includes(o.selected.client)&&(typeof o.selected.user_id=="string"||o.selected.user_id===null)&&typeof o.userDetails=="object"}const{config:l}=M;if(e)try{const o=JSON.parse(e);typeof o.check_announcements>"u"&&(o.check_announcements=!0,M.configHasPendingChanges=!0),typeof o.close_after_launch>"u"&&(o.close_after_launch=!1,M.configHasPendingChanges=!0),typeof o.discard_expired_sessions>"u"&&(o.discard_expired_sessions=!0,M.configHasPendingChanges=!0),n(o)?l.set(o):(A.error("The config saved on disk is not the correct format. It has been restored to default."),M.configHasPendingChanges=!0)}catch{A.error("Unable to parse config, restoring to default"),M.configHasPendingChanges=!0}else M.configHasPendingChanges=!0;Gn(M.config,()=>{M.configHasPendingChanges=!0})}const M={initialized:Me(!1),configHasPendingChanges:!1,pluginConfigHasPendingChanges:!1,config:Me(Vn),sessions:Me([])};let St=!1,Ct=!1;class ne{static async login(e,n){const l=await ut.buildSession(e,n);if(!l.ok)return oe(l.error);const o=l.value,i=ve(M.sessions).findIndex(a=>a.user.userId===e.sub);return i!==-1?M.sessions.update(a=>(a[i]=o,a)):(M.sessions.update(a=>(a.push(o),a)),M.config.update(a=>(a.selected.user_id=o.user.userId,a))),Le(o)}static async logout(e){const{sessions:n,config:l}=M;return n.update(o=>{const r=o.findIndex(i=>i.user.userId===e);return r>-1&&(Se.revokeOauthCreds(o[r].tokens.access_token),o.splice(r,1)),o}),l.update(o=>(typeof o.userDetails[e]<"u"&&delete o.userDetails[e],o.selected.user_id===e&&(o.selected.user_id=null),o)),ve(n)}static postJSON(e,n,l=null){const o=JSON.stringify(n);return fetch(e,{method:"POST",body:o,headers:{"Content-Type":"application/json"}}).then(i=>{i.ok||i.text().then(a=>A.error(`${e} error: ${i.status}: ${a}`)),l&&l(i)})}static saveConfig(e=!0){if(St||e&&!M.configHasPendingChanges)return;St=!0;const n=ve(M.config);return n.rs_launch_command===""&&(n.rs_launch_command=null),n.osrs_launch_command===""&&(n.osrs_launch_command=null),n.runelite_launch_command===""&&(n.runelite_launch_command=null),n.hdos_launch_command===""&&(n.hdos_launch_command=null),this.postJSON("/save-config",n,()=>St=!1),n}static savePluginConfig(e=!0){Ct||e&&!M.pluginConfigHasPendingChanges||(Ct=!0,this.postJSON("/save-plugin-config",R.pluginConfig,()=>Ct=!1))}static async saveCredentials(){return this.postJSON("/save-credentials",ve(M.sessions))}static async openFilePicker(){const e=await fetch("/jar-file-picker");return e.status===200?e.text():null}static findSession(e){return ve(M.sessions).find(l=>l.user.userId===e)}static findAccount(e,n){return e.find(l=>l.accountId==n)}}const Ot=Me([]);typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Wn);function Yn(t){let e,n;const l=t[4].default,o=pt(l,t,t[3],null);return{c(){e=m("main"),o&&o.c(),_(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),ue(e,"dark",t[0])},m(r,i){v(r,e,i),o&&o.m(e,null),n=!0},p(r,[i]){o&&o.p&&(!n||i&8)&&gt(o,l,r,r[3],n?_t(l,r[3],i,null):ht(r[3]),null),(!n||i&1)&&ue(e,"dark",r[0])},i(r){n||(q(o,r),n=!0)},o(r){W(o,r),n=!1},d(r){r&&w(e),o&&o.d(r)}}}function Zn(t,e,n){let l,o,{$$slots:r={},$$scope:i}=e;const{config:a}=M;return ke(t,a,c=>n(2,o=c)),t.$$set=c=>{"$$scope"in c&&n(3,i=c.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&n(0,l=o.use_dark_theme)},[l,a,o,i,r]}class yn extends me{constructor(e){super(),he(this,e,Zn,Yn,_e,{})}}function Kn(t){let e;return{c(){e=m("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',_(e,"class","flex h-full items-center justify-center")},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Qn(t){let e,n;return e=new yn({props:{$$slots:{default:[Kn]},$$scope:{ctx:t}}}),{c(){de(e.$$.fragment)},m(l,o){ie(e,l,o),n=!0},p(l,[o]){const r={};o&32&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(q(e.$$.fragment,l),n=!0)},o(l){W(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function es(t){const e=window.opener;R.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function n(i){const a=Je.get("auth_verifier");if(!a)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:c,redirect:u}=R.env,d=await Se.getOAuthToken(R.env.origin,c,a,u,i);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function l(i){const a=Je.get("auth_nonce"),c=Se.validateIdToken(i,a??"");if(!c.ok)return o(c.error),null;const u=await Se.getSessionId(R.env.auth_api,i);return u.ok?u.value:(o(`Unable to retreive session id. ${u.error}`),null)}function o(i){r({type:"authFailed",reason:i}),fetch("/close")}function r(i){e.postMessage(i,window.location.origin)}return wn(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),c=i.get("state"),u=i.get("id_token");if(u==null&&a&&c){const d=await n(a);if(!d)return o("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();Se.navigateToAuthConsent(R.env.origin,d.id_token,f)}else if(u&&a&&c){const d=await l(u);if(!d)return o("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),jn(()=>{Je.remove("auth_verifier"),Je.remove("auth_nonce")}),[]}class ts extends me{constructor(e){super(),he(this,e,es,Qn,_e,{})}}function At(t){let e,n,l;return{c(){e=m("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',_(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(o,r){v(o,e,r),n||(l=N(e,"click",t[2]),n=!0)},p:B,d(o){o&&w(e),n=!1,l()}}}function Dt(t){let e;const n=t[7].default,l=pt(n,t,t[6],null);return{c(){l&&l.c()},m(o,r){l&&l.m(o,r),e=!0},p(o,r){l&&l.p&&(!e||r&64)&&gt(l,n,o,o[6],e?_t(n,o[6],r,null):ht(o[6]),null)},i(o){e||(q(l,o),e=!0)},o(o){W(l,o),e=!1},d(o){l&&l.d(o)}}}function ns(t){let e,n,l,o,r,i,a=t[1]&&At(t),c=t[4]&&Dt(t);return{c(){e=m("dialog"),a&&a.c(),n=P(),c&&c.c(),_(e,"class",l=t[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),ue(e,"backdrop:cursor-pointer",t[1])},m(u,d){v(u,e,d),a&&a.m(e,null),k(e,n),c&&c.m(e,null),t[8](e),o=!0,r||(i=[N(e,"keydown",t[9]),N(e,"mousedown",Tn(t[10]))],r=!0)},p(u,[d]){u[1]?a?a.p(u,d):(a=At(u),a.c(),a.m(e,n)):a&&(a.d(1),a=null),u[4]?c?(c.p(u,d),d&16&&q(c,1)):(c=Dt(u),c.c(),q(c,1),c.m(e,null)):c&&(nt(),W(c,1,1,()=>{c=null}),st()),(!o||d&1&&l!==(l=u[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&_(e,"class",l),(!o||d&3)&&ue(e,"backdrop:cursor-pointer",u[1])},i(u){o||(q(c),o=!0)},o(u){W(c),o=!1},d(u){u&&w(e),a&&a.d(),c&&c.d(),t[8](null),r=!1,re(i)}}}function ss(t,e,n){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,c=!1;const u=En();function d(){a.showModal(),n(4,c=!0)}function f(){u("close"),a.close(),n(4,c=!1)}function b(y){Pe[y?"unshift":"push"](()=>{a=y,n(3,a)})}const g=y=>{y.key==="Escape"&&(y.preventDefault(),i&&f())},p=()=>{i&&f()};return t.$$set=y=>{"class"in y&&n(0,r=y.class),"canSelfClose"in y&&n(1,i=y.canSelfClose),"$$scope"in y&&n(6,o=y.$$scope)},[r,i,f,a,c,d,o,l,b,g,p]}class bt extends me{constructor(e){super(),he(this,e,ss,ns,_e,{class:0,canSelfClose:1,open:5,close:2})}get open(){return this.$$.ctx[5]}get close(){return this.$$.ctx[2]}}function ls(t){let e,n,l,o,r,i,a;return{c(){e=m("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,n=P(),l=m("p"),l.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,o=P(),r=m("button"),r.textContent="I Understand",_(e,"class","p-2"),_(l,"class","p-2"),_(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(c,u){v(c,e,u),v(c,n,u),v(c,l,u),v(c,o,u),v(c,r,u),i||(a=N(r,"click",t[2]),i=!0)},p:B,d(c){c&&(w(e),w(n),w(l),w(o),w(r)),i=!1,a()}}}function os(t){let e,n,l={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[ls]},$$scope:{ctx:t}};return e=new bt({props:l}),t[3](e),{c(){de(e.$$.fragment)},m(o,r){ie(e,o,r),n=!0},p(o,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){t[3](null),ae(e,o)}}}function rs(t,e,n){let l;const{sessions:o}=M;ke(t,o,c=>n(4,l=c));let r;wn(()=>{l.length==0&&r.open()});const i=()=>r.close();function a(c){Pe[c?"unshift":"push"](()=>{r=c,n(0,r)})}return[r,o,i,a]}class is extends me{constructor(e){super(),he(this,e,rs,os,_e,{})}}const ye={method:"GET"},as={"Content-Type":"application/octet-stream"};let Lt=null;const cs=2*60*1e3,us="https://api.github.com/repos/runelite/launcher/releases",ds="https://cdn.hdos.dev/client/getdown.txt",kt=t=>t?{method:"POST",headers:as,body:t}:ye,Oe=(t,e,n,l)=>{fetch(t,e).then(o=>{o.ok?n(o):(o.text().then(r=>A.error(`request failed: ${o.url}: ${o.status}: ${r}`)),l())}).catch(()=>{A.error(`request failed: ${t}: connection error`),l()})},Nt=async(t,e,n,l,o)=>{const r=b=>{A.error(`error downloading: ${b}`),l()};A.info(e);const i=b=>A.updateLogAtIndex(0,`${e} ${b}`);if(!t.body)return r("no HTTP response body");const a=t.body.getReader();if(!a)return r("invalid HTTP response");const c=t.headers.get("content-length")??o;if(!c)return r("cannot estimate download size");const u=parseInt(c);if(!c)return r("cannot estimate download size");const d=new Uint8Array(u);let f=0;for(;;){const b=await a.read();if(b.done)break;const g=b.value;d.set(g,f),f+=g.length;const p=(Math.round(1e3*f/u)/10).toFixed(1);i(p)}i("done"),n(d)};function fs(t,e,n){ne.saveConfig();const l=(a,c)=>{const u={},d=ve(M.config);a&&(u.hash=a),t&&(u.jx_session_id=t),e&&(u.jx_character_id=e),n&&(u.jx_display_name=n),d.rs_launch_command&&d.rs_launch_command.length>0&&(u.launch_command=d.rs_launch_command),d.rs_plugin_loader&&(u.plugin_loader="1"),d.use_custom_rs_config_uri&&d.rs_config_uri?u.config_uri=d.rs_config_uri:u.config_uri=R.env.default_config_uri,fetch("/launch-rs3-deb?".concat(new URLSearchParams(u).toString()),kt(c)).then(f=>{f.text().then(b=>A.info(`game launch status: '${b.trim()}'`)),f.ok&&(a&&(R.rs3debInstalledHash=a),d.close_after_launch&&!d.rs_plugin_loader&&fetch("/close"))})},o=()=>{R.rs3debInstalledHash&&l()},r=R.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");Oe(i,ye,a=>a.text().then(c=>{const u=Object.fromEntries(c.split(`
`).map(d=>d.split(": ")));if(!u.Filename||!u.Size||!u.SHA256){A.error(`could not parse package data from URL: ${i}`),o();return}if(u.SHA256===R.rs3debInstalledHash){A.info("game client is up-to-date"),l();return}Oe(r.concat(u.Filename),ye,d=>Nt(d,"downloading RS3 client...",f=>l(u.SHA256,f),l,u.Size),o)}),o)}function $n(t,e,n,l){ne.saveConfig();const o=l?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=ve(M.config),i=(c,u,d)=>{const f={};c&&(f.id=c),d&&(f.jar_path=d),t&&(f.jx_session_id=t),e&&(f.jx_character_id=e),n&&(f.jx_display_name=n),r.runelite_launch_command&&r.runelite_launch_command!==""&&(f.launch_command=r.runelite_launch_command),r.flatpak_rich_presence&&(f.flatpak_rich_presence=""),fetch(o.concat(new URLSearchParams(f).toString()),kt(u)).then(b=>{b.text().then(g=>A.info(`game launch status: '${g.trim()}'`)),b.ok&&(c&&(R.runeLiteInstalledId=c),r.close_after_launch&&!l&&fetch("/close"))})},a=()=>{R.runeLiteInstalledId&&i()};if(r.runelite_use_custom_jar){i(null,null,r.runelite_custom_jar);return}if(R.runeLiteInstalledId!==null&&Lt!==null&&Lt+cs>Date.now()){i();return}Oe(us,ye,c=>c.json().then(u=>{Lt=Date.now();const d=u.map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");if(!d){A.info("note: no runelite releases found, so skipping update check"),a();return}if(d.id==R.runeLiteInstalledId){A.info("game is up-to-date"),i();return}Oe(d.browser_download_url,ye,f=>Nt(f,"downloading RuneLite launcher...",b=>i(d.id,b),a,d.size),a)}),a)}function ps(t,e,n){ne.saveConfig();const l=ve(M.config),o=(i,a)=>{const c={};i&&(c.version=i),t&&(c.jx_session_id=t),e&&(c.jx_character_id=e),n&&(c.jx_display_name=n),l.hdos_launch_command&&l.hdos_launch_command.length>0&&(c.launch_command=l.hdos_launch_command),fetch("/launch-hdos-jar?".concat(new URLSearchParams(c).toString()),kt(a)).then(u=>{u.text().then(d=>A.info(`game launch status: '${d.trim()}'`)),u.ok&&(i&&(R.hdosInstalledVersion=i),l.close_after_launch&&fetch("/close"))})},r=()=>{R.hdosInstalledVersion&&o()};Oe(ds,ye,i=>i.text().then(a=>{const c=a.match(/^launcher\.version *= *(.*?)$/m);if(!c||c.length<2){A.error("couldn't parse latest launcher version"),r();return}const u=c[1];if(u===R.hdosInstalledVersion){A.info("game is up-to-date"),o();return}Oe(`https://cdn.hdos.dev/launcher/v${u}/hdos-launcher.jar`,ye,d=>Nt(d,"downloading HDOS launcher...",f=>o(u,f),r),r)}),r)}function Pt(){fetch("/list-game-clients",ye).then(t=>{t.ok||t.text().then(e=>A.error(`failed to get client list: ${t.status}: ${e}`))})}function Bt(t,e,n,l,o){ne.saveConfig();const r=`${e?"osrs":R.env.provider}-${t?"win":"mac"}`,i=e?"osrs":"rs3",a=t?"exe":"app",c=`${i}${a}InstalledHash`,u=(f,b)=>{const g={},p=ve(M.config),y=e?p.osrs_launch_command:p.rs_launch_command;f&&(g.hash=f),n&&(g.jx_session_id=n),l&&(g.jx_character_id=l),o&&(g.jx_display_name=o),y&&y!==""&&(g.launch_command=y),e||(p.rs_plugin_loader&&(g.plugin_loader="1"),g.config_uri=p.use_custom_rs_config_uri&&p.rs_config_uri?p.rs_config_uri:R.env.default_config_uri);const h=L=>fetch(`/launch-${i}-${a}?${new URLSearchParams(g).toString()}`,L).then($=>{$.text().then(x=>A.info(`game launch status: '${x.trim()}'`)),$.ok&&(f&&(R[c]=f),p.close_after_launch&&(e||!p.rs_plugin_loader)&&fetch("/close"))});b?b.then(L=>h(kt(L))):h(ye)},d=()=>{R.hdosInstalledVersion&&u()};Oe(`${R.env.direct6_url}${r}/${r}.json`,ye,f=>f.text().then(b=>{const g=JSON.parse(atob(b.split(".")[1])).environments.production;if(R[c]===g.id){A.info("game client is up-to-date"),u();return}A.info(`downloading client version ${g.version}...`),Oe(`${R.env.direct6_url}${r}/catalog/${g.id}/catalog.json`,ye,p=>p.text().then(y=>{const h=JSON.parse(atob(y.split(".")[1])),L=$=>$.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:");Oe(L(h.metafile),ye,$=>$.text().then(x=>{const I=JSON.parse(atob(x.split(".")[1])),O=I.pieces.digests.map(C=>{const T=atob(C).split("").map(D=>D.charCodeAt(0).toString(16).padStart(2,"0")).join(""),j=L(h.config.remote.baseUrl).concat(h.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",T.substring(0,2)).replace("{TargetDigest}",T));return fetch(j,ye).then(D=>D.blob().then(le=>{const ee=new DecompressionStream("gzip");return new Response(le.slice(6).stream().pipeThrough(ee)).blob()}))});let U=0,S=null;for(let C=0;C<I.files.length;C+=1)if(t?I.files[C].name.endsWith(".exe"):I.files[C].name.includes(".app/Contents/MacOS/"))if(S!==null){A.error(`can't parse ${$.url}: file list has multiple possibilities for main exe`),d();return}else S=I.files[C].size;else S===null&&(U+=I.files[C].size);if(S===null){A.error(`can't parse ${$.url}: file list has no possibilities for main exe`),d();return}Promise.all(O).then(C=>{const T=new Blob(C).slice(U,U+S);u(I.id,T.arrayBuffer())})}),d)}),d)}),d)}function Ft(t,e,n){const l=t.slice();return l[48]=e[n],l}function qt(t,e,n){const l=t.slice();return l[51]=e[n],l}function zt(t,e,n){const l=t.slice();return l[54]=e[n][0],l[47]=e[n][1],l}function Wt(t,e,n){const l=t.slice();return l[48]=e[n],l}function _s(t){let e,n=ge(t[5]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Jt(Wt(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=Ie()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);v(o,e,r)},p(o,r){if(r[0]&14628){n=ge(o[5]);let i;for(i=0;i<n.length;i+=1){const a=Wt(o,n,i);l[i]?l[i].p(a,r):(l[i]=Jt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(o){o&&w(e),Ae(l,o)}}}function gs(t){let e;return{c(){e=m("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Jt(t){let e,n=(t[48].identity||nn)+"",l,o,r,i,a,c;function u(){return t[24](t[48])}return{c(){e=m("button"),l=z(n),r=P(),i=m("br"),_(e,"class",o="m-1 h-[28px] w-[95%] select-none rounded-lg border-2 "+(t[11]&&t[2]===t[48].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){v(d,e,f),k(e,l),v(d,r,f),v(d,i,f),a||(c=N(e,"click",u),a=!0)},p(d,f){t=d,f[0]&32&&n!==(n=(t[48].identity||nn)+"")&&pe(l,n),f[0]&2084&&o!==(o="m-1 h-[28px] w-[95%] select-none rounded-lg border-2 "+(t[11]&&t[2]===t[48].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&_(e,"class",o)},d(d){d&&(w(e),w(r),w(i)),a=!1,c()}}}function hs(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function ms(t){let e,n,l,o,r,i=ge(Object.entries(t[0].pluginConfig)),a=[];for(let f=0;f<i.length;f+=1)a[f]=Gt(zt(t,i,f));function c(f,b){return f[11]?bs:ks}let u=c(t),d=u(t);return{c(){e=m("select");for(let f=0;f<a.length;f+=1)a[f].c();n=P(),d.c(),l=Ie(),_(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[1]===void 0&&Ye(()=>t[25].call(e))},m(f,b){v(f,e,b);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(e,null);xe(e,t[1],!0),v(f,n,b),d.m(f,b),v(f,l,b),o||(r=[N(e,"change",t[25]),N(e,"change",t[26])],o=!0)},p(f,b){if(b[0]&1){i=ge(Object.entries(f[0].pluginConfig));let g;for(g=0;g<i.length;g+=1){const p=zt(f,i,g);a[g]?a[g].p(p,b):(a[g]=Gt(p),a[g].c(),a[g].m(e,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=i.length}b[0]&3&&xe(e,f[1]),u===(u=c(f))&&d?d.p(f,b):(d.d(1),d=u(f),d&&(d.c(),d.m(l.parentNode,l)))},d(f){f&&(w(e),w(n),w(l)),Ae(a,f),d.d(f),o=!1,re(r)}}}function Gt(t){let e,n=(t[47].name??Ze)+"",l,o;return{c(){e=m("option"),l=z(n),_(e,"class","dark:bg-slate-900"),e.__value=o=t[54],K(e,e.__value)},m(r,i){v(r,e,i),k(e,l)},p(r,i){i[0]&1&&n!==(n=(r[47].name??Ze)+"")&&pe(l,n),i[0]&1&&o!==(o=r[54])&&(e.__value=o,K(e,e.__value))},d(r){r&&w(e)}}}function bs(t){let e,n,l,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Ps,then:vs,catch:ws,value:47};return dt(o=t[4],r),{c(){e=m("br"),n=P(),l=Ie(),r.block.c()},m(i,a){v(i,e,a),v(i,n,a),v(i,l,a),r.block.m(i,r.anchor=a),r.mount=()=>l.parentNode,r.anchor=l},p(i,a){t=i,r.ctx=t,a[0]&16&&o!==(o=t[4])&&dt(o,r)||vn(r,t,a)},d(i){i&&(w(e),w(n),w(l)),r.block.d(i),r.token=null,r=null}}}function ks(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$=t[12]&&Zt(t);function x(U,S){return S[0]&1&&(p=null),p==null&&(p=Object.entries(U[0].pluginConfig).length!==0),p?Is:Rs}let I=x(t,[-1,-1]),O=I(t);return{c(){e=m("span"),n=m("button"),l=m("img"),i=P(),a=m("button"),c=m("img"),d=P(),f=m("br"),b=P(),$&&$.c(),g=P(),O.c(),y=Ie(),Ut(l.src,o="svgs/download-solid.svg")||_(l,"src",o),_(l,"alt","Install plugin from updater URL"),_(n,"class","mx-1 aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),n.disabled=r=!t[0].hasLibArchive||t[10],_(n,"title","Install plugin from updater URL"),Ut(c.src,u="svgs/folder-solid.svg")||_(c,"src",u),_(c,"alt","Install plugin from local directory"),_(a,"class","aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),a.disabled=t[10],_(a,"title","Install plugin from local directory"),_(e,"class","align-middle")},m(U,S){v(U,e,S),k(e,n),k(n,l),k(e,i),k(e,a),k(a,c),v(U,d,S),v(U,f,S),v(U,b,S),$&&$.m(U,S),v(U,g,S),O.m(U,S),v(U,y,S),h||(L=[N(n,"click",t[27]),N(a,"click",t[17])],h=!0)},p(U,S){S[0]&1025&&r!==(r=!U[0].hasLibArchive||U[10])&&(n.disabled=r),S[0]&1024&&(a.disabled=U[10]),U[12]?$?$.p(U,S):($=Zt(U),$.c(),$.m(g.parentNode,g)):$&&($.d(1),$=null),I===(I=x(U,S))&&O?O.p(U,S):(O.d(1),O=I(U),O&&(O.c(),O.m(y.parentNode,y)))},d(U){U&&(w(e),w(d),w(f),w(b),w(g),w(y)),$&&$.d(U),O.d(U),h=!1,re(L)}}}function ws(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function vs(t){let e,n,l,o,r,i,a,c,u,d;function f(h,L){return L[0]&19&&(e=null),L[0]&1&&(n=null),e==null&&(e=!!(h[47]&&h[47].main&&Object.keys(h[0].pluginConfig).includes(h[1]))),e?Ss:(n==null&&(n=Object.entries(h[0].pluginConfig).length===0),n?$s:ys)}let b=f(t,[-1,-1]),g=b(t),p=ge(t[5]),y=[];for(let h=0;h<p.length;h+=1)y[h]=Yt(Ft(t,p,h));return{c(){g.c(),l=P(),o=m("br"),r=P(),i=m("br"),a=P(),c=m("hr"),u=P();for(let h=0;h<y.length;h+=1)y[h].c();d=Ie(),_(c,"class","p-1 dark:border-slate-700")},m(h,L){g.m(h,L),v(h,l,L),v(h,o,L),v(h,r,L),v(h,i,L),v(h,a,L),v(h,c,L),v(h,u,L);for(let $=0;$<y.length;$+=1)y[$]&&y[$].m(h,L);v(h,d,L)},p(h,L){if(b===(b=f(h,L))&&g?g.p(h,L):(g.d(1),g=b(h),g&&(g.c(),g.m(l.parentNode,l))),L[0]&524325){p=ge(h[5]);let $;for($=0;$<p.length;$+=1){const x=Ft(h,p,$);y[$]?y[$].p(x,L):(y[$]=Yt(x),y[$].c(),y[$].m(d.parentNode,d))}for(;$<y.length;$+=1)y[$].d(1);y.length=p.length}},d(h){h&&(w(l),w(o),w(r),w(i),w(a),w(c),w(u),w(d)),g.d(h),Ae(y,h)}}}function ys(t){let e;return{c(){e=m("p"),e.textContent="can't start plugin: does not appear to be configured"},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function $s(t){let e;return{c(){e=m("p"),e.textContent="(no plugins installed)"},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Ss(t){let e,n,l=t[47].name+"",o,r,i;function a(){return t[35](t[47])}return{c(){e=m("button"),n=z("Start "),o=z(l),_(e,"class","mx-auto mb-1 w-auto select-none rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(c,u){v(c,e,u),k(e,n),k(e,o),r||(i=N(e,"click",a),r=!0)},p(c,u){t=c,u[0]&16&&l!==(l=t[47].name+"")&&pe(o,l)},d(c){c&&w(e),r=!1,i()}}}function Vt(t){let e,n=ge(t[48].plugins),l=[];for(let o=0;o<n.length;o+=1)l[o]=Xt(qt(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=Ie()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);v(o,e,r)},p(o,r){if(r[0]&524325){n=ge(o[48].plugins);let i;for(i=0;i<n.length;i+=1){const a=qt(o,n,i);l[i]?l[i].p(a,r):(l[i]=Xt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(o){o&&w(e),Ae(l,o)}}}function Cs(t){let e,n=t[51].id+"",l;return{c(){e=m("p"),l=z(n)},m(o,r){v(o,e,r),k(e,l)},p(o,r){r[0]&32&&n!==(n=o[51].id+"")&&pe(l,n)},d(o){o&&w(e)}}}function Ls(t){let e,n=(t[0].pluginConfig[t[51].id].name??t[51].id)+"",l,o,r,i,a,c;function u(){return t[36](t[51])}return{c(){e=m("p"),l=z(n),o=P(),r=m("button"),r.innerHTML='<img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/>',i=P(),_(r,"class","select-none rounded-sm bg-rose-500 shadow-lg hover:opacity-75")},m(d,f){v(d,e,f),k(e,l),k(e,o),k(e,r),k(e,i),a||(c=N(r,"click",u),a=!0)},p(d,f){t=d,f[0]&33&&n!==(n=(t[0].pluginConfig[t[51].id].name??t[51].id)+"")&&pe(l,n)},d(d){d&&w(e),a=!1,c()}}}function Xt(t){let e,n;function l(i,a){return a[0]&33&&(e=null),e==null&&(e=!!Object.keys(i[0].pluginConfig).includes(i[51].id)),e?Ls:Cs}let o=l(t,[-1,-1]),r=o(t);return{c(){r.c(),n=Ie()},m(i,a){r.m(i,a),v(i,n,a)},p(i,a){o===(o=l(i,a))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(n.parentNode,n)))},d(i){i&&w(n),r.d(i)}}}function Yt(t){let e,n=t[48].uid===t[2]&&Vt(t);return{c(){n&&n.c(),e=Ie()},m(l,o){n&&n.m(l,o),v(l,e,o)},p(l,o){l[48].uid===l[2]?n?n.p(l,o):(n=Vt(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(l){l&&w(e),n&&n.d(l)}}}function Ps(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Zt(t){let e,n,l,o,r,i,a,c,u,d,f,b;return{c(){e=m("label"),e.textContent="URL:",n=P(),l=m("textarea"),o=P(),r=m("button"),r.innerHTML='<img src="svgs/check-solid.svg" class="h-5 w-5" alt="Confirm"/>',i=P(),a=m("button"),a.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',c=P(),u=m("br"),d=m("br"),_(e,"for","plugin-updater-url-input"),_(l,"rows","1"),_(l,"id","plugin-updater-url-input"),_(l,"class","w-[50%] max-w-[60%] resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800"),_(r,"title","Confirm"),_(r,"class","select-none rounded-sm bg-emerald-500 hover:opacity-75"),_(a,"title","Close URL entry"),_(a,"class","select-none rounded-sm bg-rose-500 hover:opacity-75")},m(g,p){v(g,e,p),v(g,n,p),v(g,l,p),K(l,t[13]),v(g,o,p),v(g,r,p),v(g,i,p),v(g,a,p),v(g,c,p),v(g,u,p),v(g,d,p),f||(b=[N(l,"input",t[28]),N(r,"click",t[29]),N(a,"click",t[30])],f=!0)},p(g,p){p[0]&8192&&K(l,g[13])},d(g){g&&(w(e),w(n),w(l),w(o),w(r),w(i),w(a),w(c),w(u),w(d)),f=!1,re(b)}}}function Rs(t){let e;return{c(){e=m("p"),e.textContent=`You have no plugins installed. You can install plugins either from an updater URL, or by
						downloading them onto your computer and selecting the "bolt.json" file.`},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Is(t){let e=Object.keys(t[0].pluginConfig).includes(t[1])&&t[4]!==null,n,l=e&&Kt(t);return{c(){l&&l.c(),n=Ie()},m(o,r){l&&l.m(o,r),v(o,n,r)},p(o,r){r[0]&19&&(e=Object.keys(o[0].pluginConfig).includes(o[1])&&o[4]!==null),e?l?l.p(o,r):(l=Kt(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&w(n),l&&l.d(o)}}}function Kt(t){let e,n,l,o,r,i,a,c,u,d,f,b,g={ctx:t,current:null,token:null,hasCatch:!0,pending:Os,then:Hs,catch:Us,value:47};dt(e=t[4],g);let p=t[3].updaterURL&&en(t);return{c(){g.block.c(),n=P(),l=m("button"),l.textContent="Browse data",o=z(`
						 
						`),r=m("button"),r.textContent="Browse config",i=P(),a=m("br"),c=P(),p&&p.c(),u=P(),d=m("button"),d.textContent="Remove",_(l,"class","mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(r,"class","mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(d,"class","m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(y,h){g.block.m(y,g.anchor=h),g.mount=()=>n.parentNode,g.anchor=n,v(y,n,h),v(y,l,h),v(y,o,h),v(y,r,h),v(y,i,h),v(y,a,h),v(y,c,h),p&&p.m(y,h),v(y,u,h),v(y,d,h),f||(b=[N(l,"click",t[31]),N(r,"click",t[32]),N(d,"click",t[34])],f=!0)},p(y,h){t=y,g.ctx=t,h[0]&16&&e!==(e=t[4])&&dt(e,g)||vn(g,t,h),t[3].updaterURL?p?p.p(t,h):(p=en(t),p.c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},d(y){y&&(w(n),w(l),w(o),w(r),w(i),w(a),w(c),w(u),w(d)),g.block.d(y),g.token=null,g=null,p&&p.d(y),f=!1,re(b)}}}function Us(t){let e,n,l;return{c(){e=m("p"),e.textContent="error",n=P(),l=m("br")},m(o,r){v(o,e,r),v(o,n,r),v(o,l,r)},p:B,d(o){o&&(w(e),w(n),w(l))}}}function Hs(t){let e,n=(t[47].name??Ze)+"",l,o,r,i,a=(t[47].description??"no description")+"",c,u,d,f,b=t[47].version&&Qt(t);return{c(){e=m("p"),l=z(n),o=P(),b&&b.c(),r=P(),i=m("p"),c=z(a),d=P(),f=m("br"),_(e,"class","pb-4 text-xl font-bold"),_(i,"class",u=t[47].description?null:"italic")},m(g,p){v(g,e,p),k(e,l),k(e,o),b&&b.m(e,null),v(g,r,p),v(g,i,p),k(i,c),v(g,d,p),v(g,f,p)},p(g,p){p[0]&16&&n!==(n=(g[47].name??Ze)+"")&&pe(l,n),g[47].version?b?b.p(g,p):(b=Qt(g),b.c(),b.m(e,null)):b&&(b.d(1),b=null),p[0]&16&&a!==(a=(g[47].description??"no description")+"")&&pe(c,a),p[0]&16&&u!==(u=g[47].description?null:"italic")&&_(i,"class",u)},d(g){g&&(w(e),w(r),w(i),w(d),w(f)),b&&b.d()}}}function Qt(t){let e,n,l,o,r=t[47].version+"",i;return{c(){e=m("br"),n=P(),l=m("span"),o=z("v"),i=z(r),_(l,"class","pb-4 text-xl font-bold italic text-slate-600")},m(a,c){v(a,e,c),v(a,n,c),v(a,l,c),k(l,o),k(l,i)},p(a,c){c[0]&16&&r!==(r=a[47].version+"")&&pe(i,r)},d(a){a&&(w(e),w(n),w(l))}}}function Os(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function en(t){let e,n,l,o;return{c(){e=m("button"),e.textContent="Check updates",n=z(`
							 `),_(e,"class","m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(r,i){v(r,e,i),v(r,n,i),l||(o=N(e,"click",t[33]),l=!0)},p:B,d(r){r&&(w(e),w(n)),l=!1,o()}}}function tn(t){let e,n,l,o;function r(c,u){return c[9]?xs:Ts}let i=r(t),a=i(t);return{c(){e=m("br"),n=m("br"),l=P(),a.c(),o=Ie()},m(c,u){v(c,e,u),v(c,n,u),v(c,l,u),a.m(c,u),v(c,o,u)},p(c,u){i===(i=r(c))&&a?a.p(c,u):(a.d(1),a=i(c),a&&(a.c(),a.m(o.parentNode,o)))},d(c){c&&(w(e),w(n),w(l),w(o)),a.d(c)}}}function Ts(t){let e,n,l;return{c(){e=m("p"),n=z("[info] "),l=z(t[8])},m(o,r){v(o,e,r),k(e,n),k(e,l)},p(o,r){r[0]&256&&pe(l,o[8])},d(o){o&&w(e)}}}function xs(t){let e,n,l;return{c(){e=m("p"),n=z("[error] "),l=z(t[8]),_(e,"class","text-red-500")},m(o,r){v(o,e,r),k(e,n),k(e,l)},p(o,r){r[0]&256&&pe(l,o[8])},d(o){o&&w(e)}}}function Ns(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y;function h(S,C){return S[5].length==0?gs:_s}let L=h(t),$=L(t);function x(S,C){return S[0].hasBoltPlugins?ms:hs}let I=x(t),O=I(t),U=t[8]&&tn(t);return{c(){e=m("div"),n=m("button"),l=z("Manage Plugins"),r=P(),i=m("hr"),a=P(),$.c(),c=P(),u=m("div"),O.c(),d=P(),U&&U.c(),f=P(),b=m("div"),g=m("button"),g.textContent="about plugins",_(n,"class",o="mx-auto mb-2 w-[95%] select-none rounded-lg border-2 "+(t[11]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),_(i,"class","p-1 dark:border-slate-700"),_(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),_(u,"class","h-full pt-10"),_(g,"class","m-0 cursor-pointer select-none border-none bg-transparent p-0 text-sm text-gray-500 underline"),_(b,"class","absolute bottom-2 right-4")},m(S,C){v(S,e,C),k(e,n),k(n,l),k(e,r),k(e,i),k(e,a),$.m(e,null),v(S,c,C),v(S,u,C),O.m(u,null),k(u,d),U&&U.m(u,null),v(S,f,C),v(S,b,C),k(b,g),p||(y=[N(n,"click",t[23]),N(g,"click",t[21])],p=!0)},p(S,C){C[0]&2048&&o!==(o="mx-auto mb-2 w-[95%] select-none rounded-lg border-2 "+(S[11]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&_(n,"class",o),L===(L=h(S))&&$?$.p(S,C):($.d(1),$=L(S),$&&($.c(),$.m(e,null))),I===(I=x(S))&&O?O.p(S,C):(O.d(1),O=I(S),O&&(O.c(),O.m(u,d))),S[8]?U?U.p(S,C):(U=tn(S),U.c(),U.m(u,null)):U&&(U.d(1),U=null)},d(S){S&&(w(e),w(c),w(u),w(f),w(b)),$.d(),O.d(),U&&U.d(),p=!1,re(y)}}}function js(t){let e,n,l={class:"h-[90%] w-[90%] text-center",$$slots:{default:[Ns]},$$scope:{ctx:t}};return e=new bt({props:l}),t[37](e),e.$on("close",t[38]),{c(){de(e.$$.fragment)},m(o,r){ie(e,o,r),n=!0},p(o,r){const i={};r[0]&32639|r[1]&268435456&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){t[37](null),ae(e,o)}}}const Fe="bolt.json",Es="main.lua",Ze="(unnamed)",nn="(new character)";function Ms(t,e,n){let l,o,r,i;ke(t,Ot,H=>n(5,i=H));let a,c=null,u=!1;const d=R.platform==="windows"?"\\":"/",f=d.concat(Fe);function b(){n(12,G=!1),a.open()}const g=H=>{console.log(H),n(8,c=H),n(9,u=!1)},p=H=>{console.error(H),n(8,c=H),n(9,u=!0)},y=H=>new Promise((F,X)=>{const be=H.concat(H.endsWith(d)?Fe:f);var Z=new XMLHttpRequest;Z.onreadystatechange=()=>{Z.readyState==4&&(Z.status==200?F(JSON.parse(Z.responseText)):X(Z.responseText))},Z.open("GET","/read-json-file?".concat(new URLSearchParams({path:be}).toString()),!0),Z.send()}),h=H=>fetch("/get-plugindir-json?".concat(new URLSearchParams({id:H}).toString())).then(F=>F.ok?F.json():null),L=H=>{const X=R.pluginConfig[H];if(!X)return null;const be=X.path;return be?y(be):h(H)},$=()=>{const H=Object.keys(R.pluginConfig);let F;do F=crypto.randomUUID();while(H.includes(F));return F},x=(H,F)=>{y(H).then(X=>{n(1,j=$()),n(0,R.pluginConfig[j]={name:X.name??Ze,path:H,version:X.version},R),n(6,M.pluginConfigHasPendingChanges=!0,M)}).catch(X=>p(`config file '${F}' couldn't be fetched, reason: ${X}`))},I=H=>{g("downloading..."),fetch(H).then(async F=>{if(!F.ok){p(`can't install plugin: updater URL returned ${F.status}: ${F.statusText}`);return}const X=await F.json();if(X.url){const be=await fetch(X.url);if(!be.ok){p(`can't install plugin: remote download URL returned ${F.status}: ${F.statusText}`);return}const Z=await be.arrayBuffer();if(X.sha256){const Te=await crypto.subtle.digest("SHA-256",Z),wt=Array.from(new Uint8Array(Te)).map(vt=>vt.toString(16).padStart(2,"0")).join("");if(X.sha256!==wt){p("can't install plugin: incorrect file hash");return}}const we=$();if(!(await fetch("/install-plugin?".concat(new URLSearchParams({id:we}).toString()),{method:"POST",body:Z})).ok){p(`can't install plugin: ${F.statusText}`);return}const je=await h(we);je?(n(1,j=we),n(0,R.pluginConfig[j]={name:je.name??Ze,version:je.version,updaterURL:H,sha256:X.sha256},R),n(6,M.pluginConfigHasPendingChanges=!0,M),g(`plugin '${je.name}' installed`)):p(`can't install plugin: ${Fe} not found`)}}).catch(()=>{p("can't install plugin: unhandled exception")})};let O=!1;const U=()=>{n(10,O=!0);var H=new XMLHttpRequest;H.onreadystatechange=()=>{if(H.readyState==4&&(n(10,O=!1),H.status==200))if(H.responseText.endsWith(f)){const F=H.responseText.substring(0,H.responseText.length-Fe.length);x(F,H.responseText)}else p(`selection '${H.responseText}' is not named ${Fe}; ignored`)},H.open("GET","/json-file-picker",!0),H.send()};Pt();const S=(H,F,X,be)=>{let Z=null;if(X){const Ue=R.platform==="windows"?X.replaceAll("\\","/"):X;Z=Ue.endsWith(d)?Ue:Ue.concat("/")}var we=new XMLHttpRequest;we.onreadystatechange=()=>{we.readyState==4&&(Pt(),A.info(`Start-plugin status: ${we.statusText.trim()}`))},Z?we.open("GET","/start-plugin?".concat(new URLSearchParams({client:H.toString(),id:F,main:be,path:Z}).toString()),!0):we.open("GET","/start-plugin?".concat(new URLSearchParams({client:H.toString(),id:F,main:be}).toString()),!0),we.send()},C=(H,F)=>{var X=new XMLHttpRequest;X.onreadystatechange=()=>{X.readyState==4&&(Pt(),A.info(`Stop-plugin status: ${X.statusText.trim()}`))},X.open("GET","/stop-plugin?".concat(new URLSearchParams({client:H.toString(),uid:F.toString()}).toString()),!0),X.send()},T=(H,F)=>{const X=H.updaterURL;fetch(X).then(async be=>{if(!be.ok){p(`can't update plugin: updater URL returned ${be.status}: ${be.statusText}`);return}let Z=await be.json();if(!Z.url){g(`can't update plugin '${H.name}': no remote download URL is configured`);return}let we=!1;if(Z.sha256?H.sha256!==Z.sha256&&(we=!0):Z.version&&H.version!==Z.version&&(we=!0),we){const Ue=await fetch(Z.url);if(!Ue.ok){p(`can't update plugin: remote download URL returned ${Ue.status}: ${Ue.statusText}`);return}const je=await Ue.arrayBuffer();if(Z.sha256){const wt=await crypto.subtle.digest("SHA-256",je),vt=Array.from(new Uint8Array(wt)).map(Ln=>Ln.toString(16).padStart(2,"0")).join("");if(Z.sha256!==vt){p(`can't update plugin '${H.name}': incorrect file hash`);return}}fetch("/install-plugin?".concat(new URLSearchParams({id:F}).toString()),{method:"POST",body:je});const Te=await h(F);Te?(Z.sha256&&(H.sha256=Z.sha256),Te.name&&(H.name=Te.name),Te.version&&(H.version=Te.version),n(6,M.pluginConfigHasPendingChanges=!0,M),g(`plugin '${Te.name}' updated`)):p(`can't update plugin '${H.name}': ${Fe} not found`)}else g(`plugin '${H.name}' is already up-to-date`)})};var j;const D=()=>fetch("/open-external-url",{method:"POST",body:"https://bolt.adamcake.com/plugins"});var le=!1,ee;let G=!1,Q;const V=()=>n(11,le=!1),se=H=>{n(2,ee=H.uid),n(11,le=!0),n(12,G=!1),n(13,Q=""),n(8,c=null)};function E(){j=Tt(this),n(1,j),n(0,R)}const te=()=>n(8,c=null),Ce=()=>{n(12,G=!G),n(13,Q="")};function fe(){Q=this.value,n(13,Q)}const Ne=()=>{I(Q),n(12,G=!1),n(13,Q="")},$e=()=>{n(12,G=!1),n(13,Q="")},Ke=()=>{const H=R.pluginConfig[j].path;fetch(H?"/browse-directory?".concat(new URLSearchParams({path:H}).toString()):"/browse-plugin-data?".concat(new URLSearchParams({id:j}).toString()))},lt=()=>fetch("/browse-plugin-config?".concat(new URLSearchParams({id:j}).toString())),J=()=>T(l,j),Y=()=>{n(4,r=null),n(6,M.pluginConfigHasPendingChanges=!0,M);let H=R.pluginConfig;const F=H[j];F&&(fetch("/uninstall-plugin?".concat(new URLSearchParams({id:j,delete_data_dir:typeof F.path=="string"?"0":"1"}).toString())),g(`plugin '${F.name}' uninstalled`),delete H[j],n(0,R.pluginConfig=H,R))},ot=H=>S(ee,j,o??null,H.main??Es),rt=H=>{C(ee,H.uid)};function Sn(H){Pe[H?"unshift":"push"](()=>{a=H,n(7,a)})}const Cn=()=>ne.savePluginConfig(!0);return t.$$.update=()=>{t.$$.dirty[0]&36&&(i.some(H=>H.uid===ee)||n(11,le=!1)),t.$$.dirty[0]&3&&n(3,l=R.pluginConfig[j]),t.$$.dirty[0]&2&&n(4,r=L(j)),t.$$.dirty[0]&24&&r&&r.then(H=>{let F=!1;H.name!==l.name&&(n(3,l.name=H.name,l),F=!0),H.version!==l.version&&(n(3,l.version=H.version,l),F=!0),F&&(n(3,l),n(0,R),n(1,j),n(4,r),n(6,M.pluginConfigHasPendingChanges=!0,M))}),t.$$.dirty[0]&8&&n(14,o=l?l.path:null)},[R,j,ee,l,r,i,M,a,c,u,O,le,G,Q,o,g,I,U,S,C,T,D,b,V,se,E,te,Ce,fe,Ne,$e,Ke,lt,J,Y,ot,rt,Sn,Cn]}class As extends me{constructor(e){super(),he(this,e,Ms,js,_e,{open:22},null,[-1,-1])}get open(){return this.$$.ctx[22]}}function Ds(t){let e,n,l,o,r,i,a,c,u,d,f,b,g;return{c(){e=m("div"),n=m("h2"),n.textContent="Game is offline",l=P(),o=m("br"),r=P(),i=m("p"),i.textContent="This game appears to be offline for maintenance or an update. Launch anyway?",a=P(),c=m("div"),u=m("button"),u.textContent="No",d=P(),f=m("button"),f.textContent="Yes",_(n,"class","text-3xl font-extrabold"),_(u,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(f,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(c,"class","align-bottom")},m(p,y){v(p,e,y),k(e,n),k(e,l),k(e,o),k(e,r),k(e,i),k(e,a),k(e,c),k(c,u),k(c,d),k(c,f),b||(g=[N(u,"click",t[5]),N(f,"click",t[6])],b=!0)},p:B,d(p){p&&w(e),b=!1,re(g)}}}function Bs(t){let e,n,l={class:"h-fit w-3/5 px-5 py-3 text-center",$$slots:{default:[Ds]},$$scope:{ctx:t}};return e=new bt({props:l}),t[7](e),{c(){de(e.$$.fragment)},m(o,r){ie(e,o,r),n=!0},p(o,[r]){const i={};r&271&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){t[7](null),ae(e,o)}}}function Fs(t,e,n){let l,o,r,i;function a(f,b,g){n(3,i=f),n(1,o=b),n(2,r=g),l.open()}const c=()=>{l.close()},u=()=>{i(o,r),l.close()};function d(f){Pe[f?"unshift":"push"](()=>{l=f,n(0,l)})}return[l,o,r,i,a,c,u,d]}class qs extends me{constructor(e){super(),he(this,e,Fs,Bs,_e,{open:4})}get open(){return this.$$.ctx[4]}}function sn(t,e,n){const l=t.slice();return l[20]=e[n],l}function ln(t,e,n){const l=t.slice();return l[23]=e[n],l}function zs(t){let e,n,l={};return e=new As({props:l}),t[16](e),{c(){de(e.$$.fragment)},m(o,r){ie(e,o,r),n=!0},p(o,r){const i={};e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){t[16](null),ae(e,o)}}}function on(t){let e,n;return{c(){e=m("div"),n=z(t[7]),_(e,"class","absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black")},m(l,o){v(l,e,o),k(e,n)},p(l,o){o&128&&pe(n,l[7])},d(l){l&&w(e)}}}function Ws(t){let e,n,l;return{c(){e=m("button"),e.textContent="Plugin menu",e.disabled=!R.hasBoltPlugins,_(e,"title",R.hasBoltPlugins?null:"This feature is disabled"),_(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(o,r){v(o,e,r),n||(l=N(e,"click",t[19]),n=!0)},p:B,d(o){o&&w(e),n=!1,l()}}}function Js(t){let e,n,l,o,r,i,a=ge(jt[t[1].selected.game]),c=[];for(let u=0;u<a.length;u+=1)c[u]=rn(ln(t,a,u));return{c(){e=m("label"),n=m("span"),n.textContent="Game Client",l=P(),o=m("select");for(let u=0;u<c.length;u+=1)c[u].c();_(n,"class","text-sm"),_(o,"id","game_client_select"),_(o,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[1].selected.client===void 0&&Ye(()=>t[18].call(o)),_(e,"class","flex flex-col")},m(u,d){v(u,e,d),k(e,n),k(e,l),k(e,o);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(o,null);xe(o,t[1].selected.client,!0),r||(i=N(o,"change",t[18]),r=!0)},p(u,d){if(d&2){a=ge(jt[u[1].selected.game]);let f;for(f=0;f<a.length;f+=1){const b=ln(u,a,f);c[f]?c[f].p(b,d):(c[f]=rn(b),c[f].c(),c[f].m(o,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=a.length}d&2&&xe(o,u[1].selected.client)},d(u){u&&w(e),Ae(c,u),r=!1,i()}}}function rn(t){let e,n=t[23]+"",l,o;return{c(){e=m("option"),l=z(n),_(e,"class","dark:bg-slate-900"),e.__value=o=t[23],K(e,e.__value)},m(r,i){v(r,e,i),k(e,l)},p(r,i){i&2&&n!==(n=r[23]+"")&&pe(l,n),i&2&&o!==(o=r[23])&&(e.__value=o,K(e,e.__value))},d(r){r&&w(e)}}}function an(t){let e;return{c(){e=m("option"),e.textContent="No characters",_(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",K(e,e.__value)},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Gs(t){let e;return{c(){e=z("New Character")},m(n,l){v(n,e,l)},p:B,d(n){n&&w(e)}}}function Vs(t){let e=t[20].displayName+"",n;return{c(){n=z(e)},m(l,o){v(l,n,o)},p(l,o){o&32&&e!==(e=l[20].displayName+"")&&pe(n,e)},d(l){l&&w(n)}}}function cn(t){let e,n,l;function o(a,c){return a[20].displayName?Vs:Gs}let r=o(t),i=r(t);return{c(){e=m("option"),i.c(),n=P(),e.__value=l=t[20].accountId,K(e,e.__value),_(e,"class","dark:bg-slate-900")},m(a,c){v(a,e,c),i.m(e,null),k(e,n)},p(a,c){r===(r=o(a))&&i?i.p(a,c):(i.d(1),i=r(a),i&&(i.c(),i.m(e,n))),c&32&&l!==(l=a[20].accountId)&&(e.__value=l,K(e,e.__value))},d(a){a&&w(e),i.d()}}}function Xs(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$,x,I,O,U,S,C,T={};e=new qs({props:T}),t[15](e);let j=R.hasBoltPlugins&&zs(t),D=t[7]&&on(t);function le(E,te){if(E[1].selected.game==ce.osrs)return Js;if(E[1].selected.game===ce.rs3)return Ws}let ee=le(t),G=ee&&ee(t),Q=ge(t[5]),V=[];for(let E=0;E<Q.length;E+=1)V[E]=cn(sn(t,Q,E));let se=null;return Q.length||(se=an()),{c(){de(e.$$.fragment),n=P(),j&&j.c(),l=P(),o=m("div"),D&&D.c(),r=P(),i=m("div"),a=m("img"),u=P(),d=m("button"),f=z("Play"),g=P(),G&&G.c(),p=P(),y=m("label"),h=m("span"),h.textContent="Character",L=P(),$=m("select"),x=m("option"),I=z("Select an account");for(let E=0;E<V.length;E+=1)V[E].c();se&&se.c(),Ut(a.src,c="svgs/rocket-solid.svg")||_(a,"src",c),_(a,"alt","Launch icon"),_(a,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),_(d,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),d.disabled=b=!t[8],_(h,"class","text-sm"),x.__value=void 0,K(x,x.__value),x.disabled=!0,_(x,"class","dark:bg-slate-900"),_($,"id","character_select"),_($,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),$.disabled=O=!t[8]||t[1].selected.user_id===null,_(y,"class","flex flex-col"),_(i,"class","flex flex-col items-center gap-4"),_(o,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(E,te){ie(e,E,te),v(E,n,te),j&&j.m(E,te),v(E,l,te),v(E,o,te),D&&D.m(o,null),k(o,r),k(o,i),k(i,a),k(i,u),k(i,d),k(d,f),k(i,g),G&&G.m(i,null),k(i,p),k(i,y),k(y,h),k(y,L),k(y,$),k($,x),k(x,I);for(let Ce=0;Ce<V.length;Ce+=1)V[Ce]&&V[Ce].m($,null);se&&se.m($,null),xe($,t[4]),U=!0,S||(C=[N(d,"click",t[17]),N($,"change",t[13])],S=!0)},p(E,[te]){const Ce={};if(e.$set(Ce),R.hasBoltPlugins&&j.p(E,te),E[7]?D?D.p(E,te):(D=on(E),D.c(),D.m(o,r)):D&&(D.d(1),D=null),(!U||te&256&&b!==(b=!E[8]))&&(d.disabled=b),ee===(ee=le(E))&&G?G.p(E,te):(G&&G.d(1),G=ee&&ee(E),G&&(G.c(),G.m(i,p))),te&32){Q=ge(E[5]);let fe;for(fe=0;fe<Q.length;fe+=1){const Ne=sn(E,Q,fe);V[fe]?V[fe].p(Ne,te):(V[fe]=cn(Ne),V[fe].c(),V[fe].m($,null))}for(;fe<V.length;fe+=1)V[fe].d(1);V.length=Q.length,!Q.length&&se?se.p(E,te):Q.length?se&&(se.d(1),se=null):(se=an(),se.c(),se.m($,null))}(!U||te&258&&O!==(O=!E[8]||E[1].selected.user_id===null))&&($.disabled=O),(!U||te&48)&&xe($,E[4])},i(E){U||(q(e.$$.fragment,E),q(j),U=!0)},o(E){W(e.$$.fragment,E),W(j),U=!1},d(E){E&&(w(n),w(l),w(o)),t[15](null),ae(e,E),j&&j.d(E),D&&D.d(),G&&G.d(),Ae(V,E),se&&se.d(),S=!1,re(C)}}}function Ys(t,e,n){let l,o,r,i,a,c,u,d,f,{config:b,initialized:g}=M;ke(t,b,S=>n(1,i=S)),ke(t,g,S=>n(8,u=S));let p=Me(null);ke(t,p,S=>n(7,c=S));let y=Me(!0);ke(t,y,S=>n(6,a=S));function h(S,C){if(!l)return A.warn("Please log in or select a user to play.");if(!o)return A.warn("Please select a character from the select menu.");const T=ne.findSession(i.selected.user_id);if(!T)return A.warn("Unable to launch game, session was not found.");const{session_id:j}=T,D=ne.findAccount(T.accounts,o);if(!D)return A.warn("Unable to launch game, account was not found.");const{accountId:le,displayName:ee}=D,G=R.platform===It.Windows,Q=R.platform===It.Linux;switch(S){case ce.osrs:switch(C){case Ve.official:Bt(G||Q,!0,j,le,ee);break;case Ve.runelite:$n(j,le,ee,!1);break;case Ve.hdos:ps(j,le,ee);break}break;case ce.rs3:Q?fs(j,le,ee):Bt(G,!1,j,le,ee);break}}function L(S){const C=S.target.value;if(!l)return;const T=i.userDetails[l];T?(T.account_id=C,Re(b,i.userDetails[l]=T,i)):Re(b,i.userDetails[l]={account_id:C},i)}function $(S){Pe[S?"unshift":"push"](()=>{d=S,n(2,d)})}function x(S){Pe[S?"unshift":"push"](()=>{f=S,n(3,f)})}const I=()=>{a?h(i.selected.game,i.selected.client):d.open(h,i.selected.game,i.selected.client)};function O(){i.selected.client=Tt(this),b.set(i)}const U=()=>{f.open()};return t.$$.update=()=>{var S,C;if(t.$$.dirty&2&&n(14,l=i.selected.user_id),t.$$.dirty&16386&&n(4,o=(S=i.userDetails[l??""])==null?void 0:S.account_id),t.$$.dirty&2&&n(5,r=((C=ne.findSession(i.selected.user_id))==null?void 0:C.accounts)??[]),t.$$.dirty&2)if(i.check_announcements){const T=i.selected.game==ce.osrs?"osrs":R.env.provider,j=`${R.env.psa_url}${T}/${T}.json`;fetch(j,{method:"GET",cache:"no-store"}).then(D=>D.json()).then(D=>{Re(p,c=D.psaEnabled&&D.psaMessage?D.psaMessage:null,c),Re(y,a=!(D.playDisabled??!1),a)})}else Re(p,c=null,c),Re(y,a=!0,a)},[h,i,d,f,o,r,a,c,u,b,g,p,y,L,l,$,x,I,O,U]}class Zs extends me{constructor(e){super(),he(this,e,Ys,Xs,_e,{launch:0})}get launch(){return this.$$.ctx[0]}}function un(t,e,n){const l=t.slice();return l[1]=e[n].date,l[2]=e[n].severity,l[3]=e[n].content,l}function dn(t){var c;let e,n=((c=t[1])==null?void 0:c.toLocaleTimeString())+"",l,o,r=t[3]+"",i,a;return{c(){e=m("li"),l=z(n),o=z(`
				- `),i=z(r),a=P(),ue(e,"text-rose-500",t[2]===et.error),ue(e,"text-orange-700",t[2]===et.warn)},m(u,d){v(u,e,d),k(e,l),k(e,o),k(e,i),k(e,a)},p(u,d){var f;d&1&&n!==(n=((f=u[1])==null?void 0:f.toLocaleTimeString())+"")&&pe(l,n),d&1&&r!==(r=u[3]+"")&&pe(i,r),d&1&&ue(e,"text-rose-500",u[2]===et.error),d&1&&ue(e,"text-orange-700",u[2]===et.warn)},d(u){u&&w(e)}}}function Ks(t){let e,n,l,o,r=ge(t[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=dn(un(t,r,a));return{c(){e=m("div"),n=m("div"),n.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',l=P(),o=m("ol");for(let a=0;a<i.length;a+=1)i[a].c();_(n,"class","absolute right-6 top-2"),_(o,"id","message_list"),_(o,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),_(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,c){v(a,e,c),k(e,n),k(e,l),k(e,o);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(o,null)},p(a,[c]){if(c&1){r=ge(a[0]);let u;for(u=0;u<r.length;u+=1){const d=un(a,r,u);i[u]?i[u].p(d,c):(i[u]=dn(d),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},i:B,o:B,d(a){a&&w(e),Ae(i,a)}}}function Qs(t,e,n){let{logs:l}=e;return t.$$set=o=>{"logs"in o&&n(0,l=o.logs)},[l]}class el extends me{constructor(e){super(),he(this,e,Qs,Ks,_e,{logs:0})}}function fn(t,e,n){const l=t.slice();return l[7]=e[n],l}function pn(t,e){let n,l=e[7].user.displayName+"",o,r;return{key:t,first:null,c(){n=m("option"),o=z(l),n.__value=r=e[7].user.userId,K(n,n.__value),_(n,"class","dark:bg-slate-900"),this.first=n},m(i,a){v(i,n,a),k(n,o)},p(i,a){e=i,a&2&&l!==(l=e[7].user.displayName+"")&&pe(o,l),a&2&&r!==(r=e[7].user.userId)&&(n.__value=r,K(n,n.__value))},d(i){i&&w(n)}}}function tl(t){let e,n,l=[],o=new Map,r,i,a,c,u,d,f,b,g,p=ge(t[1]);const y=h=>h[7].user.userId;for(let h=0;h<p.length;h+=1){let L=fn(t,p,h),$=y(L);o.set($,l[h]=pn($,L))}return{c(){e=m("select"),n=m("option"),n.textContent="Select a user";for(let h=0;h<l.length;h+=1)l[h].c();r=P(),i=m("div"),a=m("button"),a.textContent="Log In",c=P(),u=m("button"),d=z("Log Out"),n.__value=null,K(n,n.__value),n.disabled=!0,_(n,"class","dark:bg-slate-900"),_(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),t[0].selected.user_id===void 0&&Ye(()=>t[4].call(e)),_(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(u,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),u.disabled=f=!t[0].selected.user_id,_(i,"class","mt-5 flex")},m(h,L){v(h,e,L),k(e,n);for(let $=0;$<l.length;$+=1)l[$]&&l[$].m(e,null);xe(e,t[0].selected.user_id,!0),v(h,r,L),v(h,i,L),k(i,a),k(i,c),k(i,u),k(u,d),b||(g=[N(e,"change",t[4]),N(a,"click",t[5]),N(u,"click",t[6])],b=!0)},p(h,[L]){L&2&&(p=ge(h[1]),l=qn(l,L,y,1,h,p,o,e,Fn,pn,null,fn)),L&3&&xe(e,h[0].selected.user_id),L&3&&f!==(f=!h[0].selected.user_id)&&(u.disabled=f)},i:B,o:B,d(h){h&&(w(e),w(r),w(i));for(let L=0;L<l.length;L+=1)l[L].d();b=!1,re(g)}}}function nl(t,e,n){let l,o;const{sessions:r,config:i}=M;ke(t,r,d=>n(1,o=d)),ke(t,i,d=>n(0,l=d));function a(){l.selected.user_id=Tt(this),i.set(l)}return[l,o,r,i,a,()=>{const{origin:d,redirect:f,clientid:b}=R.env;Se.openLoginWindow(d,f,b)},async()=>{l.selected.user_id&&(await ne.logout(l.selected.user_id),ne.saveCredentials())}]}class sl extends me{constructor(e){super(),he(this,e,nl,tl,_e,{})}}function ll(t,{callback:e,ignore:n=[]}){const l=o=>{const r=n.some(i=>i.contains(o.target));t&&!t.contains(o.target)&&!o.defaultPrevented&&!r&&e()};return document.addEventListener("click",l,!0),document.addEventListener("contextmenu",l,!0),{destroy(){document.removeEventListener("click",l,!0),document.removeEventListener("contextmenu",l,!0)}}}const ol=t=>({}),_n=t=>({});function gn(t){let e,n,l,o,r,i;const a=t[9].content,c=pt(a,t,t[8],_n);return{c(){e=m("div"),c&&c.c(),_(e,"class",n="dropdown-color absolute z-20 rounded-lg border-2 "+t[1]+" "+t[2]+" svelte-xifudk")},m(u,d){v(u,e,d),c&&c.m(e,null),o=!0,r||(i=On(l=ll.call(null,e,{callback:t[3],ignore:[t[5]]})),r=!0)},p(u,d){c&&c.p&&(!o||d&256)&&gt(c,a,u,u[8],o?_t(a,u[8],d,ol):ht(u[8]),_n),(!o||d&6&&n!==(n="dropdown-color absolute z-20 rounded-lg border-2 "+u[1]+" "+u[2]+" svelte-xifudk"))&&_(e,"class",n),l&&ft(l.update)&&d&32&&l.update.call(null,{callback:u[3],ignore:[u[5]]})},i(u){o||(q(c,u),o=!0)},o(u){W(c,u),o=!1},d(u){u&&w(e),c&&c.d(u),r=!1,i()}}}function rl(t){let e,n,l,o,r,i,a;const c=t[9].default,u=pt(c,t,t[8],null);let d=t[4]&&gn(t);return{c(){e=m("div"),n=m("button"),u&&u.c(),l=P(),d&&d.c(),_(e,"class",o="relative h-fit w-fit "+t[0]+" svelte-xifudk")},m(f,b){v(f,e,b),k(e,n),u&&u.m(n,null),t[10](n),k(e,l),d&&d.m(e,null),r=!0,i||(a=N(n,"click",t[6]),i=!0)},p(f,[b]){u&&u.p&&(!r||b&256)&&gt(u,c,f,f[8],r?_t(c,f[8],b,null):ht(f[8]),null),f[4]?d?(d.p(f,b),b&16&&q(d,1)):(d=gn(f),d.c(),q(d,1),d.m(e,null)):d&&(nt(),W(d,1,1,()=>{d=null}),st()),(!r||b&1&&o!==(o="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&_(e,"class",o)},i(f){r||(q(u,f),q(d),r=!0)},o(f){W(u,f),W(d),r=!1},d(f){f&&w(e),u&&u.d(f),t[10](null),d&&d.d(),i=!1,a()}}}function il(t,e,n){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,c=!1,u;function d(){n(4,c=!0)}function f(){n(4,c=!1)}function b(){c?f():d()}function g(p){Pe[p?"unshift":"push"](()=>{u=p,n(5,u)})}return t.$$set=p=>{"class"in p&&n(0,r=p.class),"position"in p&&n(1,i=p.position),"align"in p&&n(2,a=p.align),"$$scope"in p&&n(8,o=p.$$scope)},[r,i,a,f,c,u,b,d,o,l,g]}class al extends me{constructor(e){super(),he(this,e,il,rl,_e,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function cl(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$;return{c(){e=m("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,n=P(),l=m("div"),o=m("label"),o.textContent="Check game announcements:",r=P(),i=m("input"),a=P(),c=m("div"),u=m("label"),u.textContent="Close Bolt after launching a game:",d=P(),f=m("input"),b=P(),g=m("div"),p=m("label"),p.textContent="Discard expired login sessions:",y=P(),h=m("input"),_(e,"id","data_dir_button"),_(e,"class","p-2 hover:opacity-75"),_(o,"for","check_announcements"),_(i,"id","check_announcements"),_(i,"type","checkbox"),_(i,"class","ml-2"),_(l,"class","mx-auto p-2"),_(l,"title",ul),_(u,"for","close_after_launch"),_(f,"id","close_after_launch"),_(f,"type","checkbox"),_(f,"class","ml-2"),_(c,"class","mx-auto p-2"),_(c,"title",dl),_(p,"for","discard_expired_logins"),_(h,"id","discard_expired_logins"),_(h,"type","checkbox"),_(h,"class","ml-2"),_(g,"class","mx-auto p-2"),_(g,"title",fl)},m(x,I){v(x,e,I),v(x,n,I),v(x,l,I),k(l,o),k(l,r),k(l,i),i.checked=t[0].check_announcements,v(x,a,I),v(x,c,I),k(c,u),k(c,d),k(c,f),f.checked=t[0].close_after_launch,v(x,b,I),v(x,g,I),k(g,p),k(g,y),k(g,h),h.checked=t[0].discard_expired_sessions,L||($=[N(e,"click",t[3]),N(i,"change",t[4]),N(f,"change",t[5]),N(h,"change",t[6])],L=!0)},p(x,[I]){I&1&&(i.checked=x[0].check_announcements),I&1&&(f.checked=x[0].close_after_launch),I&1&&(h.checked=x[0].discard_expired_sessions)},i:B,o:B,d(x){x&&(w(e),w(n),w(l),w(a),w(c),w(b),w(g)),L=!1,re($)}}}const ul="Allow checking for official announcements about game status. These will be displayed above the 'play' button. Disabling will reduce the number of web requests made when opening the launcher.",dl="Close the launcher immediately after launching a game",fl="Discard login sessions if they're no longer valid, prompting the player to sign-in again. If unchecked, the only way to discard a login will be by manually pressing the 'log out' button, even if your login no longer works.";function pl(t,e,n){let l;function o(){var d=new XMLHttpRequest;d.open("GET","/browse-data"),d.onreadystatechange=()=>{d.readyState==4&&A.info(`Browse status: '${d.responseText.trim()}'`)},d.send()}const{config:r}=M;ke(t,r,d=>n(0,l=d));const i=()=>{o()};function a(){l.check_announcements=this.checked,r.set(l)}function c(){l.close_after_launch=this.checked,r.set(l)}function u(){l.discard_expired_sessions=this.checked,r.set(l)}return[l,o,r,i,a,c,u]}class _l extends me{constructor(e){super(),he(this,e,pl,cl,_e,{})}}function gl(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$,x,I,O,U,S,C,T,j,D,le,ee,G,Q,V,se,E,te,Ce,fe,Ne,$e,Ke,lt;return{c(){var J,Y;e=m("button"),n=m("div"),n.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,o=P(),r=m("div"),i=m("label"),i.textContent="Use custom RuneLite JAR:",a=P(),c=m("input"),u=P(),d=m("div"),f=m("textarea"),g=P(),p=m("br"),y=P(),h=m("button"),L=z("Select File"),x=P(),I=m("div"),O=m("label"),O.textContent="OSRS launch command:",U=P(),S=m("br"),C=P(),T=m("textarea"),j=P(),D=m("div"),le=m("label"),le.textContent="RuneLite launch command:",ee=P(),G=m("br"),Q=P(),V=m("textarea"),se=P(),E=m("div"),te=m("label"),te.textContent="HDOS launch command:",Ce=P(),fe=m("br"),Ne=P(),$e=m("textarea"),_(n,"class","flex"),e.disabled=l=!((J=t[0])!=null&&J.session_id)||!((Y=t[3])!=null&&Y.accountId),_(e,"class","p-2 pb-5 hover:opacity-75"),_(i,"for","use_custom_jar"),_(c,"id","use_custom_jar"),_(c,"type","checkbox"),_(c,"class","ml-2"),_(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),_(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=b=!t[1].runelite_use_custom_jar,_(h,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 enabled:hover:opacity-75"),h.disabled=$=t[2]||!t[1].runelite_use_custom_jar,_(d,"class","mx-auto p-2"),ue(d,"opacity-25",!t[1].runelite_use_custom_jar),_(O,"for","osrs_custom_launch_command"),_(T,"id","osrs_custom_launch_command"),_(T,"class","resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),_(T,"rows","1"),_(T,"cols","35"),_(T,"placeholder","%command%"),_(I,"class","p-2"),_(le,"for","runelite_custom_launch_command"),_(V,"id","runelite_custom_launch_command"),_(V,"class","resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),_(V,"rows","1"),_(V,"cols","35"),_(V,"placeholder","%command%"),_(D,"class","p-2"),_(te,"for","hdos_custom_launch_command"),_($e,"id","hdos_custom_launch_command"),_($e,"class","resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),_($e,"rows","1"),_($e,"cols","35"),_($e,"placeholder","%command%"),_(E,"class","p-2")},m(J,Y){v(J,e,Y),k(e,n),v(J,o,Y),v(J,r,Y),k(r,i),k(r,a),k(r,c),c.checked=t[1].runelite_use_custom_jar,v(J,u,Y),v(J,d,Y),k(d,f),K(f,t[1].runelite_custom_jar),k(d,g),k(d,p),k(d,y),k(d,h),k(h,L),v(J,x,Y),v(J,I,Y),k(I,O),k(I,U),k(I,S),k(I,C),k(I,T),K(T,t[1].osrs_launch_command),v(J,j,Y),v(J,D,Y),k(D,le),k(D,ee),k(D,G),k(D,Q),k(D,V),K(V,t[1].runelite_launch_command),v(J,se,Y),v(J,E,Y),k(E,te),k(E,Ce),k(E,fe),k(E,Ne),k(E,$e),K($e,t[1].hdos_launch_command),Ke||(lt=[N(e,"click",t[7]),N(c,"change",t[8]),N(f,"input",t[9]),N(h,"click",t[10]),N(T,"input",t[11]),N(V,"input",t[12]),N($e,"input",t[13])],Ke=!0)},p(J,[Y]){var ot,rt;Y&9&&l!==(l=!((ot=J[0])!=null&&ot.session_id)||!((rt=J[3])!=null&&rt.accountId))&&(e.disabled=l),Y&2&&(c.checked=J[1].runelite_use_custom_jar),Y&2&&b!==(b=!J[1].runelite_use_custom_jar)&&(f.disabled=b),Y&2&&K(f,J[1].runelite_custom_jar),Y&6&&$!==($=J[2]||!J[1].runelite_use_custom_jar)&&(h.disabled=$),Y&2&&ue(d,"opacity-25",!J[1].runelite_use_custom_jar),Y&2&&K(T,J[1].osrs_launch_command),Y&2&&K(V,J[1].runelite_launch_command),Y&2&&K($e,J[1].hdos_launch_command)},i:B,o:B,d(J){J&&(w(e),w(o),w(r),w(u),w(d),w(x),w(I),w(j),w(D),w(se),w(E)),Ke=!1,re(lt)}}}function hl(t,e,n){let l,o,r;const{config:i}=M;ke(t,i,L=>n(1,r=L));let a=!1;async function c(){n(2,a=!0),Re(i,r.runelite_custom_jar=await ne.openFilePicker(),r),console.log("done picking"),n(2,a=!1)}function u(){!(l!=null&&l.session_id)||!(o!=null&&o.accountId)||!(o!=null&&o.displayName)||$n(l.session_id,o.accountId,o.displayName,!0)}const d=()=>u();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function b(){r.runelite_custom_jar=this.value,i.set(r)}const g=()=>{c()};function p(){r.osrs_launch_command=this.value,i.set(r)}function y(){r.runelite_launch_command=this.value,i.set(r)}function h(){r.hdos_launch_command=this.value,i.set(r)}return t.$$.update=()=>{var L;t.$$.dirty&2&&n(0,l=ne.findSession(r.selected.user_id)),t.$$.dirty&3&&n(3,o=ne.findAccount((l==null?void 0:l.accounts)??[],(L=r.userDetails[r.selected.user_id??""])==null?void 0:L.account_id))},[l,r,a,o,i,c,u,d,f,b,g,p,y,h]}class ml extends me{constructor(e){super(),he(this,e,hl,gl,_e,{})}}function bl(t){let e,n,l,o,r,i;return{c(){e=m("div"),n=m("label"),n.textContent="Enable Bolt plugin loader:",l=P(),o=m("input"),_(n,"for","enable_plugins"),_(o,"type","checkbox"),_(o,"name","enable_plugins"),_(o,"id","enable_plugins"),_(o,"class","ml-2"),_(e,"class","mx-auto p-2")},m(a,c){v(a,e,c),k(e,n),k(e,l),k(e,o),o.checked=t[0].rs_plugin_loader,r||(i=N(o,"change",t[2]),r=!0)},p(a,c){c&1&&(o.checked=a[0].rs_plugin_loader)},d(a){a&&w(e),r=!1,i()}}}function kl(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$,x=R.hasBoltPlugins&&bl(t);return{c(){x&&x.c(),e=P(),n=m("div"),l=m("label"),l.textContent="Use custom config URI:",o=P(),r=m("input"),i=P(),a=m("div"),c=m("textarea"),d=P(),f=m("div"),b=m("label"),b.textContent="Launch command:",g=P(),p=m("br"),y=P(),h=m("textarea"),_(l,"for","use_custom_uri"),_(r,"id","use_custom_uri"),_(r,"type","checkbox"),_(r,"class","ml-2"),_(n,"class","mx-auto p-2"),_(c,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),c.disabled=u=!t[0].use_custom_rs_config_uri,_(c,"rows","4"),_(c,"placeholder",R.env.default_config_uri),_(a,"class","p-2"),_(b,"for","rs_custom_launch_command"),_(h,"id","rs_custom_launch_command"),_(h,"class","resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),_(h,"rows","1"),_(h,"cols","35"),_(h,"placeholder","%command%"),_(f,"class","p-2")},m(I,O){x&&x.m(I,O),v(I,e,O),v(I,n,O),k(n,l),k(n,o),k(n,r),r.checked=t[0].use_custom_rs_config_uri,v(I,i,O),v(I,a,O),k(a,c),K(c,t[0].rs_config_uri),v(I,d,O),v(I,f,O),k(f,b),k(f,g),k(f,p),k(f,y),k(f,h),K(h,t[0].rs_launch_command),L||($=[N(r,"change",t[3]),N(c,"input",t[4]),N(h,"input",t[5])],L=!0)},p(I,[O]){R.hasBoltPlugins&&x.p(I,O),O&1&&(r.checked=I[0].use_custom_rs_config_uri),O&1&&u!==(u=!I[0].use_custom_rs_config_uri)&&(c.disabled=u),O&1&&K(c,I[0].rs_config_uri),O&1&&K(h,I[0].rs_launch_command)},i:B,o:B,d(I){I&&(w(e),w(n),w(i),w(a),w(d),w(f)),x&&x.d(I),L=!1,re($)}}}function wl(t,e,n){let l;const{config:o}=M;ke(t,o,u=>n(0,l=u));function r(){l.rs_plugin_loader=this.checked,o.set(l)}function i(){l.use_custom_rs_config_uri=this.checked,o.set(l)}function a(){l.rs_config_uri=this.value,o.set(l)}function c(){l.rs_launch_command=this.value,o.set(l)}return[l,o,r,i,a,c]}class vl extends me{constructor(e){super(),he(this,e,wl,kl,_e,{})}}function yl(t){let e,n;return e=new vl({}),{c(){de(e.$$.fragment)},m(l,o){ie(e,l,o),n=!0},i(l){n||(q(e.$$.fragment,l),n=!0)},o(l){W(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function $l(t){let e,n;return e=new ml({}),{c(){de(e.$$.fragment)},m(l,o){ie(e,l,o),n=!0},i(l){n||(q(e.$$.fragment,l),n=!0)},o(l){W(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function Sl(t){let e,n;return e=new _l({}),{c(){de(e.$$.fragment)},m(l,o){ie(e,l,o),n=!0},i(l){n||(q(e.$$.fragment,l),n=!0)},o(l){W(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function Cl(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$,x,I;const O=[Sl,$l,yl],U=[];function S(C,T){return C[1]==C[2].general?0:C[1]==C[2].osrs?1:C[1]==C[2].rs3?2:-1}return~(h=S(t))&&(L=U[h]=O[h](t)),{c(){e=m("div"),n=m("div"),l=m("button"),o=z("General"),i=P(),a=m("button"),c=z("OSRS"),d=P(),f=m("button"),b=z("RS3"),p=P(),y=m("div"),L&&L.c(),_(l,"class",r=t[1]===t[2].general?qe:ze),_(a,"class",u=t[1]===t[2].osrs?qe:ze),_(f,"class",g=t[1]===t[2].rs3?qe:ze),_(n,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),_(y,"class","col-span-3 p-5 pt-10 text-center"),_(e,"class","grid h-full grid-cols-4")},m(C,T){v(C,e,T),k(e,n),k(n,l),k(l,o),k(n,i),k(n,a),k(a,c),k(n,d),k(n,f),k(f,b),k(e,p),k(e,y),~h&&U[h].m(y,null),$=!0,x||(I=[N(l,"click",t[4]),N(a,"click",t[5]),N(f,"click",t[6])],x=!0)},p(C,T){(!$||T&2&&r!==(r=C[1]===C[2].general?qe:ze))&&_(l,"class",r),(!$||T&2&&u!==(u=C[1]===C[2].osrs?qe:ze))&&_(a,"class",u),(!$||T&2&&g!==(g=C[1]===C[2].rs3?qe:ze))&&_(f,"class",g);let j=h;h=S(C),h!==j&&(L&&(nt(),W(U[j],1,1,()=>{U[j]=null}),st()),~h?(L=U[h],L||(L=U[h]=O[h](C),L.c()),q(L,1),L.m(y,null)):L=null)},i(C){$||(q(L),$=!0)},o(C){W(L),$=!1},d(C){C&&w(e),~h&&U[h].d(),x=!1,re(I)}}}function Ll(t){let e,n,l={class:"h-3/4 w-3/4 select-none",$$slots:{default:[Cl]},$$scope:{ctx:t}};return e=new bt({props:l}),t[7](e),{c(){de(e.$$.fragment)},m(o,r){ie(e,o,r),n=!0},p(o,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){t[7](null),ae(e,o)}}}let qe="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",ze="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function Pl(t,e,n){let l;function o(){l.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=0;const a=()=>{n(1,i=r.general)},c=()=>{n(1,i=r.osrs)},u=()=>{n(1,i=r.rs3)};function d(f){Pe[f?"unshift":"push"](()=>{l=f,n(0,l)})}return[l,i,r,o,a,c,u,d]}class Rl extends me{constructor(e){super(),he(this,e,Pl,Ll,_e,{open:3})}get open(){return this.$$.ctx[3]}}function Il(t){const e=t.slice(),n=ne.findSession(e[1].selected.user_id??"");return e[11]=n,e}function Ul(t){let e,n,l;return{c(){e=m("button"),e.textContent="Login",_(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(o,r){v(o,e,r),n||(l=N(e,"click",t[10]),n=!0)},p:B,i:B,o:B,d(o){o&&w(e),n=!1,l()}}}function Hl(t){let e,n;return e=new al({props:{align:"center",$$slots:{content:[Tl],default:[Ol]},$$scope:{ctx:t}}}),{c(){de(e.$$.fragment)},m(l,o){ie(e,l,o),n=!0},p(l,o){const r={};o&4098&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(q(e.$$.fragment,l),n=!0)},o(l){W(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function Ol(t){var o;let e,n=(((o=t[11])==null?void 0:o.user.displayName)??"No user selected")+"",l;return{c(){e=m("button"),l=z(n),_(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){v(r,e,i),k(e,l)},p(r,i){var a;i&2&&n!==(n=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&pe(l,n)},d(r){r&&w(e)}}}function Tl(t){let e,n,l;return n=new sl({}),{c(){e=m("div"),de(n.$$.fragment),_(e,"slot","content"),_(e,"class","w-40")},m(o,r){v(o,e,r),ie(n,e,null),l=!0},p:B,i(o){l||(q(n.$$.fragment,o),l=!0)},o(o){W(n.$$.fragment,o),l=!1},d(o){o&&w(e),ae(n)}}}function xl(t){let e,n,l,o,r,i,a,c,u,d,f,b,g,p,y,h,L,$,x={};e=new Rl({props:x}),t[5](e);const I=[Hl,Ul],O=[];function U(C,T){return C[2].length>0?0:1}function S(C,T){return T===0?Il(C):C}return p=U(t),y=O[p]=I[p](S(t,p)),{c(){de(e.$$.fragment),n=P(),l=m("div"),o=m("div"),r=m("button"),r.textContent="RS3",i=P(),a=m("button"),a.textContent="OSRS",c=P(),u=m("div"),d=m("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=P(),b=m("button"),b.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',g=P(),y.c(),_(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),ue(r,"text-black",t[1].selected.game===ce.rs3),ue(r,"bg-blue-500",t[1].selected.game===ce.rs3),_(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),ue(a,"text-black",t[1].selected.game===ce.osrs),ue(a,"bg-blue-500",t[1].selected.game===ce.osrs),_(o,"class","m-3 ml-9 font-bold"),_(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),_(b,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),_(u,"class","m-2 ml-auto flex gap-2"),_(l,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(C,T){ie(e,C,T),v(C,n,T),v(C,l,T),k(l,o),k(o,r),k(o,i),k(o,a),k(l,c),k(l,u),k(u,d),k(u,f),k(u,b),k(u,g),O[p].m(u,null),h=!0,L||($=[N(r,"click",t[6]),N(a,"click",t[7]),N(d,"click",t[8]),N(b,"click",t[9])],L=!0)},p(C,[T]){const j={};e.$set(j),(!h||T&2)&&ue(r,"text-black",C[1].selected.game===ce.rs3),(!h||T&2)&&ue(r,"bg-blue-500",C[1].selected.game===ce.rs3),(!h||T&2)&&ue(a,"text-black",C[1].selected.game===ce.osrs),(!h||T&2)&&ue(a,"bg-blue-500",C[1].selected.game===ce.osrs);let D=p;p=U(C),p===D?O[p].p(S(C,p),T):(nt(),W(O[D],1,1,()=>{O[D]=null}),st(),y=O[p],y?y.p(S(C,p),T):(y=O[p]=I[p](S(C,p)),y.c()),q(y,1),y.m(u,null))},i(C){h||(q(e.$$.fragment,C),q(y),h=!0)},o(C){W(e.$$.fragment,C),W(y),h=!1},d(C){C&&(w(n),w(l)),t[5](null),ae(e,C),O[p].d(),L=!1,re($)}}}function Nl(t,e,n){let l,o;const{config:r,sessions:i}=M;ke(t,r,p=>n(1,l=p)),ke(t,i,p=>n(2,o=p));let a;function c(p){Pe[p?"unshift":"push"](()=>{a=p,n(0,a)})}return[a,l,o,r,i,c,()=>{Re(r,l.selected.game=ce.rs3,l)},()=>{Re(r,l.selected.game=ce.osrs,l)},()=>Re(r,l.use_dark_theme=!l.use_dark_theme,l),()=>a.open(),()=>{const{origin:p,redirect:y,clientid:h}=R.env;Se.openLoginWindow(p,y,h)}]}class jl extends me{constructor(e){super(),he(this,e,Nl,xl,_e,{})}}function El(t){let e,n,l,o,r,i,a,c,u,d,f,b,g;return e=new is({}),l=new jl({}),c=new Zs({}),b=new el({props:{logs:t[0]}}),{c(){de(e.$$.fragment),n=P(),de(l.$$.fragment),o=P(),r=m("div"),i=m("div"),a=P(),de(c.$$.fragment),u=P(),d=m("div"),f=P(),de(b.$$.fragment),_(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,y){ie(e,p,y),v(p,n,y),ie(l,p,y),v(p,o,y),v(p,r,y),k(r,i),k(r,a),ie(c,r,null),k(r,u),k(r,d),v(p,f,y),ie(b,p,y),g=!0},p(p,y){const h={};y&1&&(h.logs=p[0]),b.$set(h)},i(p){g||(q(e.$$.fragment,p),q(l.$$.fragment,p),q(c.$$.fragment,p),q(b.$$.fragment,p),g=!0)},o(p){W(e.$$.fragment,p),W(l.$$.fragment,p),W(c.$$.fragment,p),W(b.$$.fragment,p),g=!1},d(p){p&&(w(n),w(o),w(r),w(f)),ae(e,p),ae(l,p),ae(c),ae(b,p)}}}function Ml(t){let e,n,l,o;return e=new yn({props:{$$slots:{default:[El]},$$scope:{ctx:t}}}),{c(){de(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0,l||(o=N(window,"beforeunload",t[2]),l=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){W(e.$$.fragment,r),n=!1},d(r){ae(e,r),l=!1,o()}}}function Al(t,e,n){let l;const o=A.logs;return ke(t,o,i=>n(0,l=i)),[l,o,()=>{ne.saveConfig(),R.hasBoltPlugins&&ne.savePluginConfig(!0)}]}class Dl extends me{constructor(e){super(),he(this,e,Al,Ml,_e,{})}}const hn={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new ts(hn):(Bl(),Xn(),Fl(),ql().finally(()=>{M.initialized.set(!0)}),new Dl(hn));function Bl(){const t=new URLSearchParams(window.location.search);R.platform=t.get("platform"),R.isFlathub=t.get("flathub")==="1",R.hasLibArchive=t.get("has_libarchive")==="1",R.rs3debInstalledHash=t.get("rs3_deb_installed_hash"),R.rs3exeInstalledHash=t.get("rs3_exe_installed_hash"),R.rs3appInstalledHash=t.get("rs3_app_installed_hash"),R.osrsexeInstalledHash=t.get("osrs_exe_installed_hash"),R.osrsappInstalledHash=t.get("osrs_app_installed_hash"),R.runeLiteInstalledId=t.get("runelite_installed_id"),R.hdosInstalledVersion=t.get("hdos_installed_version");const e=t.get("plugins");if(R.hasBoltPlugins=e!==null,e!==null)try{R.pluginConfig=JSON.parse(e)}catch{A.error("Unable to parse plugin list")}const n=t.get("credentials");if(n)try{const l=JSON.parse(n),o=l.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");o?M.sessions.set(l):(M.sessions.set([]),ne.saveCredentials(),A.warn("Credentials saved on disk are out of date. Please sign in again.")),M.sessions.set(o?l:[])}catch{M.sessions.set([]),ne.saveCredentials(),A.error("Unable to parse saved credentials. Please sign in again.")}}function Fl(){const{origin:t,origin_2fa:e}=R.env,n=[window.location.origin,t,e];let l=null;window.addEventListener("message",async o=>{var r;if(!n.includes(o.origin)){A.info(`discarding window message from origin ${o.origin}`);return}switch(o.data.type){case"authTokenUpdate":{l=o.data.tokens;break}case"authSessionUpdate":{if(l===null)return A.error("auth is null. Please try again.");const i=o.data.sessionId,a=await ne.login(l,i);a.ok?A.info(`Added new user '${a.value.user.displayName}'`):A.error(`Unable to add new user. Please try again. ${a.error}`),ne.saveCredentials(),Se.pendingLoginWindow=null,l=null;break}case"authFailed":{A.error(`Unable to authenticate: ${o.data.reason}`),Se.pendingLoginWindow=null,l=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&A.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(o.data.url);break}case"gameClientList":ve(M.config).close_after_launch&&o.data.clients.length>ve(Ot).length?fetch("/close"):Ot.set(o.data.clients);break;default:{const i=((r=o.data)==null?void 0:r.type)??"no type provided";A.info(`Unknown message type: ${i}`);break}}})}async function ql(){const t=ve(M.config).discard_expired_sessions,e=ve(M.sessions),n=[];e.length>0&&A.info("Logging in...");const l=e.map(i=>({promise:Se.refreshOAuthToken(i.tokens),session:i})),o=[];for(const i of l){const a=i.session,c=await i.promise;if(!c.ok){c.error===0?A.error(`Unable to verify saved login, status: ${c.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):c.error>=400&&c.error<500&&t?(A.error(`Discarding expired login, status: ${c.error}. Please sign in again.`),n.push(a.tokens.sub)):A.error(`Unable to verify saved login due to HTTP error ${c.error}`);continue}const u=c.value;a.tokens=u,o.push({promise:ne.login(u,a.session_id),session:a})}for(const i of o){const a=i.session,c=await i.promise;c.ok?A.info(`Signed into saved user '${c.value.user.displayName}'`):(A.error(`Unable to sign into saved user '${a.user.displayName}' due to an error: ${c.error}`),t&&n.push(a.tokens.sub))}const r=n.map(ne.logout);for(const i of r)await i;M.sessions.set(e),await ne.saveCredentials()}
