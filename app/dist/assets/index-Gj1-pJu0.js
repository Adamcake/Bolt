(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var yr=(e=>(e[e.SECOND=1e3]="SECOND",e[e.MINUTE=6e4]="MINUTE",e[e.HALF_HOUR=18e5]="HALF_HOUR",e[e.HOUR=36e5]="HOUR",e[e.DAY=864e5]="DAY",e[e.WEEK=6048e5]="WEEK",e[e.MONTH=2592e6]="MONTH",e))(yr||{});class Qt{static set(t,n,r,a){const o=new Date;o.setTime(o.getTime()+r*a);const i=`expires=${o.toUTCString()}`;document.cookie=`${t}=${n};${i};path=/`}static get(t){const n=`${t}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let o=r[a];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(n)===0)return o.substring(n.length,o.length)}return null}static remove(t){document.cookie=`${t}=; Max-Age=-99999999;`}}function et(e){return{ok:!0,value:e}}function ae(e){return{ok:!1,error:e}}var Le=(e=>(e.rs3="rs3",e.osrs="osrs",e))(Le||{}),tn=(e=>(e.official="Official",e.runelite="RuneLite",e.hdos="HDOS",e))(tn||{});const da={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class Un{static parseTokenResponse(t){try{const n=JSON.parse(t),r=n.id_token.split(".");if(r.length!==3){const i=`Malformed id_token: ${r.length} sections, expected 3`;return ae(i)}const a=JSON.parse(atob(r[0]));if(a.typ!=="JWT"){const i=`Bad id_token header: typ ${a.typ}, expected JWT`;return ae(i)}const o=JSON.parse(atob(r[1]));return et({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:o.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return ae("Unable to parse token response")}}static parseSessionResponse(t){try{const n=JSON.parse(t);return n.sessionId?et(n.sessionId):ae("sessionId does not exist on parsed object")}catch{return ae("Unable to parse session response")}}static decodeBolt(t){const n={};for(const r in t){const a=r,o=t[a];typeof o=="string"?n[a]=atob(o):Array.isArray(o)&&o.every(i=>typeof i=="string")?n[a]=o.map(i=>atob(i)):n[a]=o}return n}}var kr=(e=>(e.Windows="windows",e.Linux="linux",e.MacOS="mac",e))(kr||{});const $={env:Un.decodeBolt(s()),platform:null,rs3debInstalledHash:null,rs3exeInstalledHash:null,rs3appInstalledHash:null,osrsexeInstalledHash:null,osrsappInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasLibArchive:!1,hasBoltPlugins:!1,pluginConfig:{}};class cr{static async makeLoginUrl(t){const n=new TextEncoder().encode(t.pkceCodeVerifier),r=await crypto.subtle.digest("SHA-256",n);let a="";const o=new Uint8Array(r);for(let u=0;u<o.byteLength;u++)a+=String.fromCharCode(o[u]);const i=btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:t.authMethod,login_type:t.loginType,flow:t.flow,response_type:"code",client_id:t.clientid,redirect_uri:t.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:t.pkceState}).toString())}static makeRandomVerifier(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(r){return t[r%t.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=n.length-1,a=crypto.getRandomValues(new Uint8Array(12));return Array.from(a).map(o=>Math.round(o*(r-0)/255+0)).map(o=>n[o]).join("")}}class Pe{static pendingLoginWindow=null;static async openLoginWindow(t,n,r){if(Pe.pendingLoginWindow!==null)return Pe.pendingLoginWindow.window.focus();const a=cr.makeRandomState(),o=cr.makeRandomVerifier(),i=new TextEncoder().encode(o),u=await crypto.subtle.digest("SHA-256",i);let l="";const c=new Uint8Array(u);for(let _=0;_<c.byteLength;_++)l+=String.fromCharCode(c[_]);const f=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:r,redirect_uri:n,code_challenge:f,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:a}),p=`${t}/oauth2/auth?${d.toString()}`;Qt.set("auth_verifier",o,10,yr.MINUTE),Pe.pendingLoginWindow=window.open(p,"","width=480,height=720")}static navigateToAuthConsent(t,n,r){const a=cr.makeRandomState(),o=new URLSearchParams({id_token_hint:n,nonce:r,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:a,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${t}/oauth2/auth?${o.toString()}`;Qt.set("auth_nonce",r,10,yr.MINUTE),window.location.href=i}static async refreshOAuthToken(t){return new Promise(n=>{if(t.expiry-Date.now()<3e4){const r=new URLSearchParams({grant_type:"refresh_token",client_id:$.env.clientid,refresh_token:t.refresh_token}),a=new XMLHttpRequest;a.onreadystatechange=()=>{if(a.readyState==4)if(a.status==200){const i=Un.parseTokenResponse(a.response);i.ok?n(et(i.value)):n(ae(0))}else n(ae(a.status))},a.onerror=()=>{n(ae(0))};const o=$.env.origin.concat("/oauth2/token");a.open("POST",o,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("Accept","application/json"),a.send(r)}else n(et(t))})}static async getOAuthToken(t,n,r,a,o){const i=`${t}/oauth2/token`;return new Promise(u=>{const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const f=Un.parseTokenResponse(l.response);return f.ok?u(et(f.value)):u(ae(f.error))}else return u(ae(`Error: from ${i}: ${l.status}: ${l.response}`))},l.open("POST",i,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json");const c=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:o,code_verifier:r,redirect_uri:a});l.send(c)})}static revokeOauthCreds(t){const n=`${$.env.origin}/oauth2/revoke`;return new Promise(r=>{const a=new XMLHttpRequest;a.open("POST",n,!0),a.onreadystatechange=()=>{a.readyState==4&&r(a.status)},a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const o=new URLSearchParams({token:t,client_id:$.env.clientid});a.send(o)})}static async getSessionId(t,n){const r=`${t}/sessions`;return new Promise(a=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const u=Un.parseSessionResponse(o.response);return u.ok?a(et(u.value)):a(ae(u.error))}else ae(`Error: from ${r}: ${o.status}: ${o.response}`)},o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json");const i={idToken:n};o.send(JSON.stringify(i))})}static validateIdToken(t,n){const r=t.split(".");if(r.length!==3)return ae(`Malformed id_token: ${r.length} sections, expected 3`);const a=JSON.parse(atob(r[0]));return a.typ!=="JWT"?ae(`Bad id_token header: typ ${a.typ}, expected JWT`):JSON.parse(atob(r[1])).nonce!==n?ae("Incorrect nonce in id_token"):et(void 0)}}class Mn{static async buildSession(t,n){const r=await Mn.getUser(t.sub,t.access_token);if(!r.ok)return ae(`Failed to fetch user. Status: ${r.error}`);const a=await Mn.getUserAccounts(n);return a.ok?et({user:r.value,accounts:a.value,tokens:t,session_id:n}):ae(`Failed to fetch game accounts. Status: ${a.error}`)}static getUser(t,n){return new Promise(r=>{const a=`${$.env.api}/users/${t}/displayName`,o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=JSON.parse(o.response);r(et(i))}else r(ae(o.status))},o.open("GET",a,!0),o.setRequestHeader("Authorization","Bearer ".concat(n)),o.send()})}static getUserAccounts(t){const n=`${$.env.auth_api}/accounts`;return new Promise(r=>{const a=new XMLHttpRequest;a.onreadystatechange=async()=>{if(a.readyState==4)if(a.status==200){const o=JSON.parse(a.response);r(et(o))}else r(ae(a.status))},a.open("GET",n,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(t)),a.send()})}}const ps=!1;var zn=Array.isArray,_a=Array.prototype.indexOf,Tr=Array.from,Dn=Object.defineProperty,nn=Object.getOwnPropertyDescriptor,hs=Object.getOwnPropertyDescriptors,va=Object.prototype,pa=Array.prototype,Or=Object.getPrototypeOf,Zr=Object.isExtensible;const nt=()=>{};function ha(e){return typeof e?.then=="function"}function ga(e){return e()}function jn(e){for(var t=0;t<e.length;t++)e[t]()}function ma(){var e,t,n=new Promise((r,a)=>{e=r,t=a});return{promise:n,resolve:e,reject:t}}function ba(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const Me=2,Ar=4,Jn=8,dn=16,yt=32,Gt=64,Ur=128,Ge=256,Fn=512,he=1024,Ve=2048,Ot=4096,rt=8192,_n=16384,Nr=32768,$n=65536,Kr=1<<17,wa=1<<18,vn=1<<19,gs=1<<20,xr=1<<21,Hr=1<<22,Ft=1<<23,Rt=Symbol("$state"),ya=Symbol(""),Mr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ms(e){return e===this.v}function Dr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function bs(e){return!Dr(e,this.v)}function ws(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ka(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xa(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Sa(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function $a(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ea(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function La(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ca(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Pa(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ra(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}let En=!1,Ia=!1;function Ta(){En=!0}const Xn=1,Yn=2,ys=4,Oa=8,Aa=16,Ua=1,Na=2,ue=Symbol(),Ha="http://www.w3.org/1999/xhtml";let ee=null;function Tt(e){ee=e}function me(e,t=!1,n){ee={p:ee,c:null,e:null,s:e,x:null,l:En&&!t?{s:null,u:null,$:[]}:null}}function be(e){var t=ee,n=t.e;if(n!==null){t.e=null;for(var r of n)Bs(r)}return e!==void 0&&(t.x=e),ee=t.p,e??{}}function pn(){return!En||ee!==null&&ee.l===null}let Lt=[],qn=[];function ks(){var e=Lt;Lt=[],jn(e)}function Ma(){var e=qn;qn=[],jn(e)}function Da(){return Lt.length>0||qn.length>0}function Vt(e){if(Lt.length===0&&!yn){var t=Lt;queueMicrotask(()=>{t===Lt&&ks()})}Lt.push(e)}function ja(){Lt.length>0&&ks(),qn.length>0&&Ma()}function Fa(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function qa(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Ba=!1;function en(e){if(typeof e!="object"||e===null||Rt in e)return e;const t=Or(e);if(t!==va&&t!==pa)return e;var n=new Map,r=zn(e),a=oe(0),o=qt,i=u=>{if(qt===o)return u();var l=F,c=qt;ge(null),ss(o);var f=u();return ge(l),ss(c),f};return r&&n.set("length",oe(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&La();var f=n.get(l);return f===void 0?f=i(()=>{var d=oe(c.value);return n.set(l,d),d}):P(f,c.value,!0),!0},deleteProperty(u,l){var c=n.get(l);if(c===void 0){if(l in u){const f=i(()=>oe(ue));n.set(l,f),kn(a)}}else P(c,ue),kn(a);return!0},get(u,l,c){if(l===Rt)return e;var f=n.get(l),d=l in u;if(f===void 0&&(!d||nn(u,l)?.writable)&&(f=i(()=>{var _=en(d?u[l]:ue),h=oe(_);return h}),n.set(l,f)),f!==void 0){var p=v(f);return p===ue?void 0:p}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var f=n.get(l);f&&(c.value=v(f))}else if(c===void 0){var d=n.get(l),p=d?.v;if(d!==void 0&&p!==ue)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return c},has(u,l){if(l===Rt)return!0;var c=n.get(l),f=c!==void 0&&c.v!==ue||Reflect.has(u,l);if(c!==void 0||q!==null&&(!f||nn(u,l)?.writable)){c===void 0&&(c=i(()=>{var p=f?en(u[l]):ue,_=oe(p);return _}),n.set(l,c));var d=v(c);if(d===ue)return!1}return f},set(u,l,c,f){var d=n.get(l),p=l in u;if(r&&l==="length")for(var _=c;_<d.v;_+=1){var h=n.get(_+"");h!==void 0?P(h,ue):_ in u&&(h=i(()=>oe(ue)),n.set(_+"",h))}if(d===void 0)(!p||nn(u,l)?.writable)&&(d=i(()=>oe(void 0)),P(d,en(c)),n.set(l,d));else{p=d.v!==ue;var g=i(()=>en(c));P(d,g)}var m=Reflect.getOwnPropertyDescriptor(u,l);if(m?.set&&m.set.call(f,c),!p){if(r&&typeof l=="string"){var k=n.get("length"),b=Number(l);Number.isInteger(b)&&b>=k.v&&P(k,b+1)}kn(a)}return!0},ownKeys(u){v(a);var l=Reflect.ownKeys(u).filter(d=>{var p=n.get(d);return p===void 0||p.v!==ue});for(var[c,f]of n)f.v!==ue&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Ca()}})}function Qr(e){try{if(e!==null&&typeof e=="object"&&Rt in e)return e[Rt]}catch{}return e}function Wa(e,t){return Object.is(Qr(e),Qr(t))}var Sr,xs,Ss,$s;function Ga(){if(Sr===void 0){Sr=window,xs=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ss=nn(t,"firstChild").get,$s=nn(t,"nextSibling").get,Zr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Zr(n)&&(n.__t=void 0)}}function hn(e=""){return document.createTextNode(e)}function Bn(e){return Ss.call(e)}function Ln(e){return $s.call(e)}function C(e,t){return Bn(e)}function B(e,t=!1){{var n=Bn(e);return n instanceof Comment&&n.data===""?Ln(n):n}}function w(e,t=1,n=!1){let r=e;for(;t--;)r=Ln(r);return r}function Va(e){e.textContent=""}function Es(){return!1}const za=new WeakMap;function Ls(e){var t=q;if(t===null)return F.f|=Ft,e;if((t.f&Nr)===0){if((t.f&Ur)===0)throw!t.parent&&e instanceof Error&&Cs(e),e;t.b.error(e)}else un(e,t)}function un(e,t){for(;t!==null;){if((t.f&Ur)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&Cs(e),e}function Cs(e){const t=za.get(e);t&&(Dn(e,"message",{value:t.message}),Dn(e,"stack",{value:t.stack}))}const fr=new Set;let Z=null,Nn=null,$r=new Set,Wt=[],Zn=null,Er=!1,yn=!1;class vt{current=new Map;#a=new Map;#t=new Set;#d=0;#o=null;#c=!1;#s=[];#n=[];#e=[];#r=[];#i=[];#f=[];#u=[];skipped_effects=new Set;process(t){Wt=[],Nn=null;for(const a of t)this.#_(a);if(this.#s.length===0&&this.#d===0){this.#v();var n=this.#e,r=this.#r;this.#e=[],this.#r=[],this.#i=[],Nn=Z,Z=null,es(n),es(r),Z===null?Z=this:fr.delete(this),this.#o?.resolve()}else this.#l(this.#e),this.#l(this.#r),this.#l(this.#i);for(const a of this.#s)sn(a);for(const a of this.#n)sn(a);this.#s=[],this.#n=[]}#_(t){t.f^=he;for(var n=t.first;n!==null;){var r=n.f,a=(r&(yt|Gt))!==0,o=a&&(r&he)!==0,i=o||(r&rt)!==0||this.skipped_effects.has(n);if(!i&&n.fn!==null){if(a)n.f^=he;else if((r&Ar)!==0)this.#r.push(n);else if((r&he)===0)if((r&Hr)!==0){var u=n.b?.is_pending()?this.#n:this.#s;u.push(n)}else er(n)&&((n.f&dn)!==0&&this.#i.push(n),sn(n));var l=n.first;if(l!==null){n=l;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)n=c.next,c=c.parent}}#l(t){for(const n of t)((n.f&Ve)!==0?this.#f:this.#u).push(n),Re(n,he);t.length=0}capture(t,n){this.#a.has(t)||this.#a.set(t,n),this.current.set(t,t.v)}activate(){Z=this}deactivate(){Z=null,Nn=null;for(const t of $r)if($r.delete(t),t(),Z!==null)break}neuter(){this.#c=!0}flush(){Wt.length>0?Rs():this.#v(),Z===this&&(this.#d===0&&fr.delete(this),this.deactivate())}#v(){if(!this.#c)for(const t of this.#t)t();this.#t.clear()}increment(){this.#d+=1}decrement(){if(this.#d-=1,this.#d===0){for(const t of this.#f)Re(t,Ve),cn(t);for(const t of this.#u)Re(t,Ot),cn(t);this.#e=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(t){this.#t.add(t)}settled(){return(this.#o??=ma()).promise}static ensure(){if(Z===null){const t=Z=new vt;fr.add(Z),yn||vt.enqueue(()=>{Z===t&&t.flush()})}return Z}static enqueue(t){Vt(t)}}function Ps(e){var t=yn;yn=!0;try{for(var n;;){if(ja(),Wt.length===0&&!Da()&&(Z?.flush(),Wt.length===0))return Zn=null,n;Rs()}}finally{yn=t}}function Rs(){var e=rn;Er=!0;try{var t=0;for(ns(!0);Wt.length>0;){var n=vt.ensure();if(t++>1e3){var r,a;Ja()}n.process(Wt),It.clear()}}finally{Er=!1,ns(e),Zn=null}}function Ja(){try{Ea()}catch(e){un(e,Zn)}}let Mt=null;function es(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(_n|rt))===0&&er(r)&&(Mt=[],sn(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Vs(r):r.fn=null),Mt?.length>0)){It.clear();for(const a of Mt)sn(a);Mt=[]}}Mt=null}}function cn(e){for(var t=Zn=e;t.parent!==null;){t=t.parent;var n=t.f;if(Er&&t===q&&(n&dn)!==0)return;if((n&(Gt|yt))!==0){if((n&he)===0)return;t.f^=he}}Wt.push(t)}function Xa(e){let t=0,n=bt(0),r;return()=>{_o()&&(v(n),Cn(()=>(t===0&&(r=R(()=>e(()=>kn(n)))),t+=1,()=>{Vt(()=>{t-=1,t===0&&(r?.(),r=void 0,kn(n))})})))}}var Ya=$n|vn|Ur;function Za(e,t,n){new Ka(e,t,n)}class Ka{parent;#a=!1;#t;#d=null;#o;#c;#s;#n=null;#e=null;#r=null;#i=null;#f=0;#u=0;#_=!1;#l=null;#v=()=>{this.#l&&ut(this.#l,this.#f)};#m=Xa(()=>(this.#l=bt(this.#f),()=>{this.#l=null}));constructor(t,n,r){this.#t=t,this.#o=n,this.#c=r,this.parent=q.b,this.#a=!!this.#o.pending,this.#s=Pn(()=>{q.b=this;{try{this.#n=xe(()=>r(this.#t))}catch(a){this.error(a)}this.#u>0?this.#h():this.#a=!1}},Ya)}#b(){try{this.#n=xe(()=>this.#c(this.#t))}catch(t){this.error(t)}this.#a=!1}#w(){const t=this.#o.pending;t&&(this.#e=xe(()=>t(this.#t)),vt.enqueue(()=>{this.#n=this.#p(()=>(vt.ensure(),xe(()=>this.#c(this.#t)))),this.#u>0?this.#h():(ht(this.#e,()=>{this.#e=null}),this.#a=!1)}))}is_pending(){return this.#a||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#o.pending}#p(t){var n=q,r=F,a=ee;ze(this.#s),ge(this.#s),Tt(this.#s.ctx);try{return t()}catch(o){return Ls(o),null}finally{ze(n),ge(r),Tt(a)}}#h(){const t=this.#o.pending;this.#n!==null&&(this.#i=document.createDocumentFragment(),Qa(this.#n,this.#i)),this.#e===null&&(this.#e=xe(()=>t(this.#t)))}#g(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#g(t);return}this.#u+=t,this.#u===0&&(this.#a=!1,this.#e&&ht(this.#e,()=>{this.#e=null}),this.#i&&(this.#t.before(this.#i),this.#i=null))}update_pending_count(t){this.#g(t),this.#f+=t,$r.add(this.#v)}get_effect_pending(){return this.#m(),v(this.#l)}error(t){var n=this.#o.onerror;let r=this.#o.failed;if(this.#_||!n&&!r)throw t;this.#n&&(He(this.#n),this.#n=null),this.#e&&(He(this.#e),this.#e=null),this.#r&&(He(this.#r),this.#r=null);var a=!1,o=!1;const i=()=>{if(a){qa();return}a=!0,o&&Ra(),vt.ensure(),this.#f=0,this.#r!==null&&ht(this.#r,()=>{this.#r=null}),this.#a=this.has_pending_snippet(),this.#n=this.#p(()=>(this.#_=!1,xe(()=>this.#c(this.#t)))),this.#u>0?this.#h():this.#a=!1};var u=F;try{ge(null),o=!0,n?.(t,i),o=!1}catch(l){un(l,this.#s&&this.#s.parent)}finally{ge(u)}r&&Vt(()=>{this.#r=this.#p(()=>{this.#_=!0;try{return xe(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return un(l,this.#s.parent),null}finally{this.#_=!1}})})}}function Qa(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var a=n===r?null:Ln(n);t.append(n),n=a}}function eo(e,t,n){const r=pn()?Kn:jr;if(t.length===0){n(e.map(r));return}var a=Z,o=q,i=to();Promise.all(t.map(u=>no(u))).then(u=>{a?.activate(),i();try{n([...e.map(r),...u])}catch(l){(o.f&_n)===0&&un(l,o)}a?.deactivate(),Is()}).catch(u=>{un(u,o)})}function to(){var e=q,t=F,n=ee,r=Z;return function(){ze(e),ge(t),Tt(n),r?.activate()}}function Is(){ze(null),ge(null),Tt(null)}function Kn(e){var t=Me|Ve,n=F!==null&&(F.f&Me)!==0?F:null;return q===null||n!==null&&(n.f&Ge)!==0?t|=Ge:q.f|=vn,{ctx:ee,deps:null,effects:null,equals:ms,f:t,fn:e,reactions:null,rv:0,v:ue,wv:0,parent:n??q,ac:null}}function no(e,t){let n=q;n===null&&ka();var r=n.b,a=void 0,o=bt(ue),i=null,u=!F;return ho(()=>{try{var l=e();i&&Promise.resolve(l).catch(()=>{})}catch(_){l=Promise.reject(_)}var c=()=>l;a=i?.then(c,c)??Promise.resolve(l),i=a;var f=Z,d=r.is_pending();u&&(r.update_pending_count(1),d||f.increment());const p=(_,h=void 0)=>{i=null,d||f.activate(),h?h!==Mr&&(o.f|=Ft,ut(o,h)):((o.f&Ft)!==0&&(o.f^=Ft),ut(o,_)),u&&(r.update_pending_count(-1),d||f.decrement()),Is()};if(a.then(p,_=>p(null,_||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(l=>{function c(f){function d(){f===a?l(o):c(a)}f.then(d,d)}c(a)})}function Be(e){const t=Kn(e);return Us(t),t}function jr(e){const t=Kn(e);return t.equals=bs,t}function Ts(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)He(t[n])}}function ro(e){for(var t=e.parent;t!==null;){if((t.f&Me)===0)return t;t=t.parent}return null}function Fr(e){var t,n=q;ze(ro(e));try{Ts(e),t=Ds(e)}finally{ze(n)}return t}function Os(e){var t=Fr(e);if(e.equals(t)||(e.v=t,e.wv=Hs()),!gn){var n=(Ct||(e.f&Ge)!==0)&&e.deps!==null?Ot:he;Re(e,n)}}const It=new Map;function bt(e,t){var n={f:0,v:e,reactions:null,equals:ms,rv:0,wv:0};return n}function oe(e,t){const n=bt(e);return Us(n),n}function We(e,t=!1,n=!0){const r=bt(e);return t||(r.equals=bs),En&&n&&ee!==null&&ee.l!==null&&(ee.l.s??=[]).push(r),r}function P(e,t,n=!1){F!==null&&(!tt||(F.f&Kr)!==0)&&pn()&&(F.f&(Me|dn|Hr|Kr))!==0&&!pt?.includes(e)&&Pa();let r=n?en(t):t;return ut(e,r)}function ut(e,t){if(!e.equals(t)){var n=e.v;gn?It.set(e,t):It.set(e,n),e.v=t;var r=vt.ensure();r.capture(e,n),(e.f&Me)!==0&&((e.f&Ve)!==0&&Fr(e),Re(e,(e.f&Ge)===0?he:Ot)),e.wv=Hs(),As(e,Ve),pn()&&q!==null&&(q.f&he)!==0&&(q.f&(yt|Gt))===0&&(qe===null?io([e]):qe.push(e))}return t}function kn(e){P(e,e.v+1)}function As(e,t){var n=e.reactions;if(n!==null)for(var r=pn(),a=n.length,o=0;o<a;o++){var i=n[o],u=i.f;if(!(!r&&i===q)){var l=(u&Ve)===0;l&&Re(i,t),(u&Me)!==0?As(i,Ot):l&&((u&dn)!==0&&Mt!==null&&Mt.push(i),cn(i))}}}let Kt=null;function so(e){var t=Kt;try{if(Kt=new Set,R(e),t!==null)for(var n of Kt)t.add(n);return Kt}finally{Kt=t}}function ao(e){for(var t of so(e))ut(t,t.v)}let ts=!1;function oo(){ts||(ts=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Qn(e){var t=F,n=q;ge(null),ze(null);try{return e()}finally{ge(t),ze(n)}}function qr(e,t,n,r=n){e.addEventListener(t,()=>Qn(n));const a=e.__on_r;a?e.__on_r=()=>{a(),r(!0)}:e.__on_r=()=>r(!0),oo()}let rn=!1;function ns(e){rn=e}let gn=!1;function rs(e){gn=e}let F=null,tt=!1;function ge(e){F=e}let q=null;function ze(e){q=e}let pt=null;function Us(e){F!==null&&(pt===null?pt=[e]:pt.push(e))}let ke=null,Ue=0,qe=null;function io(e){qe=e}let Ns=1,Sn=0,qt=Sn;function ss(e){qt=e}let Ct=!1;function Hs(){return++Ns}function er(e){var t=e.f;if((t&Ve)!==0)return!0;if((t&Ot)!==0){var n=e.deps,r=(t&Ge)!==0;if(n!==null){var a,o,i=(t&Fn)!==0,u=r&&q!==null&&!Ct,l=n.length;if((i||u)&&(q===null||(q.f&_n)===0)){var c=e,f=c.parent;for(a=0;a<l;a++)o=n[a],(i||!o?.reactions?.includes(c))&&(o.reactions??=[]).push(c);i&&(c.f^=Fn),u&&f!==null&&(f.f&Ge)===0&&(c.f^=Ge)}for(a=0;a<l;a++)if(o=n[a],er(o)&&Os(o),o.wv>e.wv)return!0}(!r||q!==null&&!Ct)&&Re(e,he)}return!1}function Ms(e,t,n=!0){var r=e.reactions;if(r!==null&&!pt?.includes(e))for(var a=0;a<r.length;a++){var o=r[a];(o.f&Me)!==0?Ms(o,t,!1):t===o&&(n?Re(o,Ve):(o.f&he)!==0&&Re(o,Ot),cn(o))}}function Ds(e){var t=ke,n=Ue,r=qe,a=F,o=Ct,i=pt,u=ee,l=tt,c=qt,f=e.f;ke=null,Ue=0,qe=null,Ct=(f&Ge)!==0&&(tt||!rn||F===null),F=(f&(yt|Gt))===0?e:null,pt=null,Tt(e.ctx),tt=!1,qt=++Sn,e.ac!==null&&(Qn(()=>{e.ac.abort(Mr)}),e.ac=null);try{e.f|=xr;var d=e.fn,p=d(),_=e.deps;if(ke!==null){var h;if(Wn(e,Ue),_!==null&&Ue>0)for(_.length=Ue+ke.length,h=0;h<ke.length;h++)_[Ue+h]=ke[h];else e.deps=_=ke;if(!Ct||(f&Me)!==0&&e.reactions!==null)for(h=Ue;h<_.length;h++)(_[h].reactions??=[]).push(e)}else _!==null&&Ue<_.length&&(Wn(e,Ue),_.length=Ue);if(pn()&&qe!==null&&!tt&&_!==null&&(e.f&(Me|Ot|Ve))===0)for(h=0;h<qe.length;h++)Ms(qe[h],e);return a!==null&&a!==e&&(Sn++,qe!==null&&(r===null?r=qe:r.push(...qe))),(e.f&Ft)!==0&&(e.f^=Ft),p}catch(g){return Ls(g)}finally{e.f^=xr,ke=t,Ue=n,qe=r,F=a,Ct=o,pt=i,Tt(u),tt=l,qt=c}}function lo(e,t){let n=t.reactions;if(n!==null){var r=_a.call(n,e);if(r!==-1){var a=n.length-1;a===0?n=t.reactions=null:(n[r]=n[a],n.pop())}}n===null&&(t.f&Me)!==0&&(ke===null||!ke.includes(t))&&(Re(t,Ot),(t.f&(Ge|Fn))===0&&(t.f^=Fn),Ts(t),Wn(t,0))}function Wn(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)lo(e,n[r])}function sn(e){var t=e.f;if((t&_n)===0){Re(e,he);var n=q,r=rn;q=e,rn=!0;try{(t&dn)!==0?go(e):Gs(e),Ws(e);var a=Ds(e);e.teardown=typeof a=="function"?a:null,e.wv=Ns;var o;ps&&Ia&&(e.f&Ve)!==0&&e.deps}finally{rn=r,q=n}}}async function uo(){await Promise.resolve(),Ps()}function v(e){var t=e.f,n=(t&Me)!==0;if(Kt?.add(e),F!==null&&!tt){var r=q!==null&&(q.f&_n)!==0;if(!r&&!pt?.includes(e)){var a=F.deps;if((F.f&xr)!==0)e.rv<Sn&&(e.rv=Sn,ke===null&&a!==null&&a[Ue]===e?Ue++:ke===null?ke=[e]:(!Ct||!ke.includes(e))&&ke.push(e));else{(F.deps??=[]).push(e);var o=e.reactions;o===null?e.reactions=[F]:o.includes(F)||o.push(F)}}}else if(n&&e.deps===null&&e.effects===null){var i=e,u=i.parent;u!==null&&(u.f&Ge)===0&&(i.f^=Ge)}if(gn){if(It.has(e))return It.get(e);if(n){i=e;var l=i.v;return((i.f&he)===0&&i.reactions!==null||js(i))&&(l=Fr(i)),It.set(i,l),l}}else n&&(i=e,er(i)&&Os(i));if((e.f&Ft)!==0)throw e.v;return e.v}function js(e){if(e.v===ue)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(It.has(t)||(t.f&Me)!==0&&js(t))return!0;return!1}function Q(e){return e&&v(e)}function R(e){var t=tt;try{return tt=!0,e()}finally{tt=t}}const co=-7169;function Re(e,t){e.f=e.f&co|t}function Fs(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Rt in e)Lr(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Rt in n&&Lr(n)}}}function Lr(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{Lr(e[r],t)}catch{}const n=Or(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=hs(n);for(let a in r){const o=r[a].get;if(o)try{o.call(e)}catch{}}}}}function qs(e){q===null&&F===null&&$a(),F!==null&&(F.f&Ge)!==0&&q===null&&Sa(),gn&&xa()}function fo(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ct(e,t,n,r=!0){var a=q;a!==null&&(a.f&rt)!==0&&(e|=rt);var o={ctx:ee,deps:null,nodes_start:null,nodes_end:null,f:e|Ve,first:null,fn:t,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{sn(o),o.f|=Nr}catch(l){throw He(o),l}else t!==null&&cn(o);if(r){var i=o;if(n&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&vn)===0&&(i=i.first),i!==null&&(i.parent=a,a!==null&&fo(i,a),F!==null&&(F.f&Me)!==0&&(e&Gt)===0)){var u=F;(u.effects??=[]).push(i)}}return o}function _o(){return F!==null&&!tt}function tr(e){const t=ct(Jn,null,!1);return Re(t,he),t.teardown=e,t}function fn(e){qs();var t=q.f,n=!F&&(t&yt)!==0&&(t&Nr)===0;if(n){var r=ee;(r.e??=[]).push(e)}else return Bs(e)}function Bs(e){return ct(Ar|gs,e,!1)}function vo(e){return qs(),ct(Jn|gs,e,!0)}function po(e){vt.ensure();const t=ct(Gt|vn,e,!0);return(n={})=>new Promise(r=>{n.outro?ht(t,()=>{He(t),r(void 0)}):(He(t),r(void 0))})}function Br(e){return ct(Ar,e,!1)}function ho(e){return ct(Hr|vn,e,!0)}function Cn(e,t=0){return ct(Jn|t,e,!0)}function W(e,t=[],n=[]){eo(t,n,r=>{ct(Jn,()=>e(...r.map(v)),!0)})}function Pn(e,t=0){var n=ct(dn|t,e,!0);return n}function xe(e,t=!0){return ct(yt|vn,e,!0,t)}function Ws(e){var t=e.teardown;if(t!==null){const n=gn,r=F;rs(!0),ge(null);try{t.call(null)}finally{rs(n),ge(r)}}}function Gs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const a=n.ac;a!==null&&Qn(()=>{a.abort(Mr)});var r=n.next;(n.f&Gt)!==0?n.parent=null:He(n,t),n=r}}function go(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&yt)===0&&He(t),t=n}}function He(e,t=!0){var n=!1;(t||(e.f&wa)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(mo(e.nodes_start,e.nodes_end),n=!0),Gs(e,t&&!n),Wn(e,0),Re(e,_n);var r=e.transitions;if(r!==null)for(const o of r)o.stop();Ws(e);var a=e.parent;a!==null&&a.first!==null&&Vs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function mo(e,t){for(;e!==null;){var n=e===t?null:Ln(e);e.remove(),e=n}}function Vs(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function ht(e,t){var n=[];Wr(e,n,!0),zs(n,()=>{He(e),t&&t()})}function zs(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var a of e)a.out(r)}else t()}function Wr(e,t,n){if((e.f&rt)===0){if(e.f^=rt,e.transitions!==null)for(const i of e.transitions)(i.is_global||n)&&t.push(i);for(var r=e.first;r!==null;){var a=r.next,o=(r.f&$n)!==0||(r.f&yt)!==0;Wr(r,t,o?n:!1),r=a}}}function an(e){Js(e,!0)}function Js(e,t){if((e.f&rt)!==0){e.f^=rt,(e.f&he)===0&&(Re(e,Ve),cn(e));for(var n=e.first;n!==null;){var r=n.next,a=(n.f&$n)!==0||(n.f&yt)!==0;Js(n,a?t:!1),n=r}if(e.transitions!==null)for(const o of e.transitions)(o.is_global||t)&&o.in()}}const bo=["touchstart","touchmove"];function wo(e){return bo.includes(e)}const Xs=new Set,Cr=new Set;function yo(e,t,n,r={}){function a(o){if(r.capture||wn.call(t,o),!o.cancelBubble)return Qn(()=>n?.call(this,o))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Vt(()=>{t.addEventListener(e,a,r)}):t.addEventListener(e,a,r),a}function ko(e,t,n,r,a){var o={capture:r,passive:a},i=yo(e,t,n,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&tr(()=>{t.removeEventListener(e,i,o)})}function st(e){for(var t=0;t<e.length;t++)Xs.add(e[t]);for(var n of Cr)n(e)}let as=null;function wn(e){var t=this,n=t.ownerDocument,r=e.type,a=e.composedPath?.()||[],o=a[0]||e.target;as=e;var i=0,u=as===e&&e.__root;if(u){var l=a.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=a.indexOf(t);if(c===-1)return;l<=c&&(i=l)}if(o=a[i]||e.target,o!==t){Dn(e,"currentTarget",{configurable:!0,get(){return o||n}});var f=F,d=q;ge(null),ze(null);try{for(var p,_=[];o!==null;){var h=o.assignedSlot||o.parentNode||o.host||null;try{var g=o["__"+r];if(g!=null&&(!o.disabled||e.target===o))if(zn(g)){var[m,...k]=g;m.apply(o,[e,...k])}else g.call(o,e)}catch(b){p?_.push(b):p=b}if(e.cancelBubble||h===t||h===null)break;o=h}if(p){for(let b of _)queueMicrotask(()=>{throw b});throw p}}finally{e.__root=t,delete e.currentTarget,ge(f),ze(d)}}}function xo(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Gn(e,t){var n=q;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function L(e,t){var n=(t&Ua)!==0,r=(t&Na)!==0,a,o=!e.startsWith("<!>");return()=>{a===void 0&&(a=xo(o?e:"<!>"+e),n||(a=Bn(a)));var i=r||xs?document.importNode(a,!0):a.cloneNode(!0);if(n){var u=Bn(i),l=i.lastChild;Gn(u,l)}else Gn(i,i);return i}}function os(e=""){{var t=hn(e+"");return Gn(t,t),t}}function lt(){var e=document.createDocumentFragment(),t=document.createComment(""),n=hn();return e.append(t,n),Gn(t,n),e}function x(e,t){e!==null&&e.before(t)}function pe(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function is(e,t){return So(e,t)}const Yt=new Map;function So(e,{target:t,anchor:n,props:r={},events:a,context:o,intro:i=!0}){Ga();var u=new Set,l=d=>{for(var p=0;p<d.length;p++){var _=d[p];if(!u.has(_)){u.add(_);var h=wo(_);t.addEventListener(_,wn,{passive:h});var g=Yt.get(_);g===void 0?(document.addEventListener(_,wn,{passive:h}),Yt.set(_,1)):Yt.set(_,g+1)}}};l(Tr(Xs)),Cr.add(l);var c=void 0,f=po(()=>{var d=n??t.appendChild(hn());return Za(d,{pending:()=>{}},p=>{if(o){me({});var _=ee;_.c=o}a&&(r.$$events=a),c=e(p,r)||{},o&&be()}),()=>{for(var p of u){t.removeEventListener(p,wn);var _=Yt.get(p);--_===0?(document.removeEventListener(p,wn),Yt.delete(p)):Yt.set(p,_)}Cr.delete(l),d!==n&&d.parentNode?.removeChild(d)}});return $o.set(c,f),c}let $o=new WeakMap;const dr=0,On=1,_r=2;function ls(e,t,n,r,a){var o=e,i=pn(),u=ee,l=ue,c,f,d,p=i?bt(void 0):We(void 0,!1,!1),_=i?bt(void 0):We(void 0,!1,!1),h=!1;function g(k,b){h=!0,b&&(ze(m),ge(m),Tt(u));try{k===dr&&n&&(c?an(c):c=xe(()=>n(o))),k===On&&r&&(f?an(f):f=xe(()=>r(o,p))),k===_r&&a&&(d?an(d):d=xe(()=>a(o,_))),k!==dr&&c&&ht(c,()=>c=null),k!==On&&f&&ht(f,()=>f=null),k!==_r&&d&&ht(d,()=>d=null)}finally{b&&(Tt(null),ge(null),ze(null),Ps())}}var m=Pn(()=>{if(l!==(l=t())){if(ha(l)){var k=l;h=!1,k.then(b=>{k===l&&(ut(p,b),g(On,!0))},b=>{if(k===l&&(ut(_,b),g(_r,!0),!a))throw _.v}),Vt(()=>{h||g(dr,!0)})}else ut(p,l),g(On,!1);return()=>l=ue}})}function J(e,t,n=!1){var r=e,a=null,o=null,i=ue,u=n?$n:0,l=!1;const c=(_,h=!0)=>{l=!0,p(h,_)};var f=null;function d(){f!==null&&(f.lastChild.remove(),r.before(f),f=null);var _=i?a:o,h=i?o:a;_&&an(_),h&&ht(h,()=>{i?o=null:a=null})}const p=(_,h)=>{if(i!==(i=_)){var g=Es(),m=r;if(g&&(f=document.createDocumentFragment(),f.append(m=hn())),i?a??=h&&xe(()=>h(m)):o??=h&&xe(()=>h(m)),g){var k=Z,b=i?a:o,U=i?o:a;b&&k.skipped_effects.delete(b),U&&k.skipped_effects.add(U),k.add_callback(d)}else d()}};Pn(()=>{l=!1,t(c),l||p(null,null)},u)}function Dt(e,t){return t}function Eo(e,t,n){for(var r=e.items,a=[],o=t.length,i=0;i<o;i++)Wr(t[i].e,a,!0);var u=o>0&&a.length===0&&n!==null;if(u){var l=n.parentNode;Va(l),l.append(n),r.clear(),it(e,t[0].prev,t[o-1].next)}zs(a,()=>{for(var c=0;c<o;c++){var f=t[c];u||(r.delete(f.k),it(e,f.prev,f.next)),He(f.e,!u)}})}function Pt(e,t,n,r,a,o=null){var i=e,u={flags:t,items:new Map,first:null},l=(t&ys)!==0;if(l){var c=e;i=c.appendChild(hn())}var f=null,d=!1,p=new Map,_=jr(()=>{var k=n();return zn(k)?k:k==null?[]:Tr(k)}),h,g;function m(){Lo(g,h,u,p,i,a,t,r,n),o!==null&&(h.length===0?f?an(f):f=xe(()=>o(i)):f!==null&&ht(f,()=>{f=null}))}Pn(()=>{g??=q,h=v(_);var k=h.length;if(!(d&&k===0)){d=k===0;var b,U,H,D;if(Es()){var S=new Set,E=Z;for(U=0;U<k;U+=1){H=h[U],D=r(H,U);var M=u.items.get(D)??p.get(D);M?(t&(Xn|Yn))!==0&&Ys(M,H,U,t):(b=Zs(null,u,null,null,H,D,U,a,t,n,!0),p.set(D,b)),S.add(D)}for(const[j,ce]of u.items)S.has(j)||E.skipped_effects.add(ce.e);E.add_callback(m)}else m();v(_)}})}function Lo(e,t,n,r,a,o,i,u,l){var c=(i&Oa)!==0,f=(i&(Xn|Yn))!==0,d=t.length,p=n.items,_=n.first,h=_,g,m=null,k,b=[],U=[],H,D,S,E;if(c)for(E=0;E<d;E+=1)H=t[E],D=u(H,E),S=p.get(D),S!==void 0&&(S.a?.measure(),(k??=new Set).add(S));for(E=0;E<d;E+=1){if(H=t[E],D=u(H,E),S=p.get(D),S===void 0){var M=r.get(D);if(M!==void 0){r.delete(D),p.set(D,M);var j=m?m.next:h;it(n,m,M),it(n,M,j),vr(M,j,a),m=M}else{var ce=h?h.e.nodes_start:a;m=Zs(ce,n,m,m===null?n.first:m.next,H,D,E,o,i,l)}p.set(D,m),b=[],U=[],h=m.next;continue}if(f&&Ys(S,H,E,i),(S.e.f&rt)!==0&&(an(S.e),c&&(S.a?.unfix(),(k??=new Set).delete(S))),S!==h){if(g!==void 0&&g.has(S)){if(b.length<U.length){var re=U[0],ne;m=re.prev;var Se=b[0],K=b[b.length-1];for(ne=0;ne<b.length;ne+=1)vr(b[ne],re,a);for(ne=0;ne<U.length;ne+=1)g.delete(U[ne]);it(n,Se.prev,K.next),it(n,m,Se),it(n,K,re),h=re,m=K,E-=1,b=[],U=[]}else g.delete(S),vr(S,h,a),it(n,S.prev,S.next),it(n,S,m===null?n.first:m.next),it(n,m,S),m=S;continue}for(b=[],U=[];h!==null&&h.k!==D;)(h.e.f&rt)===0&&(g??=new Set).add(h),U.push(h),h=h.next;if(h===null)continue;S=h}b.push(S),m=S,h=S.next}if(h!==null||g!==void 0){for(var $e=g===void 0?[]:Tr(g);h!==null;)(h.e.f&rt)===0&&$e.push(h),h=h.next;var fe=$e.length;if(fe>0){var De=(i&ys)!==0&&d===0?a:null;if(c){for(E=0;E<fe;E+=1)$e[E].a?.measure();for(E=0;E<fe;E+=1)$e[E].a?.fix()}Eo(n,$e,De)}}c&&Vt(()=>{if(k!==void 0)for(S of k)S.a?.apply()}),e.first=n.first&&n.first.e,e.last=m&&m.e;for(var at of r.values())He(at.e);r.clear()}function Ys(e,t,n,r){(r&Xn)!==0&&ut(e.v,t),(r&Yn)!==0?ut(e.i,n):e.i=n}function Zs(e,t,n,r,a,o,i,u,l,c,f){var d=(l&Xn)!==0,p=(l&Aa)===0,_=d?p?We(a,!1,!1):bt(a):a,h=(l&Yn)===0?i:bt(i),g={i:h,v:_,k:o,a:null,e:null,prev:n,next:r};try{if(e===null){var m=document.createDocumentFragment();m.append(e=hn())}return g.e=xe(()=>u(e,_,h,c),Ba),g.e.prev=n&&n.e,g.e.next=r&&r.e,n===null?f||(t.first=g):(n.next=g,n.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function vr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,a=t?t.e.nodes_start:n,o=e.e.nodes_start;o!==null&&o!==r;){var i=Ln(o);a.before(o),o=i}}function it(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Vn(e,t,...n){var r=e,a=nt,o;Pn(()=>{a!==(a=t())&&(o&&(He(o),o=null),o=xe(()=>a(r,...n)))},$n)}function Co(e,t,n){Br(()=>{var r=R(()=>t(e,n?.())||{});if(n&&r?.update){var a=!1,o={};Cn(()=>{var i=n();Fs(i),a&&Dr(o,i)&&(o=i,r.update(i))}),a=!0}if(r?.destroy)return()=>r.destroy()})}function Ks(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Ks(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Po(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Ks(e))&&(r&&(r+=" "),r+=t);return r}function Hn(e){return typeof e=="object"?Po(e):e??""}const us=[...` 	
\r\fÂ \v\uFEFF`];function Ro(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var o=a.length,i=0;(i=r.indexOf(a,i))>=0;){var u=i+o;(i===0||us.includes(r[i-1]))&&(u===r.length||us.includes(r[u]))?r=(i===0?"":r.substring(0,i))+r.substring(u+1):i=u}}return r===""?null:r}function Ie(e,t,n,r,a,o){var i=e.__className;if(i!==n||i===void 0){var u=Ro(n,r,o);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(o&&a!==o)for(var l in o){var c=!!o[l];(a==null||c!==!!a[l])&&e.classList.toggle(l,c)}return o}function Gr(e,t,n=!1){if(e.multiple){if(t==null)return;if(!zn(t))return Fa();for(var r of e.options)r.selected=t.includes(xn(r));return}for(r of e.options){var a=xn(r);if(Wa(a,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Qs(e){var t=new MutationObserver(()=>{Gr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),tr(()=>{t.disconnect()})}function Vr(e,t,n=t){var r=!0;qr(e,"change",a=>{var o=a?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(o),xn);else{var u=e.querySelector(o)??e.querySelector("option:not([disabled])");i=u&&xn(u)}n(i)}),Br(()=>{var a=t();if(Gr(e,a,r),r&&a===void 0){var o=e.querySelector(":checked");o!==null&&(a=xn(o),n(a))}e.__value=a,r=!1}),Qs(e)}function xn(e){return"__value"in e?e.__value:e.value}const Io=Symbol("is custom element"),To=Symbol("is html");function gt(e,t,n,r){var a=Oo(e);a[t]!==(a[t]=n)&&(t==="loading"&&(e[ya]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Ao(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Oo(e){return e.__attributes??={[Io]:e.nodeName.includes("-"),[To]:e.namespaceURI===Ha}}var cs=new Map;function Ao(e){var t=e.getAttribute("is")||e.nodeName,n=cs.get(t);if(n)return n;cs.set(t,n=[]);for(var r,a=e,o=Element.prototype;o!==a;){r=hs(a);for(var i in r)r[i].set&&n.push(i);a=Or(a)}return n}function jt(e,t,n=t){var r=new WeakSet;qr(e,"input",async a=>{var o=a?e.defaultValue:e.value;if(o=pr(e)?hr(o):o,n(o),Z!==null&&r.add(Z),await uo(),o!==(o=t())){var i=e.selectionStart,u=e.selectionEnd;e.value=o??"",u!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(u,e.value.length))}}),R(t)==null&&e.value&&(n(pr(e)?hr(e.value):e.value),Z!==null&&r.add(Z)),Cn(()=>{var a=t();if(e===document.activeElement){var o=Nn??Z;if(r.has(o))return}pr(e)&&a===hr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function on(e,t,n=t){qr(e,"change",r=>{var a=r?e.defaultChecked:e.checked;n(a)}),R(t)==null&&n(e.checked),Cn(()=>{var r=t();e.checked=!!r})}function pr(e){var t=e.type;return t==="number"||t==="range"}function hr(e){return e===""?null:+e}function ea(e,t,n){var r=nn(e,t);r&&r.set&&(e[t]=n,tr(()=>{e[t]=null}))}function fs(e,t){return e===t||e?.[Rt]===t}function wt(e={},t,n,r){return Br(()=>{var a,o;return Cn(()=>{a=o,o=[],R(()=>{e!==n(...o)&&(t(e,...o),a&&fs(n(...a),e)&&t(null,...a))})}),()=>{Vt(()=>{o&&fs(n(...o),e)&&t(null,...o)})}}),e}function At(e=!1){const t=ee,n=t.l.u;if(!n)return;let r=()=>Fs(t.s);if(e){let a=0,o={};const i=Kn(()=>{let u=!1;const l=t.s;for(const c in l)l[c]!==o[c]&&(o[c]=l[c],u=!0);return u&&a++,a});r=()=>v(i)}n.b.length&&vo(()=>{ds(t,r),jn(n.b)}),fn(()=>{const a=R(()=>n.m.map(ga));return()=>{for(const o of a)typeof o=="function"&&o()}}),n.a.length&&fn(()=>{ds(t,r),jn(n.a)})}function ds(e,t){if(e.l.s)for(const n of e.l.s)v(n);t()}let Pr=Symbol();function ve(e,t,n){const r=n[t]??={store:null,source:We(void 0),unsubscribe:nt};if(r.store!==e&&!(Pr in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=nt;else{var a=!0;r.unsubscribe=ta(e,o=>{a?r.source.v=o:P(r.source,o)}),a=!1}return e&&Pr in n?Ce(e):v(r.source)}function An(e,t){return e.set(t),t}function Je(){const e={};function t(){tr(()=>{for(var n in e)e[n].unsubscribe();Dn(e,Pr,{enumerable:!1,value:!0})})}return[e,t]}function ie(e,t,n){return e.set(n),t}function ln(e,t,n,r){var a=r,o=!0,i=()=>(o&&(o=!1,a=r),a),u;u=e[t],u===void 0&&r!==void 0&&(u=i());var l;return l=()=>{var c=e[t];return c===void 0?i():(o=!0,c)},l}function zr(e){ee===null&&ws(),En&&ee.l!==null?No(ee).m.push(e):fn(()=>{const t=R(e);if(typeof t=="function")return t})}function Uo(e){ee===null&&ws(),zr(()=>()=>R(e))}function No(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function ta(e,t,n){if(e==null)return t(void 0),nt;const r=R(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Zt=[];function Bt(e,t=nt){let n=null;const r=new Set;function a(u){if(Dr(e,u)&&(e=u,n)){const l=!Zt.length;for(const c of r)c[1](),Zt.push(c,e);if(l){for(let c=0;c<Zt.length;c+=2)Zt[c][0](Zt[c+1]);Zt.length=0}}}function o(u){a(u(e))}function i(u,l=nt){const c=[u,l];return r.add(c),r.size===1&&(n=t(a,o)||nt),u(e),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:a,update:o,subscribe:i}}function Ce(e){let t;return ta(e,n=>t=n)(),t}var Rr=(e=>(e.info="info",e.warn="warn",e.error="error",e))(Rr||{});class Ho{logs=Bt([]);_addLog(t,n){this.logs.update(r=>(r.unshift({date:new Date,severity:t,content:n}),r))}info(t){this._addLog("info",t)}warn(t){this._addLog("warn",t)}error(t){this._addLog("error",t)}updateLogAtIndex(t,n){this.logs.update(r=>(r[t]&&(r[t].content=n),r))}}const A=new Ho;function Mo(e,t){let n=!1;return e.subscribe(r=>{n?t(r):n=!0})}const Do={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,discard_expired_sessions:!0,rs_launch_command:null,osrs_launch_command:null,runelite_custom_jar:null,runelite_launch_command:null,hdos_launch_command:null,selected:{game:Le.osrs,client:tn.runelite,user_id:null},userDetails:{}};function jo(){const t=new URLSearchParams(window.location.search).get("config");function n(a){return typeof a=="object"&&typeof a.use_dark_theme=="boolean"&&typeof a.rs_plugin_loader=="boolean"&&typeof a.close_after_launch=="boolean"&&typeof a.check_announcements=="boolean"&&typeof a.flatpak_rich_presence=="boolean"&&typeof a.runelite_use_custom_jar=="boolean"&&typeof a.selected=="object"&&Object.values(Le).includes(a.selected.game)&&Object.values(tn).includes(a.selected.client)&&(typeof a.selected.user_id=="string"||a.selected.user_id===null)&&typeof a.userDetails=="object"}const{config:r}=O;if(t)try{const a=JSON.parse(t);typeof a.check_announcements>"u"&&(a.check_announcements=!0,O.configHasPendingChanges=!0),typeof a.close_after_launch>"u"&&(a.close_after_launch=!1,O.configHasPendingChanges=!0),typeof a.discard_expired_sessions>"u"&&(a.discard_expired_sessions=!0,O.configHasPendingChanges=!0),n(a)?r.set(a):(A.error("The config saved on disk is not the correct format. It has been restored to default."),O.configHasPendingChanges=!0)}catch{A.error("Unable to parse config, restoring to default"),O.configHasPendingChanges=!0}else O.configHasPendingChanges=!0;Mo(O.config,()=>{O.configHasPendingChanges=!0})}const O={initialized:Bt(!1),configHasPendingChanges:!1,pluginConfigHasPendingChanges:!1,config:Bt(Do),sessions:Bt([])};let gr=!1,mr=!1;class te{static async login(t,n){const r=await Mn.buildSession(t,n);if(!r.ok)return ae(r.error);const a=r.value,i=Ce(O.sessions).findIndex(u=>u.user.userId===t.sub);return i!==-1?O.sessions.update(u=>(u[i]=a,u)):(O.sessions.update(u=>(u.push(a),u)),O.config.update(u=>(u.selected.user_id=a.user.userId,u))),et(a)}static async logout(t){const{sessions:n,config:r}=O;return n.update(a=>{const o=a.findIndex(i=>i.user.userId===t);return o>-1&&(Pe.revokeOauthCreds(a[o].tokens.access_token),a.splice(o,1)),a}),r.update(a=>(typeof a.userDetails[t]<"u"&&delete a.userDetails[t],a.selected.user_id===t&&(a.selected.user_id=null),a)),Ce(n)}static postJSON(t,n,r=null){const a=JSON.stringify(n);return fetch(t,{method:"POST",body:a,headers:{"Content-Type":"application/json"}}).then(i=>{i.ok||i.text().then(u=>A.error(`${t} error: ${i.status}: ${u}`)),r&&r(i)})}static saveConfig(t=!0){if(gr||t&&!O.configHasPendingChanges)return;gr=!0;const n=Ce(O.config);return n.rs_launch_command===""&&(n.rs_launch_command=null),n.osrs_launch_command===""&&(n.osrs_launch_command=null),n.runelite_launch_command===""&&(n.runelite_launch_command=null),n.hdos_launch_command===""&&(n.hdos_launch_command=null),this.postJSON("/save-config",n,()=>gr=!1),n}static savePluginConfig(t=!0){mr||t&&!O.pluginConfigHasPendingChanges||(mr=!0,this.postJSON("/save-plugin-config",$.pluginConfig,()=>mr=!1))}static async saveCredentials(){return this.postJSON("/save-credentials",Ce(O.sessions))}static async openFilePicker(){const t=await fetch("/jar-file-picker");return t.status===200?t.text():null}static findSession(t){return Ce(O.sessions).find(r=>r.user.userId===t)}static findAccount(t,n){return t.find(r=>r.accountId==n)}}const Ir=Bt([]),Fo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Fo);Ta();var qo=L("<main><!></main>");function na(e,t){const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme);var u=qo();let l;var c=C(u);Vn(c,()=>t.children??nt),W(f=>l=Ie(u,1,"fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50",null,l,f),[()=>({dark:v(i)})]),x(e,u),a()}var Bo=L('<div class="flex h-full items-center justify-center"><img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/></div>');function Wo(e,t){me(t,!1);const n=window.opener;$.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function r(u){const l=Qt.get("auth_verifier");if(!l)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:c,redirect:f}=$.env,d=await Pe.getOAuthToken($.env.origin,c,l,f,u);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function a(u){const l=Qt.get("auth_nonce"),c=Pe.validateIdToken(u,l??"");if(!c.ok)return o(c.error),null;const f=await Pe.getSessionId($.env.auth_api,u);return f.ok?f.value:(o(`Unable to retreive session id. ${f.error}`),null)}function o(u){i({type:"authFailed",reason:u}),fetch("/close")}function i(u){n.postMessage(u,window.location.origin)}zr(async()=>{const u=new URLSearchParams(window.location.search),l=u.get("code"),c=u.get("state"),f=u.get("id_token");if(f==null&&l&&c){const d=await r(l);if(!d)return o("tokens object is null.");i({type:"authTokenUpdate",tokens:d});const p=crypto.randomUUID();Pe.navigateToAuthConsent($.env.origin,d.id_token,p)}else if(f&&l&&c){const d=await a(f);if(!d)return o("sessionId is null");i({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),Uo(()=>{Qt.remove("auth_verifier"),Qt.remove("auth_nonce")}),At(),na(e,{children:(u,l)=>{var c=Bo();x(u,c)}}),be()}var Go=(e,t,n)=>{e.key==="Escape"&&(e.preventDefault(),t()&&n())},Vo=L('<button class="absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button>'),zo=L("<dialog><!> <!></dialog>");function nr(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme),u=ln(t,"class",3,""),l=ln(t,"canSelfClose",3,!0),c=ln(t,"onClose",3,()=>{}),f,d=oe(!1);function p(){f.showModal(),P(d,!0)}function _(){c()(),f.close(),P(d,!1)}var h={open:p,close:_},g=zo();g.__keydown=[Go,l,_],g.__mousedown=S=>{f===S.target&&_()};let m;var k=C(g);{var b=S=>{var E=Vo();E.__click=_,x(S,E)};J(k,S=>{l()&&S(b)})}var U=w(k,2);{var H=S=>{var E=lt(),M=B(E);Vn(M,()=>t.children??nt),x(S,E)};J(U,S=>{v(d)&&S(H)})}wt(g,S=>f=S,()=>f),W(S=>m=Ie(g,1,`${u()??""} backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none`,"svelte-1nslvnn",m,S),[()=>({dark:v(i)})]),x(e,g);var D=be(h);return a(),D}st(["keydown","mousedown","click"]);var Jo=(e,t)=>v(t).close(),Xo=L('<p class="p-2"></p> <p class="p-2"></p> <button class="m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75">I Understand</button>',1);function Yo(e,t){me(t,!1);const n=()=>ve(o,"$sessions",r),[r,a]=Je(),{sessions:o}=O;let i=We();zr(()=>{n().length==0&&v(i).open()}),At(),wt(nr(e,{canSelfClose:!1,class:"w-1/2 text-center",children:(u,l)=>{var c=Xo(),f=B(c);f.textContent=atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==");var d=w(f,2);d.textContent=atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu");var p=w(d,2);p.__click=[Jo,i],x(u,c)},$$slots:{default:!0},$$legacy:!0}),u=>P(i,u),()=>v(i)),be(),a()}st(["click"]);const Ne={method:"GET"},Zo={"Content-Type":"application/octet-stream"};let br=null;const Ko=120*1e3,Qo="https://api.github.com/repos/runelite/launcher/releases",ei="https://cdn.hdos.dev/client/getdown.txt",rr=e=>e?{method:"POST",headers:Zo,body:e}:Ne,mt=(e,t,n,r)=>{fetch(e,t).then(a=>{a.ok?n(a):(a.text().then(o=>A.error(`request failed: ${a.url}: ${a.status}: ${o}`)),r())}).catch(()=>{A.error(`request failed: ${e}: connection error`),r()})},Jr=async(e,t,n,r,a)=>{const o=p=>{A.error(`error downloading: ${p}`),r()};A.info(t);const i=p=>A.updateLogAtIndex(0,`${t} ${p}`);if(!e.body)return o("no HTTP response body");const u=e.body.getReader();if(!u)return o("invalid HTTP response");const l=e.headers.get("content-length")??a;if(!l)return o("cannot estimate download size");const c=parseInt(l);if(!l)return o("cannot estimate download size");const f=new Uint8Array(c);let d=0;for(;;){const p=await u.read();if(p.done)break;const _=p.value;f.set(_,d),d+=_.length;const h=(Math.round(1e3*d/c)/10).toFixed(1);i(h)}i("done"),n(f)};function ti(e,t,n){te.saveConfig();const r=(u,l)=>{const c={},f=Ce(O.config);u&&(c.hash=u),e&&(c.jx_session_id=e),t&&(c.jx_character_id=t),n&&(c.jx_display_name=n),f.rs_launch_command&&f.rs_launch_command.length>0&&(c.launch_command=f.rs_launch_command),f.rs_plugin_loader&&(c.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?c.config_uri=f.rs_config_uri:c.config_uri=$.env.default_config_uri,fetch("/launch-rs3-deb?".concat(new URLSearchParams(c).toString()),rr(l)).then(d=>{d.text().then(p=>A.info(`game launch status: '${p.trim()}'`)),d.ok&&(u&&($.rs3debInstalledHash=u),f.close_after_launch&&!f.rs_plugin_loader&&fetch("/close"))})},a=()=>{$.rs3debInstalledHash&&r()},o=$.env.content_url,i=o.concat("dists/trusty/non-free/binary-amd64/Packages");mt(i,Ne,u=>u.text().then(l=>{const c=Object.fromEntries(l.split(`
`).map(f=>f.split(": ")));if(!c.Filename||!c.Size||!c.SHA256){A.error(`could not parse package data from URL: ${i}`),a();return}if(c.SHA256===$.rs3debInstalledHash){A.info("game client is up-to-date"),r();return}mt(o.concat(c.Filename),Ne,f=>Jr(f,"downloading RS3 client...",d=>r(c.SHA256,d),r,c.Size),a)}),a)}function ra(e,t,n,r){te.saveConfig();const a=r?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",o=Ce(O.config),i=(l,c,f)=>{const d={};l&&(d.id=l),f&&(d.jar_path=f),e&&(d.jx_session_id=e),t&&(d.jx_character_id=t),n&&(d.jx_display_name=n),o.runelite_launch_command&&o.runelite_launch_command!==""&&(d.launch_command=o.runelite_launch_command),o.flatpak_rich_presence&&(d.flatpak_rich_presence=""),fetch(a.concat(new URLSearchParams(d).toString()),rr(c)).then(p=>{p.text().then(_=>A.info(`game launch status: '${_.trim()}'`)),p.ok&&(l&&($.runeLiteInstalledId=l),o.close_after_launch&&!r&&fetch("/close"))})},u=()=>{$.runeLiteInstalledId&&i()};if(o.runelite_use_custom_jar){i(null,null,o.runelite_custom_jar);return}if($.runeLiteInstalledId!==null&&br!==null&&br+Ko>Date.now()){i();return}mt(Qo,Ne,l=>l.json().then(c=>{br=Date.now();const f=c.map(d=>d.assets).flat().find(d=>d.name.toLowerCase()=="runelite.jar");if(!f){A.info("note: no runelite releases found, so skipping update check"),u();return}if(f.id==$.runeLiteInstalledId){A.info("game is up-to-date"),i();return}mt(f.browser_download_url,Ne,d=>Jr(d,"downloading RuneLite launcher...",p=>i(f.id,p),u,f.size),u)}),u)}function ni(e,t,n){te.saveConfig();const r=Ce(O.config),a=(i,u)=>{const l={};i&&(l.version=i),e&&(l.jx_session_id=e),t&&(l.jx_character_id=t),n&&(l.jx_display_name=n),r.hdos_launch_command&&r.hdos_launch_command.length>0&&(l.launch_command=r.hdos_launch_command),fetch("/launch-hdos-jar?".concat(new URLSearchParams(l).toString()),rr(u)).then(c=>{c.text().then(f=>A.info(`game launch status: '${f.trim()}'`)),c.ok&&(i&&($.hdosInstalledVersion=i),r.close_after_launch&&fetch("/close"))})},o=()=>{$.hdosInstalledVersion&&a()};mt(ei,Ne,i=>i.text().then(u=>{const l=u.match(/^launcher\.version *= *(.*?)$/m);if(!l||l.length<2){A.error("couldn't parse latest launcher version"),o();return}const c=l[1];if(c===$.hdosInstalledVersion){A.info("game is up-to-date"),a();return}mt(`https://cdn.hdos.dev/launcher/v${c}/hdos-launcher.jar`,Ne,f=>Jr(f,"downloading HDOS launcher...",d=>a(c,d),o),o)}),o)}function wr(){fetch("/list-game-clients",Ne).then(e=>{e.ok||e.text().then(t=>A.error(`failed to get client list: ${e.status}: ${t}`))})}function _s(e,t,n,r,a){te.saveConfig();const o=`${t?"osrs":$.env.provider}-${e?"win":"mac"}`,i=t?"osrs":"rs3",u=e?"exe":"app",l=`${i}${u}InstalledHash`,c=(d,p)=>{const _={},h=Ce(O.config),g=t?h.osrs_launch_command:h.rs_launch_command;d&&(_.hash=d),n&&(_.jx_session_id=n),r&&(_.jx_character_id=r),a&&(_.jx_display_name=a),g&&g!==""&&(_.launch_command=g),t||(h.rs_plugin_loader&&(_.plugin_loader="1"),_.config_uri=h.use_custom_rs_config_uri&&h.rs_config_uri?h.rs_config_uri:$.env.default_config_uri);const m=k=>fetch(`/launch-${i}-${u}?${new URLSearchParams(_).toString()}`,k).then(b=>{b.text().then(U=>A.info(`game launch status: '${U.trim()}'`)),b.ok&&(d&&($[l]=d),h.close_after_launch&&(t||!h.rs_plugin_loader)&&fetch("/close"))});p?p.then(k=>m(rr(k))):m(Ne)},f=()=>{$.hdosInstalledVersion&&c()};mt(`${$.env.direct6_url}${o}/${o}.json`,Ne,d=>d.text().then(p=>{const _=JSON.parse(atob(p.split(".")[1])).environments.production;if($[l]===_.id){A.info("game client is up-to-date"),c();return}A.info(`downloading client version ${_.version}...`),mt(`${$.env.direct6_url}${o}/catalog/${_.id}/catalog.json`,Ne,h=>h.text().then(g=>{const m=JSON.parse(atob(g.split(".")[1])),k=b=>b.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:");mt(k(m.metafile),Ne,b=>b.text().then(U=>{const H=JSON.parse(atob(U.split(".")[1])),D=H.pieces.digests.map(M=>{const j=atob(M).split("").map(re=>re.charCodeAt(0).toString(16).padStart(2,"0")).join(""),ce=k(m.config.remote.baseUrl).concat(m.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",j.substring(0,2)).replace("{TargetDigest}",j));return fetch(ce,Ne).then(re=>re.blob().then(ne=>{const Se=new DecompressionStream("gzip");return new Response(ne.slice(6).stream().pipeThrough(Se)).blob()}))});let S=0,E=null;for(let M=0;M<H.files.length;M+=1)if(e?H.files[M].name.endsWith(".exe"):H.files[M].name.includes(".app/Contents/MacOS/"))if(E!==null){A.error(`can't parse ${b.url}: file list has multiple possibilities for main exe`),f();return}else E=H.files[M].size;else E===null&&(S+=H.files[M].size);if(E===null){A.error(`can't parse ${b.url}: file list has no possibilities for main exe`),f();return}Promise.all(D).then(M=>{const j=new Blob(M).slice(S,S+E);c(H.id,j.arrayBuffer())})}),f)}),f)}),f)}var ri=(e,t)=>{v(t).close()},si=(e,t,n,r,a)=>{v(t)(v(n),v(r)),v(a).close()},ai=L('<div><h2 class="text-3xl font-extrabold">Game is offline</h2> <br/> <p>This game appears to be offline for maintenance or an update. Launch anyway?</p> <div class="align-bottom"><button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">No</button> <button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75">Yes</button></div></div>');function oi(e,t){me(t,!1);let n=We(),r=We(),a=We(),o=We();function i(l,c,f){P(o,l),P(r,c),P(a,f),v(n).open()}var u={open:i};return wt(nr(e,{class:"h-fit w-3/5 px-5 py-3 text-center",children:(l,c)=>{var f=ai(),d=w(C(f),6),p=C(d);p.__click=[ri,n];var _=w(p,2);_.__click=[si,o,r,a,n],x(l,f)},$$slots:{default:!0},$$legacy:!0}),l=>P(n,l),()=>v(n)),ea(t,"open",i),be(u)}st(["click"]);const ii=()=>fetch("/open-external-url",{method:"POST",body:"https://bolt.adamcake.com/plugins"});var li=(e,t)=>P(t,!1),ui=L("<p>(start an RS3 game client with plugins enabled and it will be listed here.)</p>"),ci=(e,t,n,r,a,o,i)=>{P(t,v(n).uid,!0),P(r,!0),P(a,!1),P(o,""),P(i,null)},fi=L("<button> </button> <br/>",1),di=(e,t)=>P(t,null),_i=L('<option class="dark:bg-slate-900"> </option>'),vi=(e,t,n)=>{P(t,!v(t)),P(n,"")},pi=(e,t,n,r)=>{t(v(n)),P(r,!1),P(n,"")},hi=(e,t,n)=>{P(t,!1),P(n,"")},gi=L('<label for="plugin-updater-url-input">URL:</label> <textarea rows="1" id="plugin-updater-url-input" class="w-[50%] max-w-[60%] resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800"></textarea> <button title="Confirm" class="select-none rounded-sm bg-emerald-500 hover:opacity-75"><img src="svgs/check-solid.svg" class="h-5 w-5" alt="Confirm"/></button> <button title="Close URL entry" class="select-none rounded-sm bg-rose-500 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button> <br/><br/>',1),mi=L('<br/> <span class="pb-4 text-xl font-bold italic text-slate-600"> </span>',1),bi=L('<p class="pb-4 text-xl font-bold"> <!></p> <p> </p> <br/>',1),wi=L("<p>error</p> <br/>",1),yi=L("<p>loading...</p>"),ki=(e,t,n)=>{const r=t[Q(n)].path;fetch(r?"/browse-directory?".concat(new URLSearchParams({path:r}).toString()):"/browse-plugin-data?".concat(new URLSearchParams({id:Q(n)}).toString()))},xi=(e,t)=>fetch("/browse-plugin-config?".concat(new URLSearchParams({id:Q(t)}).toString())),Si=(e,t,n,r)=>t(v(n),Q(r)),$i=L('<button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Check updates</button> &nbsp;',1),Ei=L('<!> <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse data</button> &nbsp; <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse config</button> <br/> <!> <button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500">Remove</button>',1),Li=L(`<p>You have no plugins installed. You can install plugins either from an updater URL, or by
						downloading them onto your computer and selecting the "bolt.json" file.</p>`),Ci=L('<span class="align-middle"><button class="mx-1 aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from updater URL"><img src="svgs/download-solid.svg" alt="Install plugin from updater URL"/></button> <button class="aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from local directory"><img src="svgs/folder-solid.svg" alt="Install plugin from local directory"/></button></span> <br/> <!> <!>',1),Pi=(e,t,n,r,a,o,i)=>t(Q(n),Q(r),v(a)??null,v(o).main??i),Ri=L('<button class="mx-auto mb-1 w-auto select-none rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"> </button>'),Ii=L("<p>(no plugins installed)</p>"),Ti=L("<p>can't start plugin: does not appear to be configured</p>"),Oi=(e,t,n,r)=>{t(Q(n),v(r).uid)},Ai=L('<p> <button class="select-none rounded-sm bg-rose-500 shadow-lg hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/></button></p>'),Ui=L("<p> </p>"),Ni=L('<!> <br/> <br/> <hr class="p-1 dark:border-slate-700"/> <!>',1),Hi=L("<p>error</p>"),Mi=L("<p>loading...</p>"),Di=L("<br/> <!>",1),ji=L('<select class="mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select> <!>',1),Fi=L("<p>error</p>"),qi=L('<p class="text-red-500"> </p>'),Bi=L("<p> </p>"),Wi=L("<br/><br/> <!>",1),Gi=L('<div class="left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"><button>Manage Plugins</button> <hr class="p-1 dark:border-slate-700"/> <!></div> <div class="h-full pt-10"><!> <!></div> <div class="absolute bottom-2 right-4"><button class="m-0 cursor-pointer select-none border-none bg-transparent p-0 text-sm text-gray-500 underline">about plugins</button></div>',1);function Vi(e,t){me(t,!0);const n=()=>ve(Ir,"$clientList",r),[r,a]=Je();let o,i=oe(null),u=oe(!1),l=en($.pluginConfig);const c=$.platform==="windows"?"\\":"/",f="bolt.json",d=c.concat(f),p="main.lua";function _(){P(De,!1),o.open()}const h=()=>{$.pluginConfig=l,te.savePluginConfig(!0)},g=y=>{console.log(y),P(i,y,!0),P(u,!1)},m=y=>{console.error(y),P(i,y,!0),P(u,!0)},k=y=>new Promise((I,T)=>{const z=y.concat(y.endsWith(c)?f:d);var N=new XMLHttpRequest;N.onreadystatechange=()=>{N.readyState==4&&(N.status==200?I(JSON.parse(N.responseText)):T(N.responseText))},N.open("GET","/read-json-file?".concat(new URLSearchParams({path:z}).toString()),!0),N.send()}),b=y=>fetch("/get-plugindir-json?".concat(new URLSearchParams({id:y}).toString())).then(I=>I.ok?I.json():null),U=y=>{const I=l[y];if(!I)return null;const T=I.path;return T?k(T):b(y)},H=()=>{const y=Object.keys(l);let I;do I=crypto.randomUUID();while(y.includes(I));return I},D="(unnamed)",S="(new character)",E=(y,I)=>{k(y).then(T=>{P(K,H(),!0),l[Q(K)]={name:T.name??D,path:y,version:T.version},O.pluginConfigHasPendingChanges=!0}).catch(T=>m(`config file '${I}' couldn't be fetched, reason: ${T}`))},M=y=>{g("downloading..."),fetch(y).then(async I=>{if(!I.ok){m(`can't install plugin: updater URL returned ${I.status}: ${I.statusText}`);return}const T=await I.json();if(T.url){const z=await fetch(T.url);if(!z.ok){m(`can't install plugin: remote download URL returned ${I.status}: ${I.statusText}`);return}const N=await z.arrayBuffer();if(T.sha256){const Ye=await crypto.subtle.digest("SHA-256",N),zt=Array.from(new Uint8Array(Ye)).map(mn=>mn.toString(16).padStart(2,"0")).join("");if(T.sha256!==zt){m("can't install plugin: incorrect file hash");return}}const Y=H();if(!(await fetch("/install-plugin?".concat(new URLSearchParams({id:Y}).toString()),{method:"POST",body:N})).ok){m(`can't install plugin: ${I.statusText}`);return}const ft=await b(Y);ft?(P(K,Y,!0),l[Q(K)]={name:ft.name??D,version:ft.version,updaterURL:y,sha256:T.sha256},O.pluginConfigHasPendingChanges=!0,g(`plugin '${ft.name}' installed`)):m(`can't install plugin: ${f} not found`)}}).catch(()=>{m("can't install plugin: unhandled exception")})};let j=oe(!1);const ce=()=>{P(j,!0);var y=new XMLHttpRequest;y.onreadystatechange=()=>{if(y.readyState==4&&(P(j,!1),y.status==200))if(y.responseText.endsWith(d)){const I=y.responseText.substring(0,y.responseText.length-f.length);E(I,y.responseText)}else m(`selection '${y.responseText}' is not named ${f}; ignored`)},y.open("GET","/json-file-picker",!0),y.send()};wr();const re=(y,I,T,z)=>{let N=null;if(T){const Xe=$.platform==="windows"?T.replaceAll("\\","/"):T;N=Xe.endsWith(c)?Xe:Xe.concat("/")}var Y=new XMLHttpRequest;Y.onreadystatechange=()=>{Y.readyState==4&&(wr(),A.info(`Start-plugin status: ${Y.statusText.trim()}`))},N?Y.open("GET","/start-plugin?".concat(new URLSearchParams({client:y.toString(),id:I,main:z,path:N}).toString()),!0):Y.open("GET","/start-plugin?".concat(new URLSearchParams({client:y.toString(),id:I,main:z}).toString()),!0),Y.send()},ne=(y,I)=>{var T=new XMLHttpRequest;T.onreadystatechange=()=>{T.readyState==4&&(wr(),A.info(`Stop-plugin status: ${T.statusText.trim()}`))},T.open("GET","/stop-plugin?".concat(new URLSearchParams({client:y.toString(),uid:I.toString()}).toString()),!0),T.send()},Se=(y,I)=>{const T=y.updaterURL;fetch(T).then(async z=>{if(!z.ok){m(`can't update plugin: updater URL returned ${z.status}: ${z.statusText}`);return}let N=await z.json();if(!N.url){g(`can't update plugin '${y.name}': no remote download URL is configured`);return}let Y=!1;if(N.sha256?y.sha256!==N.sha256&&(Y=!0):N.version&&y.version!==N.version&&(Y=!0),Y){const Xe=await fetch(N.url);if(!Xe.ok){m(`can't update plugin: remote download URL returned ${Xe.status}: ${Xe.statusText}`);return}const ft=await Xe.arrayBuffer();if(N.sha256){const zt=await crypto.subtle.digest("SHA-256",ft),mn=Array.from(new Uint8Array(zt)).map(sr=>sr.toString(16).padStart(2,"0")).join("");if(N.sha256!==mn){m(`can't update plugin '${y.name}': incorrect file hash`);return}}fetch("/install-plugin?".concat(new URLSearchParams({id:I}).toString()),{method:"POST",body:ft});const Ye=await b(I);Ye?(N.sha256&&(y.sha256=N.sha256),Ye.name&&(y.name=Ye.name),Ye.version&&(y.version=Ye.version),O.pluginConfigHasPendingChanges=!0,g(`plugin '${Ye.name}' updated`)):m(`can't update plugin '${y.name}': ${f} not found`)}else g(`plugin '${y.name}' is already up-to-date`)})};var K=oe(""),$e=oe(!1),fe=oe(0);let De=oe(!1),at=oe("");fn(()=>{n().some(y=>y.uid===Q(fe))||P($e,!1)});let Te=Be(()=>l[Q(K)]),kt=Be(()=>U(Q(K)));fn(()=>{v(kt)&&v(kt).then(y=>{let I=!1;y.name!==v(Te).name&&(v(Te).name=y.name,I=!0),y.version!==v(Te).version&&(v(Te).version=y.version,I=!0),I&&(P(Te,v(Te)),O.pluginConfigHasPendingChanges=!0)})});let V=Be(()=>v(Te)?v(Te).path:null);var X={open:_};wt(nr(e,{class:"h-[90%] w-[90%] text-center",onClose:()=>h(),children:(y,I)=>{var T=Gi(),z=B(T),N=C(z);N.__click=[li,$e];var Y=w(N,4);{var Xe=de=>{var je=ui();x(de,je)},ft=de=>{var je=lt(),xt=B(je);Pt(xt,1,n,Dt,(bn,Ut)=>{var Ze=fi(),se=B(Ze);se.__click=[ci,fe,Ut,$e,De,at,i];var Oe=C(se);W(()=>{Ie(se,1,`m-1 h-[28px] w-[95%] select-none rounded-lg border-2 ${Q($e)&&Q(fe)===v(Ut).uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white"} hover:opacity-75`),pe(Oe,v(Ut).identity||S)}),x(bn,Ze)}),x(de,je)};J(Y,de=>{n().length==0?de(Xe):de(ft,!1)})}var Ye=w(z,2),zt=C(Ye);{var mn=de=>{var je=ji(),xt=B(je);xt.__change=[di,i],Pt(xt,21,()=>Object.entries(l),Dt,(se,Oe)=>{var Nt=Be(()=>ba(v(Oe),2));let Fe=()=>v(Nt)[0],Ae=()=>v(Nt)[1];var ot=_i(),Jt=C(ot),Xt={};W(()=>{pe(Jt,Ae().name??D),Xt!==(Xt=Fe())&&(ot.value=(ot.__value=Fe())??"")}),x(se,ot)});var bn=w(xt,2);{var Ut=se=>{var Oe=Ci(),Nt=B(Oe),Fe=C(Nt);Fe.__click=[vi,De,at];var Ae=w(Fe,2);Ae.__click=ce;var ot=w(Nt,4);{var Jt=le=>{var _e=gi(),Ke=w(B(_e),2),St=w(Ke,2);St.__click=[pi,M,at,De];var dt=w(St,2);dt.__click=[hi,De,at],jt(Ke,()=>v(at),we=>P(at,we)),x(le,_e)};J(ot,le=>{v(De)&&le(Jt)})}var Xt=w(ot,2);{var ar=le=>{var _e=lt(),Ke=B(_e);{var St=dt=>{var we=Ei(),_t=B(we);ls(_t,()=>v(kt),ye=>{var Ee=yi();x(ye,Ee)},(ye,Ee)=>{var Qe=bi(),Et=B(Qe),Ht=C(Et),lr=w(Ht);{var la=ur=>{var Yr=mi(),ca=w(B(Yr),2),fa=C(ca);W(()=>pe(fa,`v${v(Ee).version??""}`)),x(ur,Yr)};J(lr,ur=>{v(Ee).version&&ur(la)})}var Xr=w(Et,2),ua=C(Xr);W(()=>{pe(Ht,`${v(Ee).name??D??""} `),Ie(Xr,1,Hn(v(Ee).description?null:"italic")),pe(ua,v(Ee).description??"no description")}),x(ye,Qe)},ye=>{var Ee=wi();x(ye,Ee)});var Rn=w(_t,2);Rn.__click=[ki,l,K];var In=w(Rn,2);In.__click=[xi,K];var $t=w(In,4);{var Tn=ye=>{var Ee=$i(),Qe=B(Ee);Qe.__click=[Si,Se,Te,K],x(ye,Ee)};J($t,ye=>{v(Te).updaterURL&&ye(Tn)})}var ir=w($t,2);ir.__click=()=>{P(kt,null),O.pluginConfigHasPendingChanges=!0;const ye=l[Q(K)];ye&&(fetch("/uninstall-plugin?".concat(new URLSearchParams({id:Q(K),delete_data_dir:typeof ye.path=="string"?"0":"1"}).toString())),g(`plugin '${ye.name}' uninstalled`),delete l[Q(K)])},x(dt,we)};J(Ke,dt=>{Object.keys(l).includes(Q(K))&&v(kt)!==null&&dt(St)})}x(le,_e)},or=le=>{var _e=Li();x(le,_e)};J(Xt,le=>{Object.entries(l).length!==0?le(ar):le(or,!1)})}W(()=>{Fe.disabled=!$.hasLibArchive||v(j),Ae.disabled=v(j)}),x(se,Oe)},Ze=se=>{var Oe=Di(),Nt=w(B(Oe),2);ls(Nt,()=>v(kt),Fe=>{var Ae=Mi();x(Fe,Ae)},(Fe,Ae)=>{var ot=Ni(),Jt=B(ot);{var Xt=le=>{var _e=Ri();_e.__click=[Pi,re,fe,K,V,Ae,p];var Ke=C(_e);W(()=>pe(Ke,`Start ${v(Ae).name??""}`)),x(le,_e)},ar=le=>{var _e=lt(),Ke=B(_e);{var St=we=>{var _t=Ii();x(we,_t)},dt=we=>{var _t=Ti();x(we,_t)};J(Ke,we=>{Object.entries(l).length===0?we(St):we(dt,!1)},!0)}x(le,_e)};J(Jt,le=>{v(Ae)&&v(Ae).main&&Object.keys(l).includes(Q(K))?le(Xt):le(ar,!1)})}var or=w(Jt,8);Pt(or,1,n,Dt,(le,_e)=>{var Ke=lt(),St=B(Ke);{var dt=we=>{var _t=lt(),Rn=B(_t);Pt(Rn,17,()=>v(_e).plugins,Dt,(In,$t)=>{var Tn=lt(),ir=B(Tn);{var ye=Qe=>{var Et=Ai(),Ht=C(Et),lr=w(Ht);lr.__click=[Oi,ne,fe,$t],W(()=>pe(Ht,`${l[v($t).id].name??v($t).id??""} `)),x(Qe,Et)},Ee=Qe=>{var Et=Ui(),Ht=C(Et);W(()=>pe(Ht,v($t).id)),x(Qe,Et)};J(ir,Qe=>{Object.keys(l).includes(v($t).id)?Qe(ye):Qe(Ee,!1)})}x(In,Tn)}),x(we,_t)};J(St,we=>{v(_e).uid===Q(fe)&&we(dt)})}x(le,Ke)}),x(Fe,ot)},Fe=>{var Ae=Hi();x(Fe,Ae)}),x(se,Oe)};J(bn,se=>{Q($e)?se(Ze,!1):se(Ut)})}Vr(xt,()=>Q(K),se=>P(K,se)),x(de,je)},sr=de=>{var je=Fi();x(de,je)};J(zt,de=>{$.hasBoltPlugins?de(mn):de(sr,!1)})}var sa=w(zt,2);{var aa=de=>{var je=Wi(),xt=w(B(je),3);{var bn=Ze=>{var se=qi(),Oe=C(se);W(()=>pe(Oe,`[error] ${v(i)??""}`)),x(Ze,se)},Ut=Ze=>{var se=Bi(),Oe=C(se);W(()=>pe(Oe,`[info] ${v(i)??""}`)),x(Ze,se)};J(xt,Ze=>{v(u)?Ze(bn):Ze(Ut,!1)})}x(de,je)};J(sa,de=>{v(i)&&de(aa)})}var oa=w(Ye,2),ia=C(oa);ia.__click=[ii],W(()=>Ie(N,1,`mx-auto mb-2 w-[95%] select-none rounded-lg border-2 ${Q($e)?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black"} p-2 font-bold hover:opacity-75`)),x(y,T)},$$slots:{default:!0}}),y=>o=y,()=>o);var G=be(X);return a(),G}st(["click","change"]);var zi=L('<div class="absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black"> </div>'),Ji=L('<option class="dark:bg-slate-900"> </option>'),Xi=L('<label class="flex flex-col"><span class="text-sm">Game Client</span> <select id="game_client_select" class="w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select></label>'),Yi=L('<button class="w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Plugin menu</button>'),Zi=L('<option class="dark:bg-slate-900"><!></option>'),Ki=L('<option class="dark:bg-slate-900" disabled selected>No characters</option>'),Qi=L('<!> <!> <div class="bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800"><!> <div class="flex flex-col items-center gap-4"><img src="svgs/rocket-solid.svg" alt="Launch icon" class="mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"/> <button class="w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500">Play</button> <!> <label class="flex flex-col"><span class="text-sm">Character</span> <select id="character_select" class="mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"><option disabled class="dark:bg-slate-900">Select an account</option><!></select></label></div></div>',1);function el(e,t){me(t,!0);const n=()=>ve(f,"$config",i),r=()=>ve(g,"$psa",i),a=()=>ve(m,"$gameEnabled",i),o=()=>ve(d,"$initialized",i),[i,u]=Je();let l,c,{config:f,initialized:d}=O,p=Be(()=>n().selected.user_id),_=Be(()=>n().userDetails[v(p)??""]?.account_id),h=Be(()=>te.findSession(n().selected.user_id)?.accounts??[]),g=Bt(null),m=Bt(!0);fn(()=>{if(n().check_announcements){const V=n().selected.game==Le.osrs?"osrs":$.env.provider,X=`${$.env.psa_url}${V}/${V}.json`;fetch(X,{method:"GET",cache:"no-store"}).then(G=>G.json()).then(G=>{An(g,G.psaEnabled&&G.psaMessage?G.psaMessage:null),An(m,!(G.playDisabled??!1))})}else An(g,null),An(m,!0)});function k(V,X){if(!v(p))return A.warn("Please log in or select a user to play.");if(!v(_))return A.warn("Please select a character from the select menu.");const G=te.findSession(n().selected.user_id);if(!G)return A.warn("Unable to launch game, session was not found.");const{session_id:y}=G,I=te.findAccount(G.accounts,v(_));if(!I)return A.warn("Unable to launch game, account was not found.");const{accountId:T,displayName:z}=I,N=$.platform===kr.Windows,Y=$.platform===kr.Linux;switch(V){case Le.osrs:switch(X){case tn.official:_s(N||Y,!0,y,T,z);break;case tn.runelite:ra(y,T,z,!1);break;case tn.hdos:ni(y,T,z);break}break;case Le.rs3:Y?ti(y,T,z):_s(N,!1,y,T,z);break}}function b(V){const X=V.target.value;if(!v(p))return;const G=n().userDetails[v(p)];G?(G.account_id=X,ie(f,R(n).userDetails[v(p)]=G,R(n))):ie(f,R(n).userDetails[v(p)]={account_id:X},R(n))}var U={launch:k},H=Qi(),D=B(H);wt(oi(D,{}),V=>l=V,()=>l);var S=w(D,2);wt(Vi(S,{}),V=>c=V,()=>c);var E=w(S,2),M=C(E);{var j=V=>{var X=zi(),G=C(X);W(()=>pe(G,r())),x(V,X)};J(M,V=>{r()&&V(j)})}var ce=w(M,2),re=w(C(ce),2);re.__click=()=>{a()?k(n().selected.game,n().selected.client):l.open(k,n().selected.game,n().selected.client)};var ne=w(re,2);{var Se=V=>{var X=Xi(),G=w(C(X),2);Pt(G,5,()=>da[n().selected.game],Dt,(y,I)=>{var T=Ji(),z=C(T),N={};W(()=>{pe(z,v(I)),N!==(N=v(I))&&(T.value=(T.__value=v(I))??"")}),x(y,T)}),Vr(G,()=>n().selected.client,y=>ie(f,R(n).selected.client=y,R(n))),x(V,X)},K=V=>{var X=lt(),G=B(X);{var y=I=>{var T=Yi();T.__click=()=>{c.open()},W(()=>{T.disabled=!$.hasBoltPlugins,gt(T,"title",$.hasBoltPlugins?null:"This feature is disabled")}),x(I,T)};J(G,I=>{n().selected.game===Le.rs3&&I(y)},!0)}x(V,X)};J(ne,V=>{n().selected.game==Le.osrs?V(Se):V(K,!1)})}var $e=w(ne,2),fe=w(C($e),2);fe.__change=b;var De=C(fe);De.value=(De.__value=void 0)??"";var at=w(De);Pt(at,17,()=>v(h),Dt,(V,X)=>{var G=Zi(),y=C(G);{var I=N=>{var Y=os();W(()=>pe(Y,v(X).displayName)),x(N,Y)},T=N=>{var Y=os("New Character");x(N,Y)};J(y,N=>{v(X).displayName?N(I):N(T,!1)})}var z={};W(()=>{z!==(z=v(X).accountId)&&(G.value=(G.__value=v(X).accountId)??"")}),x(V,G)},V=>{var X=Ki();x(V,X)});var Te;Qs(fe),W(()=>{re.disabled=!o(),fe.disabled=!o()||n().selected.user_id===null,Te!==(Te=v(_))&&(fe.value=(fe.__value=v(_))??"",Gr(fe,v(_)))}),x(e,H);var kt=be(U);return u(),kt}st(["click","change"]);var tl=L("<li> </li>"),nl=L('<div class="fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900"><div class="absolute right-6 top-2"><img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/></div> <ol id="message_list" class="h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"></ol></div>');function rl(e,t){me(t,!0);var n=nl(),r=w(C(n),2);Pt(r,21,()=>t.logs,Dt,(a,o)=>{let i=()=>v(o).date,u=()=>v(o).severity,l=()=>v(o).content;var c=tl();let f;var d=C(c);W((p,_)=>{f=Ie(c,1,"",null,f,p),pe(d,`${_??""}
				- ${l()??""}`)},[()=>({"text-rose-500":u()===Rr.error,"text-orange-700":u()===Rr.warn}),()=>i()?.toLocaleTimeString()]),x(a,c)}),x(e,n),be()}var sl=L('<option class="dark:bg-slate-900"> </option>'),al=()=>{const{origin:e,redirect:t,clientid:n}=$.env;Pe.openLoginWindow(e,t,n)},ol=async(e,t,n)=>{t().selected.user_id&&(await te.logout(t().selected.user_id),te.saveCredentials())},il=L('<select class="w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"><option disabled class="dark:bg-slate-900">Select a user</option><!></select> <div class="mt-5 flex"><button class="mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Log In</button> <button class="mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75">Log Out</button></div>',1);function ll(e,t){me(t,!1);const n=()=>ve(u,"$config",a),r=()=>ve(i,"$sessions",a),[a,o]=Je(),{sessions:i,config:u}=O;At();var l=il(),c=B(l);W(()=>{n(),ao(()=>{r()})});var f=C(c);f.value=(f.__value=null)??"";var d=w(f);Pt(d,1,r,g=>g.user.userId,(g,m)=>{var k=sl(),b=C(k),U={};W(()=>{pe(b,v(m).user.displayName),U!==(U=v(m).user.userId)&&(k.value=(k.__value=v(m).user.userId)??"")}),x(g,k)});var p=w(c,2),_=C(p);_.__click=[al];var h=w(_,2);h.__click=[ol,n,u],W(()=>h.disabled=!n().selected.user_id),Vr(c,()=>n().selected.user_id,g=>ie(u,R(n).selected.user_id=g,R(n))),x(e,l),be(),o()}st(["click"]);function ul(e,{callback:t,ignore:n=[]}){const r=a=>{const o=n.some(i=>i.contains(a.target));e&&!e.contains(a.target)&&!a.defaultPrevented&&!o&&t()};return document.addEventListener("click",r,!0),document.addEventListener("contextmenu",r,!0),{destroy(){document.removeEventListener("click",r,!0),document.removeEventListener("contextmenu",r,!0)}}}function cl(e,t,n,r){v(t)?n():r()}var fl=L("<div><!></div>"),dl=L("<div><button><!></button> <!></div>");function _l(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme),u=ln(t,"class",3,""),l=ln(t,"position",3,"bottom"),c=ln(t,"align",3,"start"),f=oe(!1),d=oe(void 0);function p(){P(f,!0)}function _(){P(f,!1)}var h={open:p,close:_},g=dl();let m;var k=C(g);k.__click=[cl,f,_,p];var b=C(k);Vn(b,()=>t.children??nt),wt(k,S=>P(d,S),()=>v(d));var U=w(k,2);{var H=S=>{var E=fl(),M=C(E);Vn(M,()=>t.content??nt),Co(E,(j,ce)=>ul?.(j,ce),()=>({callback:_,ignore:[v(d)]})),W(()=>Ie(E,1,`dropdown-color absolute z-20 rounded-lg border-2 ${l()??""} ${c()??""}`,"svelte-11xj3vp")),x(S,E)};J(U,S=>{v(f)&&S(H)})}W(S=>m=Ie(g,1,`relative h-fit w-fit ${u()??""}`,"svelte-11xj3vp",m,S),[()=>({dark:v(i)})]),x(e,g);var D=be(h);return a(),D}st(["click"]);var vl=(e,t)=>{t()},pl=L('<button id="data_dir_button" class="p-2 hover:opacity-75"><div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/> Browse App Data</div></button> <div class="mx-auto p-2"><label for="check_announcements">Check game announcements:</label> <input id="check_announcements" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="close_after_launch">Close Bolt after launching a game:</label> <input id="close_after_launch" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="discard_expired_logins">Discard expired login sessions:</label> <input id="discard_expired_logins" type="checkbox" class="ml-2"/></div>',1);function hl(e,t){me(t,!1);const n=()=>ve(i,"$config",r),[r,a]=Je();function o(){var b=new XMLHttpRequest;b.open("GET","/browse-data"),b.onreadystatechange=()=>{b.readyState==4&&A.info(`Browse status: '${b.responseText.trim()}'`)},b.send()}const{config:i}=O,u="Allow checking for official announcements about game status. These will be displayed above the 'play' button. Disabling will reduce the number of web requests made when opening the launcher.",l="Close the launcher immediately after launching a game",c="Discard login sessions if they're no longer valid, prompting the player to sign-in again. If unchecked, the only way to discard a login will be by manually pressing the 'log out' button, even if your login no longer works.";At();var f=pl(),d=B(f);d.__click=[vl,o];var p=w(d,2);gt(p,"title",u);var _=w(C(p),2),h=w(p,2);gt(h,"title",l);var g=w(C(h),2),m=w(h,2);gt(m,"title",c);var k=w(C(m),2);on(_,()=>n().check_announcements,b=>ie(i,R(n).check_announcements=b,R(n))),on(g,()=>n().close_after_launch,b=>ie(i,R(n).close_after_launch=b,R(n))),on(k,()=>n().discard_expired_sessions,b=>ie(i,R(n).discard_expired_sessions=b,R(n))),x(e,f),be(),a()}st(["click"]);var gl=(e,t)=>t(),ml=(e,t)=>{t()},bl=L('<button class="p-2 pb-5 hover:opacity-75"><div class="flex"><img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/> Configure RuneLite</div></button> <div class="mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"><label for="use_custom_jar">Use custom RuneLite JAR:</label> <input id="use_custom_jar" type="checkbox" class="ml-2"/></div> <div><textarea class="h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"></textarea> <br/> <button class="mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 enabled:hover:opacity-75">Select File</button></div> <div class="p-2"><label for="osrs_custom_launch_command">OSRS launch command:</label> <br/> <textarea id="osrs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="runelite_custom_launch_command">RuneLite launch command:</label> <br/> <textarea id="runelite_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="hdos_custom_launch_command">HDOS launch command:</label> <br/> <textarea id="hdos_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function wl(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>te.findSession(n().selected.user_id)),u=Be(()=>te.findAccount(v(i)?.accounts??[],n().userDetails[n().selected.user_id??""]?.account_id)),l=oe(!1);async function c(){P(l,!0),ie(o,R(n).runelite_custom_jar=await te.openFilePicker(),R(n)),console.log("done picking"),P(l,!1)}function f(){!v(i)?.session_id||!v(u)?.accountId||!v(u)?.displayName||ra(v(i).session_id,v(u).accountId,v(u).displayName,!0)}var d=bl(),p=B(d);p.__click=[gl,f];var _=w(p,2),h=w(C(_),2),g=w(_,2);let m;var k=C(g),b=w(k,4);b.__click=[ml,c];var U=w(g,2),H=w(C(U),4);gt(H,"placeholder","%command%");var D=w(U,2),S=w(C(D),4);gt(S,"placeholder","%command%");var E=w(D,2),M=w(C(E),4);gt(M,"placeholder","%command%"),W(j=>{p.disabled=!v(i)?.session_id||!v(u)?.accountId,m=Ie(g,1,"mx-auto p-2",null,m,j),k.disabled=!n().runelite_use_custom_jar,b.disabled=v(l)||!n().runelite_use_custom_jar},[()=>({"opacity-25":!n().runelite_use_custom_jar})]),on(h,()=>n().runelite_use_custom_jar,j=>ie(o,R(n).runelite_use_custom_jar=j,R(n))),jt(k,()=>n().runelite_custom_jar,j=>ie(o,R(n).runelite_custom_jar=j,R(n))),jt(H,()=>n().osrs_launch_command,j=>ie(o,R(n).osrs_launch_command=j,R(n))),jt(S,()=>n().runelite_launch_command,j=>ie(o,R(n).runelite_launch_command=j,R(n))),jt(M,()=>n().hdos_launch_command,j=>ie(o,R(n).hdos_launch_command=j,R(n))),x(e,d),be(),a()}st(["click"]);var yl=L('<div class="mx-auto p-2"><label for="enable_plugins">Enable Bolt plugin loader:</label> <input type="checkbox" name="enable_plugins" id="enable_plugins" class="ml-2"/></div>'),kl=L('<!> <div class="mx-auto p-2"><label for="use_custom_uri">Use custom config URI:</label> <input id="use_custom_uri" type="checkbox" class="ml-2"/></div> <div class="p-2"><textarea class="rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="4"></textarea></div> <div class="p-2"><label for="rs_custom_launch_command">Launch command:</label> <br/> <textarea id="rs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function xl(e,t){me(t,!1);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;At();var i=kl(),u=B(i);{var l=g=>{var m=yl(),k=w(C(m),2);on(k,()=>n().rs_plugin_loader,b=>ie(o,R(n).rs_plugin_loader=b,R(n))),x(g,m)};J(u,g=>{$.hasBoltPlugins&&g(l)})}var c=w(u,2),f=w(C(c),2),d=w(c,2),p=C(d),_=w(d,2),h=w(C(_),4);gt(h,"placeholder","%command%"),W(()=>{p.disabled=!n().use_custom_rs_config_uri,gt(p,"placeholder",$.env.default_config_uri)}),on(f,()=>n().use_custom_rs_config_uri,g=>ie(o,R(n).use_custom_rs_config_uri=g,R(n))),jt(p,()=>n().rs_config_uri,g=>ie(o,R(n).rs_config_uri=g,R(n))),jt(h,()=>n().rs_launch_command,g=>ie(o,R(n).rs_launch_command=g,R(n))),x(e,i),be(),a()}var Sl=(e,t,n)=>{P(t,n.general)},$l=(e,t,n)=>{P(t,n.osrs)},El=(e,t,n)=>{P(t,n.rs3)},Ll=L('<div class="grid h-full grid-cols-4"><div class="flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"><button>General</button> <button>OSRS</button> <button>RS3</button></div> <div class="col-span-3 p-5 pt-10 text-center"><!></div></div>');function Cl(e,t){me(t,!1);var n=(c=>(c[c.general=0]="general",c[c.osrs=1]="osrs",c[c.rs3=2]="rs3",c))(n||{});let r=We(),a=We(0),o="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",i="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function u(){v(r).open()}var l={open:u};return At(),wt(nr(e,{class:"h-3/4 w-3/4 select-none",children:(c,f)=>{var d=Ll(),p=C(d),_=C(p);_.__click=[Sl,a,n];var h=w(_,2);h.__click=[$l,a,n];var g=w(h,2);g.__click=[El,a,n];var m=w(p,2),k=C(m);{var b=H=>{hl(H,{})},U=H=>{var D=lt(),S=B(D);{var E=j=>{wl(j,{})},M=j=>{var ce=lt(),re=B(ce);{var ne=Se=>{xl(Se,{})};J(re,Se=>{v(a)==n.rs3&&Se(ne)},!0)}x(j,ce)};J(S,j=>{v(a)==n.osrs?j(E):j(M,!1)},!0)}x(H,D)};J(k,H=>{v(a)==n.general?H(b):H(U,!1)})}W(()=>{Ie(_,1,Hn(v(a)===n.general?o:i)),Ie(h,1,Hn(v(a)===n.osrs?o:i)),Ie(g,1,Hn(v(a)===n.rs3?o:i))}),x(c,d)},$$slots:{default:!0},$$legacy:!0}),c=>P(r,c),()=>v(r)),ea(t,"open",u),be(l)}st(["click"]);var Pl=(e,t,n)=>{ie(n,R(t).selected.game=Le.rs3,R(t))},Rl=(e,t,n)=>{ie(n,R(t).selected.game=Le.osrs,R(t))},Il=(e,t,n)=>ie(n,R(t).use_dark_theme=!t().use_dark_theme,R(t)),Tl=(e,t)=>v(t).open(),Ol=L('<div class="w-40"><!></div>'),Al=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50"> </button>'),Ul=()=>{const{origin:e,redirect:t,clientid:n}=$.env;Pe.openLoginWindow(e,t,n)},Nl=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50">Login</button>'),Hl=L('<!> <div class="fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900"><div class="m-3 ml-9 font-bold"><button>RS3</button> <button>OSRS</button></div> <div class="m-2 ml-auto flex gap-2"><button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/></button> <button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/></button> <!></div></div>',1);function Ml(e,t){me(t,!1);const n=()=>ve(i,"$config",a),r=()=>ve(u,"$sessions",a),[a,o]=Je(),{config:i,sessions:u}=O;let l=We();At();var c=Hl(),f=B(c);wt(Cl(f,{$$legacy:!0}),E=>P(l,E),()=>v(l));var d=w(f,2),p=C(d),_=C(p);let h;_.__click=[Pl,n,i];var g=w(_,2);let m;g.__click=[Rl,n,i];var k=w(p,2),b=C(k);b.__click=[Il,n,i];var U=w(b,2);U.__click=[Tl,l];var H=w(U,2);{var D=E=>{const M=jr(()=>te.findSession(n().selected.user_id??""));_l(E,{align:"center",content:ce=>{var re=Ol(),ne=C(re);ll(ne,{}),x(ce,re)},children:(ce,re)=>{var ne=Al(),Se=C(ne);W(()=>pe(Se,v(M)?.user.displayName??"No user selected")),x(ce,ne)},$$slots:{content:!0,default:!0}})},S=E=>{var M=Nl();M.__click=[Ul],x(E,M)};J(H,E=>{r().length>0?E(D):E(S,!1)})}W((E,M)=>{h=Ie(_,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75",null,h,E),m=Ie(g,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75",null,m,M)},[()=>({"text-black":n().selected.game===Le.rs3,"bg-blue-500":n().selected.game===Le.rs3}),()=>({"text-black":n().selected.game===Le.osrs,"bg-blue-500":n().selected.game===Le.osrs})]),x(e,c),be(),o()}st(["click"]);var Dl=L('<!> <!> <div class="mt-16 grid h-full grid-flow-col grid-cols-3"><div></div> <!> <div></div></div> <!>',1);function jl(e,t){me(t,!1);const n=()=>ve(o,"$logs",r),[r,a]=Je(),o=A.logs;At(),ko("beforeunload",Sr,()=>{te.saveConfig(),$.hasBoltPlugins&&te.savePluginConfig(!0)}),na(e,{children:(i,u)=>{var l=Dl(),c=B(l);Yo(c,{});var f=w(c,2);Ml(f,{});var d=w(f,2),p=w(C(d),2);el(p,{});var _=w(d,2);rl(_,{get logs(){return n()}}),x(i,l)}}),be(),a()}const vs={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?is(Wo,vs):(Fl(),jo(),ql(),Bl().finally(()=>{O.initialized.set(!0)}),is(jl,vs));function Fl(){const e=new URLSearchParams(window.location.search);$.platform=e.get("platform"),$.isFlathub=e.get("flathub")==="1",$.hasLibArchive=e.get("has_libarchive")==="1",$.rs3debInstalledHash=e.get("rs3_deb_installed_hash"),$.rs3exeInstalledHash=e.get("rs3_exe_installed_hash"),$.rs3appInstalledHash=e.get("rs3_app_installed_hash"),$.osrsexeInstalledHash=e.get("osrs_exe_installed_hash"),$.osrsappInstalledHash=e.get("osrs_app_installed_hash"),$.runeLiteInstalledId=e.get("runelite_installed_id"),$.hdosInstalledVersion=e.get("hdos_installed_version");const t=e.get("plugins");if($.hasBoltPlugins=t!==null,t!==null)try{$.pluginConfig=JSON.parse(t)}catch{A.error("Unable to parse plugin list")}const n=e.get("credentials");if(n)try{const r=JSON.parse(n),a=r.every(o=>typeof o.session_id=="string"&&typeof o.tokens=="object"&&typeof o.accounts=="object"&&typeof o.user=="object");a?O.sessions.set(r):(O.sessions.set([]),te.saveCredentials(),A.warn("Credentials saved on disk are out of date. Please sign in again.")),O.sessions.set(a?r:[])}catch{O.sessions.set([]),te.saveCredentials(),A.error("Unable to parse saved credentials. Please sign in again.")}}function ql(){const{origin:e,origin_2fa:t}=$.env,n=[window.location.origin,e,t];let r=null;window.addEventListener("message",async a=>{if(!n.includes(a.origin)){A.info(`discarding window message from origin ${a.origin}`);return}switch(a.data.type){case"authTokenUpdate":{r=a.data.tokens;break}case"authSessionUpdate":{if(r===null)return A.error("auth is null. Please try again.");const o=a.data.sessionId,i=await te.login(r,o);i.ok?A.info(`Added new user '${i.value.user.displayName}'`):A.error(`Unable to add new user. Please try again. ${i.error}`),te.saveCredentials(),Pe.pendingLoginWindow=null,r=null;break}case"authFailed":{A.error(`Unable to authenticate: ${a.data.reason}`),Pe.pendingLoginWindow=null,r=null;break}case"externalUrl":{const o=new XMLHttpRequest;o.onreadystatechange=()=>{o.readyState==4&&A.info(`External URL status: '${o.responseText.trim()}'`)},o.open("POST","/open-external-url",!0),o.send(a.data.url);break}case"gameClientList":Ce(O.config).close_after_launch&&a.data.clients.length>Ce(Ir).length?fetch("/close"):Ir.set(a.data.clients);break;default:{const o=a.data?.type??"no type provided";A.info(`Unknown message type: ${o}`);break}}})}async function Bl(){const e=Ce(O.config).discard_expired_sessions,t=Ce(O.sessions),n=[];t.length>0&&A.info("Logging in...");const r=t.map(i=>({promise:Pe.refreshOAuthToken(i.tokens),session:i})),a=[];for(const i of r){const u=i.session,l=await i.promise;if(!l.ok){l.error===0?A.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):l.error>=400&&l.error<500&&e?(A.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),n.push(u.tokens.sub)):A.error(`Unable to verify saved login due to HTTP error ${l.error}`);continue}const c=l.value;u.tokens=c,a.push({promise:te.login(c,u.session_id),session:u})}for(const i of a){const u=i.session,l=await i.promise;l.ok?A.info(`Signed into saved user '${l.value.user.displayName}'`):(A.error(`Unable to sign into saved user '${u.user.displayName}' due to an error: ${l.error}`),e&&n.push(u.tokens.sub))}const o=n.map(te.logout);for(const i of o)await i;O.sessions.set(t),await te.saveCredentials()}
