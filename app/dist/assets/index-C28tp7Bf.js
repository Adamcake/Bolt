var Vt=Object.defineProperty;var Yt=(t,e,n)=>e in t?Vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ue=(t,e,n)=>(Yt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var rt=(t=>(t[t.SECOND=1e3]="SECOND",t[t.MINUTE=6e4]="MINUTE",t[t.HALF_HOUR=18e5]="HALF_HOUR",t[t.HOUR=36e5]="HOUR",t[t.DAY=864e5]="DAY",t[t.WEEK=6048e5]="WEEK",t[t.MONTH=2592e6]="MONTH",t))(rt||{});class Ie{static set(e,n,l,o){const r=new Date;r.setTime(r.getTime()+l*o);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${n};${i};path=/`}static get(e){const n=`${e}=`,l=document.cookie.split(";");for(let o=0;o<l.length;o++){let r=l[o];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function ge(t){return{ok:!0,value:t}}function V(t){return{ok:!1,error:t}}var te=(t=>(t.rs3="rs3",t.osrs="osrs",t))(te||{}),ye=(t=>(t.official="Official",t.runelite="RuneLite",t.hdos="HDOS",t))(ye||{});const ft={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class Ge{static parseTokenResponse(e){try{const n=JSON.parse(e),l=n.id_token.split(".");if(l.length!==3){const i=`Malformed id_token: ${l.length} sections, expected 3`;return V(i)}const o=JSON.parse(atob(l[0]));if(o.typ!=="JWT"){const i=`Bad id_token header: typ ${o.typ}, expected JWT`;return V(i)}const r=JSON.parse(atob(l[1]));return ge({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:r.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return V("Unable to parse token response")}}static parseSessionResponse(e){try{const n=JSON.parse(e);return n.sessionId?ge(n.sessionId):V("sessionId does not exist on parsed object")}catch{return V("Unable to parse session response")}}static decodeBolt(e){const n={};for(const l in e){const o=l,r=e[o];typeof r=="string"?n[o]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?n[o]=r.map(i=>atob(i)):n[o]=r}return n}}var Me=(t=>(t.Windows="windows",t.Linux="linux",t.MacOS="mac",t))(Me||{});const C={env:Ge.decodeBolt(s()),platform:null,rs3DebInstalledHash:null,rs3ExeInstalledHash:null,rs3AppInstalledHash:null,osrsExeInstalledHash:null,osrsAppInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasBoltPlugins:!1,pluginList:{}};class et{static async makeLoginUrl(e){const n=new TextEncoder().encode(e.pkceCodeVerifier),l=await crypto.subtle.digest("SHA-256",n);let o="";const r=new Uint8Array(l);for(let a=0;a<r.byteLength;a++)o+=String.fromCharCode(r[a]);const i=btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(l){return e[l%e.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=n.length-1,o=crypto.getRandomValues(new Uint8Array(12));return Array.from(o).map(r=>Math.round(r*(l-0)/255+0)).map(r=>n[r]).join("")}}const He=class He{static async openLoginWindow(e,n,l){if(He.pendingLoginWindow!==null)return He.pendingLoginWindow.window.focus();const o=et.makeRandomState(),r=et.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let c="";const u=new Uint8Array(a);for(let g=0;g<u.byteLength;g++)c+=String.fromCharCode(u[g]);const d=btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:l,redirect_uri:n,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:o}),_=`${e}/oauth2/auth?${f.toString()}`;Ie.set("auth_verifier",r,10,rt.MINUTE),He.pendingLoginWindow=window.open(_,"","width=480,height=720")}static navigateToAuthConsent(e,n,l){const o=et.makeRandomState(),r=new URLSearchParams({id_token_hint:n,nonce:l,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:o,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;Ie.set("auth_nonce",l,10,rt.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(n=>{if(e.expiry-Date.now()<3e4){const l=new URLSearchParams({grant_type:"refresh_token",client_id:C.env.clientid,refresh_token:e.refresh_token}),o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=Ge.parseTokenResponse(o.response);i.ok?n(ge(i.value)):n(V(0))}else n(V(o.status))},o.onerror=()=>{n(V(0))};const r=C.env.origin.concat("/oauth2/token");o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Accept","application/json"),o.send(l)}else n(ge(e))})}static async getOAuthToken(e,n,l,o,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const d=Ge.parseTokenResponse(c.response);return d.ok?a(ge(d.value)):a(V(d.error))}else return a(V(`Error: from ${i}: ${c.status}: ${c.response}`))},c.open("POST",i,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("Accept","application/json");const u=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:r,code_verifier:l,redirect_uri:o});c.send(u)})}static revokeOauthCreds(e){const n=`${C.env.origin}/oauth2/revoke`;return new Promise(l=>{const o=new XMLHttpRequest;o.open("POST",n,!0),o.onreadystatechange=()=>{o.readyState==4&&l(o.status)},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:C.env.clientid});o.send(r)})}static async getSessionId(e,n){const l=`${e}/sessions`;return new Promise(o=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=Ge.parseSessionResponse(r.response);return a.ok?o(ge(a.value)):o(V(a.error))}else V(`Error: from ${l}: ${r.status}: ${r.response}`)},r.open("POST",l,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:n};r.send(JSON.stringify(i))})}static validateIdToken(e,n){const l=e.split(".");if(l.length!==3)return V(`Malformed id_token: ${l.length} sections, expected 3`);const o=JSON.parse(atob(l[0]));return o.typ!=="JWT"?V(`Bad id_token header: typ ${o.typ}, expected JWT`):JSON.parse(atob(l[1])).nonce!==n?V("Incorrect nonce in id_token"):ge(void 0)}};Ue(He,"pendingLoginWindow",null);let _e=He;class Xe{static async buildSession(e,n){const l=await Xe.getUser(e.sub,e.access_token);if(!l.ok)return V(`Failed to fetch user. Status: ${l.error}`);const o=await Xe.getUserAccounts(n);return o.ok?ge({user:l.value,accounts:o.value,tokens:e,session_id:n}):V(`Failed to fetch game accounts. Status: ${o.error}`)}static getUser(e,n){return new Promise(l=>{const o=`${C.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);l(ge(i))}else l(V(r.status))},r.open("GET",o,!0),r.setRequestHeader("Authorization","Bearer ".concat(n)),r.send()})}static getUserAccounts(e){const n=`${C.env.auth_api}/accounts`;return new Promise(l=>{const o=new XMLHttpRequest;o.onreadystatechange=async()=>{if(o.readyState==4)if(o.status==200){const r=JSON.parse(o.response);l(ge(r))}else l(V(o.status))},o.open("GET",n,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer ".concat(e)),o.send()})}}function j(){}function Zt(t,e){for(const n in e)t[n]=e[n];return t}function Kt(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function Bt(t){return t()}function pt(){return Object.create(null)}function re(t){t.forEach(Bt)}function We(t){return typeof t=="function"}function le(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Be;function Qt(t,e){return t===e?!0:(Be||(Be=document.createElement("a")),Be.href=e,t===Be.href)}function en(t){return Object.keys(t).length===0}function Gt(t,...e){if(t==null){for(const l of e)l(void 0);return j}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function pe(t){let e;return Gt(t,n=>e=n)(),e}function ue(t,e,n){t.$$.on_destroy.push(Gt(e,n))}function ze(t,e,n,l){if(t){const o=Ft(t,e,n,l);return t[0](o)}}function Ft(t,e,n,l){return t[1]&&l?Zt(n.ctx.slice(),t[1](l(e))):n.ctx}function Ve(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|o[a];return r}return e.dirty|o}return e.dirty}function Ye(t,e,n,l,o,r){if(o){const i=Ft(e,n,l,r);t.p(i,o)}}function Ze(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function me(t,e,n){return t.set(n),e}function tn(t){return t&&We(t.destroy)?t.destroy:j}function k(t,e){t.appendChild(e)}function y(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function Le(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function J(t){return document.createTextNode(t)}function R(){return J(" ")}function be(){return J("")}function M(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function nn(t){return function(e){e.target===this&&t.call(this,e)}}function h(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function sn(t){return Array.from(t.childNodes)}function fe(t,e){e=""+e,t.data!==e&&(t.data=e)}function de(t,e){t.value=e??""}function $e(t,e,n){for(let l=0;l<t.options.length;l+=1){const o=t.options[l];if(o.__value===e){o.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function ct(t){const e=t.querySelector(":checked");return e&&e.__value}function ne(t,e,n){t.classList.toggle(e,!!n)}function ln(t,e,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:l})}let je;function ke(t){je=t}function Ke(){if(!je)throw new Error("Function called outside component initialization");return je}function Xt(t){Ke().$$.on_mount.push(t)}function on(t){Ke().$$.on_destroy.push(t)}function rn(){const t=Ke();return(e,n,{cancelable:l=!1}={})=>{const o=t.$$.callbacks[e];if(o){const r=ln(e,n,{cancelable:l});return o.slice().forEach(i=>{i.call(t,r)}),!r.defaultPrevented}return!0}}const xe=[],he=[];let Oe=[];const _t=[],an=Promise.resolve();let it=!1;function cn(){it||(it=!0,an.then(ut))}function Ee(t){Oe.push(t)}const tt=new Set;let Ce=0;function ut(){if(Ce!==0)return;const t=je;do{try{for(;Ce<xe.length;){const e=xe[Ce];Ce++,ke(e),un(e.$$)}}catch(e){throw xe.length=0,Ce=0,e}for(ke(null),xe.length=0,Ce=0;he.length;)he.pop()();for(let e=0;e<Oe.length;e+=1){const n=Oe[e];tt.has(n)||(tt.add(n),n())}Oe.length=0}while(xe.length);for(;_t.length;)_t.pop()();it=!1,tt.clear(),ke(t)}function un(t){if(t.fragment!==null){t.update(),re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ee)}}function dn(t){const e=[],n=[];Oe.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),Oe=e}const Fe=new Set;let Se;function De(){Se={r:0,c:[],p:Se}}function qe(){Se.r||re(Se.c),Se=Se.p}function D(t,e){t&&t.i&&(Fe.delete(t),t.i(e))}function F(t,e,n,l){if(t&&t.o){if(Fe.has(t))return;Fe.add(t),Se.c.push(()=>{Fe.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function Je(t,e){const n=e.token={};function l(o,r,i,a){if(e.token!==n)return;e.resolved=a;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=a);const u=o&&(e.current=o)(c);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==r&&f&&(De(),F(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),qe())}):e.block.d(1),u.c(),D(u,1),u.m(e.mount(),e.anchor),d=!0),e.block=u,e.blocks&&(e.blocks[r]=u),d&&ut()}if(Kt(t)){const o=Ke();if(t.then(r=>{ke(o),l(e.then,1,e.value,r),ke(null)},r=>{if(ke(o),l(e.catch,2,e.error,r),ke(null),!e.hasCatch)throw r}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,t),!0;e.resolved=t}}function Jt(t,e,n){const l=e.slice(),{resolved:o}=t;t.current===t.then&&(l[t.value]=o),t.current===t.catch&&(l[t.error]=o),t.block.p(l,n)}function oe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function fn(t,e){t.d(1),e.delete(t.key)}function pn(t,e,n,l,o,r,i,a,c,u,d,f){let _=t.length,g=r.length,p=_;const v={};for(;p--;)v[t[p].key]=p;const b=[],L=new Map,$=new Map,N=[];for(p=g;p--;){const T=f(o,r,p),S=n(T);let x=i.get(S);x?l&&N.push(()=>x.p(T,e)):(x=u(S,T),x.c()),L.set(S,b[p]=x),S in v&&$.set(S,Math.abs(p-v[S]))}const O=new Set,U=new Set;function B(T){D(T,1),T.m(a,d),i.set(T.key,T),d=T.first,g--}for(;_&&g;){const T=b[g-1],S=t[_-1],x=T.key,E=S.key;T===S?(d=T.first,_--,g--):L.has(E)?!i.has(x)||O.has(x)?B(T):U.has(E)?_--:$.get(x)>$.get(E)?(U.add(x),B(T)):(O.add(E),_--):(c(S,i),_--)}for(;_--;){const T=t[_];L.has(T.key)||c(T,i)}for(;g;)B(b[g-1]);return re(N),b}function se(t){t&&t.c()}function Z(t,e,n){const{fragment:l,after_update:o}=t.$$;l&&l.m(e,n),Ee(()=>{const r=t.$$.on_mount.map(Bt).filter(We);t.$$.on_destroy?t.$$.on_destroy.push(...r):re(r),t.$$.on_mount=[]}),o.forEach(Ee)}function K(t,e){const n=t.$$;n.fragment!==null&&(dn(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _n(t,e){t.$$.dirty[0]===-1&&(xe.push(t),cn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ie(t,e,n,l,o,r,i=null,a=[-1]){const c=je;ke(t);const u=t.$$={fragment:null,ctx:[],props:r,update:j,not_equal:o,bound:pt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:pt(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};i&&i(u.root);let d=!1;if(u.ctx=n?n(t,e.props||{},(f,_,...g)=>{const p=g.length?g[0]:_;return u.ctx&&o(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),d&&_n(t,f)),_}):[],u.update(),d=!0,re(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const f=sn(e.target);u.fragment&&u.fragment.l(f),f.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&D(t.$$.fragment),Z(t,e.target,e.anchor),ut()}ke(c)}class ae{constructor(){Ue(this,"$$");Ue(this,"$$set")}$destroy(){K(this,1),this.$destroy=j}$on(e,n){if(!We(n))return j;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!en(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const gn="4",Re=[];function ve(t,e=j){let n;const l=new Set;function o(a){if(le(t,a)&&(t=a,n)){const c=!Re.length;for(const u of l)u[1](),Re.push(u,t);if(c){for(let u=0;u<Re.length;u+=2)Re[u][0](Re[u+1]);Re.length=0}}}function r(a){o(a(t))}function i(a,c=j){const u=[a,c];return l.add(u),l.size===1&&(n=e(o,r)||j),a(t),()=>{l.delete(u),l.size===0&&n&&(n(),n=null)}}return{set:o,update:r,subscribe:i}}var Ne=(t=>(t.info="info",t.warn="warn",t.error="error",t))(Ne||{});class hn{constructor(){Ue(this,"logs",ve([]))}_addLog(e,n){this.logs.update(l=>(l.unshift({date:new Date,severity:e,content:n}),l))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,n){this.logs.update(l=>(l[e]&&(l[e].content=n),l))}}const P=new hn;function mn(t,e){let n=!1;return t.subscribe(l=>{n?e(l):n=!0})}const bn={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,selected:{game:te.osrs,client:ye.runelite,user_id:null},userDetails:{}};function kn(){const e=new URLSearchParams(window.location.search).get("config");function n(o){return typeof o=="object"&&typeof o.use_dark_theme=="boolean"&&typeof o.rs_plugin_loader=="boolean"&&typeof o.close_after_launch=="boolean"&&typeof o.check_announcements=="boolean"&&typeof o.flatpak_rich_presence=="boolean"&&typeof o.runelite_use_custom_jar=="boolean"&&typeof o.selected=="object"&&Object.values(te).includes(o.selected.game)&&Object.values(ye).includes(o.selected.client)&&(typeof o.selected.user_id=="string"||o.selected.user_id===null)&&typeof o.userDetails=="object"}const{config:l}=A;if(e)try{const o=JSON.parse(e);typeof o.check_announcements>"u"&&(o.check_announcements=!0,A.configHasPendingChanges=!0),typeof o.close_after_launch>"u"&&(o.close_after_launch=!1,A.configHasPendingChanges=!0),n(o)?l.set(o):(P.error("The config saved on disk is not the correct format. It has been restored to default."),A.configHasPendingChanges=!0)}catch{P.error("Unable to parse config, restoring to default"),A.configHasPendingChanges=!0}else A.configHasPendingChanges=!0;mn(A.config,()=>{A.configHasPendingChanges=!0})}const A={initialized:ve(!1),configHasPendingChanges:!1,config:ve(bn),sessions:ve([])};let nt=!1;class z{static async login(e,n){const l=await Xe.buildSession(e,n);if(!l.ok)return V(l.error);const o=l.value,i=pe(A.sessions).findIndex(a=>a.user.userId===e.sub);return i!==-1?A.sessions.update(a=>(a[i]=o,a)):(A.sessions.update(a=>(a.push(o),a)),A.config.update(a=>(a.selected.user_id=o.user.userId,a))),ge(o)}static async logout(e){const{sessions:n,config:l}=A;return n.update(o=>{const r=o.findIndex(i=>i.user.userId===e);return r>-1&&(_e.revokeOauthCreds(o[r].tokens.access_token),o.splice(r,1)),o}),l.update(o=>(typeof o.userDetails[e]<"u"&&delete o.userDetails[e],o.selected.user_id===e&&(o.selected.user_id=null),o)),pe(n)}static saveConfig(e=!0){if(nt||e&&!A.configHasPendingChanges)return;nt=!0;const n=new XMLHttpRequest;n.open("POST","/save-config",!0),n.onreadystatechange=()=>{n.readyState==4&&(P.info(`Save config status: '${n.responseText.trim()}'`),nt=!1)},n.setRequestHeader("Content-Type","application/json");const l=pe(A.config);return n.send(JSON.stringify(l)),l}static async saveCredentials(){new Promise(e=>{const n=new XMLHttpRequest;n.open("POST","/save-credentials",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=()=>{n.readyState==4&&e(void 0)};const l=pe(A.sessions);n.send(JSON.stringify(l))})}static async openFilePicker(){return new Promise(e=>{const n=new XMLHttpRequest;n.onreadystatechange=()=>{if(n.readyState==4)return n.status==200?e(n.responseText):e(void 0)},n.open("GET","/jar-file-picker",!0),n.send()})}static findSession(e){return pe(A.sessions).find(l=>l.user.userId===e)}static findAccount(e,n){return e.find(l=>l.accountId==n)}}const at=ve([]),st=ve(null);typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(gn);function wn(t){let e,n;const l=t[4].default,o=ze(l,t,t[3],null);return{c(){e=m("main"),o&&o.c(),h(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),ne(e,"dark",t[0])},m(r,i){y(r,e,i),o&&o.m(e,null),n=!0},p(r,[i]){o&&o.p&&(!n||i&8)&&Ye(o,l,r,r[3],n?Ve(l,r[3],i,null):Ze(r[3]),null),(!n||i&1)&&ne(e,"dark",r[0])},i(r){n||(D(o,r),n=!0)},o(r){F(o,r),n=!1},d(r){r&&w(e),o&&o.d(r)}}}function yn(t,e,n){let l,o,{$$slots:r={},$$scope:i}=e;const{config:a}=A;return ue(t,a,c=>n(2,o=c)),t.$$set=c=>{"$$scope"in c&&n(3,i=c.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&n(0,l=o.use_dark_theme)},[l,a,o,i,r]}class Wt extends ae{constructor(e){super(),ie(this,e,yn,wn,le,{})}}function vn(t){let e;return{c(){e=m("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',h(e,"class","flex h-full items-center justify-center")},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function $n(t){let e,n;return e=new Wt({props:{$$slots:{default:[vn]},$$scope:{ctx:t}}}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),n=!0},p(l,[o]){const r={};o&32&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){F(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Sn(t){const e=window.opener;C.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function n(i){const a=Ie.get("auth_verifier");if(!a)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:c,redirect:u}=C.env,d=await _e.getOAuthToken(C.env.origin,c,a,u,i);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function l(i){const a=Ie.get("auth_nonce"),c=_e.validateIdToken(i,a??"");if(!c.ok)return o(c.error),null;const u=await _e.getSessionId(C.env.auth_api,i);return u.ok?u.value:(o(`Unable to retreive session id. ${u.error}`),null)}function o(i){r({type:"authFailed",reason:i}),fetch("/close")}function r(i){e.postMessage(i,window.location.origin)}return Xt(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),c=i.get("state"),u=i.get("id_token");if(u==null&&a&&c){const d=await n(a);if(!d)return o("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();_e.navigateToAuthConsent(C.env.origin,d.id_token,f)}else if(u&&a&&c){const d=await l(u);if(!d)return o("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),on(()=>{Ie.remove("auth_verifier"),Ie.remove("auth_nonce")}),[]}class Ln extends ae{constructor(e){super(),ie(this,e,Sn,$n,le,{})}}function gt(t){let e,n,l;return{c(){e=m("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',h(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(o,r){y(o,e,r),n||(l=M(e,"click",t[2]),n=!0)},p:j,d(o){o&&w(e),n=!1,l()}}}function ht(t){let e;const n=t[7].default,l=ze(n,t,t[6],null);return{c(){l&&l.c()},m(o,r){l&&l.m(o,r),e=!0},p(o,r){l&&l.p&&(!e||r&64)&&Ye(l,n,o,o[6],e?Ve(n,o[6],r,null):Ze(o[6]),null)},i(o){e||(D(l,o),e=!0)},o(o){F(l,o),e=!1},d(o){l&&l.d(o)}}}function Cn(t){let e,n,l,o,r,i,a=t[1]&&gt(t),c=t[4]&&ht(t);return{c(){e=m("dialog"),a&&a.c(),n=R(),c&&c.c(),h(e,"class",l=t[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),ne(e,"backdrop:cursor-pointer",t[1])},m(u,d){y(u,e,d),a&&a.m(e,null),k(e,n),c&&c.m(e,null),t[8](e),o=!0,r||(i=[M(e,"keydown",t[9]),M(e,"mousedown",nn(t[10]))],r=!0)},p(u,[d]){u[1]?a?a.p(u,d):(a=gt(u),a.c(),a.m(e,n)):a&&(a.d(1),a=null),u[4]?c?(c.p(u,d),d&16&&D(c,1)):(c=ht(u),c.c(),D(c,1),c.m(e,null)):c&&(De(),F(c,1,1,()=>{c=null}),qe()),(!o||d&1&&l!==(l=u[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&h(e,"class",l),(!o||d&3)&&ne(e,"backdrop:cursor-pointer",u[1])},i(u){o||(D(c),o=!0)},o(u){F(c),o=!1},d(u){u&&w(e),a&&a.d(),c&&c.d(),t[8](null),r=!1,re(i)}}}function Rn(t,e,n){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,c=!1;const u=rn();function d(){a.showModal(),n(4,c=!0)}function f(){u("close"),a.close(),n(4,c=!1)}function _(v){he[v?"unshift":"push"](()=>{a=v,n(3,a)})}const g=v=>{v.key==="Escape"&&(v.preventDefault(),i&&f())},p=()=>{i&&f()};return t.$$set=v=>{"class"in v&&n(0,r=v.class),"canSelfClose"in v&&n(1,i=v.canSelfClose),"$$scope"in v&&n(6,o=v.$$scope)},[r,i,f,a,c,d,o,l,_,g,p]}class Qe extends ae{constructor(e){super(),ie(this,e,Rn,Cn,le,{class:0,canSelfClose:1,open:5,close:2})}get open(){return this.$$.ctx[5]}get close(){return this.$$.ctx[2]}}function Tn(t){let e,n,l,o,r,i,a;return{c(){e=m("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,n=R(),l=m("p"),l.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,o=R(),r=m("button"),r.textContent="I Understand",h(e,"class","p-2"),h(l,"class","p-2"),h(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(c,u){y(c,e,u),y(c,n,u),y(c,l,u),y(c,o,u),y(c,r,u),i||(a=M(r,"click",t[2]),i=!0)},p:j,d(c){c&&(w(e),w(n),w(l),w(o),w(r)),i=!1,a()}}}function Pn(t){let e,n,l={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[Tn]},$$scope:{ctx:t}};return e=new Qe({props:l}),t[3](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),n=!0},p(o,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){t[3](null),K(e,o)}}}function xn(t,e,n){let l;const{sessions:o}=A;ue(t,o,c=>n(4,l=c));let r;Xt(()=>{l.length==0&&r.open()});const i=()=>r.close();function a(c){he[c?"unshift":"push"](()=>{r=c,n(0,r)})}return[r,o,i,a]}class In extends ae{constructor(e){super(),ie(this,e,xn,Pn,le,{})}}function Hn(t,e,n){z.saveConfig();const l=(a,c)=>{const u=new XMLHttpRequest,d={},f=pe(A.config);a&&(d.hash=a),t&&(d.jx_session_id=t),e&&(d.jx_character_id=e),n&&(d.jx_display_name=n),f.rs_plugin_loader&&(d.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?d.config_uri=f.rs_config_uri:d.config_uri=C.env.default_config_uri,u.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(P.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&(a&&(C.rs3DebInstalledHash=a),f.close_after_launch&&!f.rs_plugin_loader&&fetch("/close")))},u.send(c)},o=new XMLHttpRequest,r=C.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");o.open("GET",i,!0),o.onreadystatechange=()=>{if(o.readyState==4&&o.status==200){const a=Object.fromEntries(o.response.split(`
`).map(c=>c.split(": ")));if(!a.Filename||!a.Size){P.error(`Could not parse package data from URL: ${i}`),l();return}if(a.SHA256!==C.rs3DebInstalledHash){P.info("Downloading RS3 client...");const c=new XMLHttpRequest;c.open("GET",r.concat(a.Filename),!0),c.responseType="arraybuffer",c.onprogress=u=>{if(u.loaded){const d=(Math.round(1e3*u.loaded/u.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading RS3 client... ${d}%`)}},c.onreadystatechange=()=>{c.readyState==4&&c.status==200&&l(a.SHA256,c.response)},c.onerror=()=>{P.error(`Error downloading game client: from ${i}: non-http error`),l()},c.send()}else P.info("Latest client is already installed"),l()}},o.onerror=()=>{P.error(`Error: from ${i}: non-http error`),l()},o.send()}function zt(t,e,n,l){z.saveConfig();const o=l?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=pe(A.config),i=(d,f,_)=>{const g=new XMLHttpRequest,p={};d&&(p.id=d),_&&(p.jar_path=_),t&&(p.jx_session_id=t),e&&(p.jx_character_id=e),n&&(p.jx_display_name=n),r.flatpak_rich_presence&&(p.flatpak_rich_presence=""),g.open(f?"POST":"GET",o.concat(new URLSearchParams(p).toString()),!0),g.onreadystatechange=()=>{g.readyState==4&&(P.info(`Game launch status: '${g.responseText.trim()}'`),g.status==200&&(d&&(C.runeLiteInstalledId=d),r.close_after_launch&&!l&&fetch("/close")))},g.send(f)};if(r.runelite_use_custom_jar){i(null,null,r.runelite_custom_jar);return}const a=2*60*1e3;if(C.runeLiteInstalledId!==null){const d=pe(st);if(d!==null&&d+a>Date.now()){i();return}}const c=new XMLHttpRequest;c.open("GET","https://api.github.com/repos/runelite/launcher/releases",!0),c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const d=JSON.parse(c.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");if(d.id!=C.runeLiteInstalledId){P.info("Downloading RuneLite...");const f=new XMLHttpRequest;f.open("GET",d.browser_download_url,!0),f.responseType="arraybuffer",f.onreadystatechange=()=>{f.readyState==4&&(f.status==200?(st.set(Date.now()),i(d.id,f.response)):P.error(`Error downloading from ${d.url}: ${f.status}: ${f.responseText}`))},f.onprogress=_=>{if(_.loaded&&_.lengthComputable){const g=(Math.round(1e3*_.loaded/_.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading RuneLite... ${g}%`)}},f.send()}else st.set(Date.now()),i()}else P.error(`Failed to check for RuneLite updates: ${c.status}: ${c.responseText}`),i()},c.send()}function On(t,e,n){z.saveConfig();const l=pe(A.config),o=(a,c)=>{const u=new XMLHttpRequest,d={};a&&(d.version=a),t&&(d.jx_session_id=t),e&&(d.jx_character_id=e),n&&(d.jx_display_name=n),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(d).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(P.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&(a&&(C.hdosInstalledVersion=a),l.close_after_launch&&fetch("/close")))},u.send(c)},r=new XMLHttpRequest,i="https://cdn.hdos.dev/client/getdown.txt";r.open("GET",i,!0),r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=r.responseText.match(/^launcher\.version *= *(.*?)$/m);if(a&&a.length>=2){const c=a[1];if(c!==C.hdosInstalledVersion){const u=`https://cdn.hdos.dev/launcher/v${c}/hdos-launcher.jar`;P.info("Downloading HDOS...");const d=new XMLHttpRequest;d.open("GET",u,!0),d.responseType="arraybuffer",d.onreadystatechange=()=>{if(d.readyState==4)if(d.status==200)o(c,d.response);else{const f=JSON.parse(r.responseText).map(_=>_.assets).flat().find(_=>_.name.toLowerCase()=="runelite.jar");P.error(`Error downloading from ${f.url}: ${d.status}: ${d.responseText}`)}},d.onprogress=f=>{if(f.loaded&&f.lengthComputable){const _=(Math.round(1e3*f.loaded/f.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading HDOS... ${_}%`)}},d.send()}else P.info("Latest JAR is already installed"),o()}else P.info("Couldn't parse latest launcher version"),o()}else P.error(`Error from ${i}: ${r.status}: ${r.responseText}`)},r.send()}function lt(){const t=new XMLHttpRequest;t.open("GET","/list-game-clients",!0),t.onreadystatechange=()=>{t.readyState==4&&t.status!=200&&P.error(`Error requesting client list: ${t.status}: ${t.responseText}`)},t.send()}function En(){const t=new XMLHttpRequest;t.open("POST","/save-plugin-config",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&P.info(`Save-plugin-config status: ${t.responseText.trim()}`)},t.send(JSON.stringify(C.pluginList))}async function mt(t,e,n,l,o){z.saveConfig();const r=`${e?"osrs":C.env.provider}-${t?"win":"mac"}`;let i=t?e?C.osrsExeInstalledHash:C.rs3ExeInstalledHash:e?C.osrsAppInstalledHash:C.rs3AppInstalledHash;const a=async(S,x)=>{const E={},q=pe(A.config);S&&(E.hash=S),n&&(E.jx_session_id=n),l&&(E.jx_character_id=l),o&&(E.jx_display_name=o),e||(q.rs_plugin_loader&&(E.plugin_loader="1"),E.config_uri=q.use_custom_rs_config_uri&&q.rs_config_uri?q.rs_config_uri:C.env.default_config_uri);const ce=await fetch(`/launch-${e?"osrs":"rs3"}-${t?"exe":"app"}?${new URLSearchParams(E).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:await x});ce.text().then(Q=>P.info(`Game launch status: '${Q.trim()}'`)),ce.status==200&&(S&&(i=S),q.close_after_launch&&(e||!q.rs_plugin_loader)&&fetch("/close"))},c=`${C.env.direct6_url}${r}/${r}.json`,u=await fetch(c,{method:"GET"}),d=await u.text();if(u.status!==200){P.error(`Error from ${c}: ${u.status}: ${d}`);return}const f=JSON.parse(atob(d.split(".")[1])).environments.production;if(i===f.id){P.info("Latest client is already installed"),a();return}P.info(`Downloading client version ${f.version}`);const _=`${C.env.direct6_url}${r}/catalog/${f.id}/catalog.json`,g=await fetch(_,{method:"GET"}),p=await g.text();if(g.status!==200){P.error(`Error from ${_}: ${g.status}: ${p}`);return}const v=JSON.parse(atob(p.split(".")[1])),b=S=>S.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:"),L=b(v.metafile),$=await fetch(L,{method:"GET"}),N=await $.text();if($.status!==200){P.error(`Error from ${L}: ${$.status}: ${N}`);return}const O=JSON.parse(atob(N.split(".")[1])),U=O.pieces.digests.map(S=>{const x=atob(S).split("").map(q=>q.charCodeAt(0).toString(16).padStart(2,"0")).join(""),E=b(v.config.remote.baseUrl).concat(v.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",x.substring(0,2)).replace("{TargetDigest}",x));return fetch(E,{method:"GET"}).then(q=>q.blob().then(ce=>{const Q=new DecompressionStream("gzip");return new Response(ce.slice(6).stream().pipeThrough(Q)).blob()}))});let B=0,T=null;for(let S=0;S<O.files.length;S+=1)if(t?O.files[S].name.endsWith(".exe"):O.files[S].name.includes(".app/Contents/MacOS/"))if(T!==null){P.error(`Error parsing ${L}: file list has multiple possibilities for main exe`);return}else T=O.files[S].size;else T===null&&(B+=O.files[S].size);if(T===null){P.error(`Error parsing ${L}: file list has no possibilities for main exe`);return}Promise.all(U).then(S=>{const x=new Blob(S).slice(B,B+T);a(O.id,x.arrayBuffer())})}function bt(t,e,n){const l=t.slice();return l[30]=e[n],l}function kt(t,e,n){const l=t.slice();return l[33]=e[n],l}function wt(t,e,n){const l=t.slice();return l[36]=e[n][0],l[29]=e[n][1],l}function yt(t,e,n){const l=t.slice();return l[30]=e[n],l}function Un(t){let e,n=oe(t[3]),l=[];for(let o=0;o<n.length;o+=1)l[o]=vt(yt(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=be()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);y(o,e,r)},p(o,r){if(r[0]&76){n=oe(o[3]);let i;for(i=0;i<n.length;i+=1){const a=yt(o,n,i);l[i]?l[i].p(a,r):(l[i]=vt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(o){o&&w(e),Le(l,o)}}}function Nn(t){let e;return{c(){e=m("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function vt(t){let e,n=(t[30].identity||Tt)+"",l,o,r,i,a,c;function u(){return t[17](t[30])}return{c(){e=m("button"),l=J(n),r=R(),i=m("br"),h(e,"class",o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[6]&&t[2]===t[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){y(d,e,f),k(e,l),y(d,r,f),y(d,i,f),a||(c=M(e,"click",u),a=!0)},p(d,f){t=d,f[0]&8&&n!==(n=(t[30].identity||Tt)+"")&&fe(l,n),f[0]&76&&o!==(o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[6]&&t[2]===t[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&h(e,"class",o)},d(d){d&&(w(e),w(r),w(i)),a=!1,c()}}}function Mn(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function jn(t){let e,n,l,o,r,i=oe(Object.entries(t[0].pluginList)),a=[];for(let f=0;f<i.length;f+=1)a[f]=$t(wt(t,i,f));function c(f,_){return f[6]?An:Dn}let u=c(t),d=u(t);return{c(){e=m("select");for(let f=0;f<a.length;f+=1)a[f].c();n=R(),d.c(),l=be(),h(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[1]===void 0&&Ee(()=>t[18].call(e))},m(f,_){y(f,e,_);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(e,null);$e(e,t[1],!0),y(f,n,_),d.m(f,_),y(f,l,_),o||(r=M(e,"change",t[18]),o=!0)},p(f,_){if(_[0]&1){i=oe(Object.entries(f[0].pluginList));let g;for(g=0;g<i.length;g+=1){const p=wt(f,i,g);a[g]?a[g].p(p,_):(a[g]=$t(p),a[g].c(),a[g].m(e,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=i.length}_[0]&3&&$e(e,f[1]),u===(u=c(f))&&d?d.p(f,_):(d.d(1),d=u(f),d&&(d.c(),d.m(l.parentNode,l)))},d(f){f&&(w(e),w(n),w(l)),Le(a,f),d.d(f),o=!1,r()}}}function $t(t){let e,n=(t[29].name??Ae)+"",l,o;return{c(){e=m("option"),l=J(n),h(e,"class","dark:bg-slate-900"),e.__value=o=t[36],de(e,e.__value)},m(r,i){y(r,e,i),k(e,l)},p(r,i){i[0]&1&&n!==(n=(r[29].name??Ae)+"")&&fe(l,n),i[0]&1&&o!==(o=r[36])&&(e.__value=o,de(e,e.__value))},d(r){r&&w(e)}}}function An(t){let e,n,l,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Yn,then:Bn,catch:qn,value:29};return Je(o=t[8],r),{c(){e=m("br"),n=R(),l=be(),r.block.c()},m(i,a){y(i,e,a),y(i,n,a),y(i,l,a),r.block.m(i,r.anchor=a),r.mount=()=>l.parentNode,r.anchor=l},p(i,a){t=i,r.ctx=t,a[0]&256&&o!==(o=t[8])&&Je(o,r)||Jt(r,t,a)},d(i){i&&(w(e),w(n),w(l)),r.block.d(i),r.token=null,r=null}}}function Dn(t){let e,n,l,o,r,i,a,c,u;function d(g,p){return p[0]&1&&(i=null),i==null&&(i=Object.entries(g[0].pluginList).length!==0),i?Kn:Zn}let f=d(t,[-1,-1]),_=f(t);return{c(){e=m("button"),n=J("+"),l=R(),o=m("br"),r=R(),_.c(),a=be(),h(e,"class","aspect-square w-8 rounded-lg border-2 border-blue-500 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:border-gray-500"),e.disabled=t[5]},m(g,p){y(g,e,p),k(e,n),y(g,l,p),y(g,o,p),y(g,r,p),_.m(g,p),y(g,a,p),c||(u=M(e,"click",t[11]),c=!0)},p(g,p){p[0]&32&&(e.disabled=g[5]),f===(f=d(g,p))&&_?_.p(g,p):(_.d(1),_=f(g),_&&(_.c(),_.m(a.parentNode,a)))},d(g){g&&(w(e),w(l),w(o),w(r),w(a)),_.d(g),c=!1,u()}}}function qn(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Bn(t){let e,n,l,o,r,i,a,c,u,d;function f(b,L){return L[0]&259&&(e=null),L[0]&1&&(n=null),e==null&&(e=!!(b[29]&&b[29].main&&Object.keys(b[0].pluginList).includes(b[1]))),e?Xn:(n==null&&(n=Object.entries(b[0].pluginList).length===0),n?Fn:Gn)}let _=f(t,[-1,-1]),g=_(t),p=oe(t[3]),v=[];for(let b=0;b<p.length;b+=1)v[b]=Ct(bt(t,p,b));return{c(){g.c(),l=R(),o=m("br"),r=R(),i=m("br"),a=R(),c=m("hr"),u=R();for(let b=0;b<v.length;b+=1)v[b].c();d=be(),h(c,"class","p-1 dark:border-slate-700")},m(b,L){g.m(b,L),y(b,l,L),y(b,o,L),y(b,r,L),y(b,i,L),y(b,a,L),y(b,c,L),y(b,u,L);for(let $=0;$<v.length;$+=1)v[$]&&v[$].m(b,L);y(b,d,L)},p(b,L){if(_===(_=f(b,L))&&g?g.p(b,L):(g.d(1),g=_(b),g&&(g.c(),g.m(l.parentNode,l))),L[0]&8205){p=oe(b[3]);let $;for($=0;$<p.length;$+=1){const N=bt(b,p,$);v[$]?v[$].p(N,L):(v[$]=Ct(N),v[$].c(),v[$].m(d.parentNode,d))}for(;$<v.length;$+=1)v[$].d(1);v.length=p.length}},d(b){b&&(w(l),w(o),w(r),w(i),w(a),w(c),w(u),w(d)),g.d(b),Le(v,b)}}}function Gn(t){let e;return{c(){e=m("p"),e.textContent="can't start plugin: does not appear to be configured"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Fn(t){let e;return{c(){e=m("p"),e.textContent="(no plugins installed)"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Xn(t){let e;function n(r,i){return r[9]?Wn:Jn}let l=n(t),o=l(t);return{c(){o.c(),e=be()},m(r,i){o.m(r,i),y(r,e,i)},p(r,i){l===(l=n(r))&&o?o.p(r,i):(o.d(1),o=l(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){r&&w(e),o.d(r)}}}function Jn(t){let e;return{c(){e=m("p"),e.textContent="can't start plugin: no path is configured"},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Wn(t){let e,n,l=t[29].name+"",o,r,i;function a(){return t[21](t[29])}return{c(){e=m("button"),n=J("Start "),o=J(l),h(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(c,u){y(c,e,u),k(e,n),k(e,o),r||(i=M(e,"click",a),r=!0)},p(c,u){t=c,u[0]&256&&l!==(l=t[29].name+"")&&fe(o,l)},d(c){c&&w(e),r=!1,i()}}}function St(t){let e,n=oe(t[30].plugins),l=[];for(let o=0;o<n.length;o+=1)l[o]=Lt(kt(t,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=be()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);y(o,e,r)},p(o,r){if(r[0]&8205){n=oe(o[30].plugins);let i;for(i=0;i<n.length;i+=1){const a=kt(o,n,i);l[i]?l[i].p(a,r):(l[i]=Lt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(o){o&&w(e),Le(l,o)}}}function zn(t){let e,n=t[33].id+"",l;return{c(){e=m("p"),l=J(n)},m(o,r){y(o,e,r),k(e,l)},p(o,r){r[0]&8&&n!==(n=o[33].id+"")&&fe(l,n)},d(o){o&&w(e)}}}function Vn(t){let e,n=(t[0].pluginList[t[33].id].name??t[33].id)+"",l,o,r,i,a,c;function u(){return t[22](t[33])}return{c(){e=m("p"),l=J(n),o=R(),r=m("button"),r.innerHTML='<img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/>',i=R(),h(r,"class","rounded-sm bg-rose-500 shadow-lg hover:opacity-75")},m(d,f){y(d,e,f),k(e,l),k(e,o),k(e,r),k(e,i),a||(c=M(r,"click",u),a=!0)},p(d,f){t=d,f[0]&9&&n!==(n=(t[0].pluginList[t[33].id].name??t[33].id)+"")&&fe(l,n)},d(d){d&&w(e),a=!1,c()}}}function Lt(t){let e,n;function l(i,a){return a[0]&9&&(e=null),e==null&&(e=!!Object.keys(i[0].pluginList).includes(i[33].id)),e?Vn:zn}let o=l(t,[-1,-1]),r=o(t);return{c(){r.c(),n=be()},m(i,a){r.m(i,a),y(i,n,a)},p(i,a){o===(o=l(i,a))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(n.parentNode,n)))},d(i){i&&w(n),r.d(i)}}}function Ct(t){let e,n=t[30].uid===t[2]&&St(t);return{c(){n&&n.c(),e=be()},m(l,o){n&&n.m(l,o),y(l,e,o)},p(l,o){l[30].uid===l[2]?n?n.p(l,o):(n=St(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(l){l&&w(e),n&&n.d(l)}}}function Yn(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Zn(t){let e;return{c(){e=m("p"),e.textContent=`You have no plugins installed. Click the + button and select a plugin's bolt.json file
						to add it.`},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function Kn(t){let e=Object.keys(t[0].pluginList).includes(t[1])&&t[8]!==null,n,l=e&&Rt(t);return{c(){l&&l.c(),n=be()},m(o,r){l&&l.m(o,r),y(o,n,r)},p(o,r){r[0]&259&&(e=Object.keys(o[0].pluginList).includes(o[1])&&o[8]!==null),e?l?l.p(o,r):(l=Rt(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&w(n),l&&l.d(o)}}}function Rt(t){let e,n,l,o,r,i,a,c={ctx:t,current:null,token:null,hasCatch:!0,pending:ts,then:es,catch:Qn,value:29};return Je(e=t[8],c),{c(){c.block.c(),n=R(),l=m("button"),l.textContent="Remove",o=R(),r=m("button"),r.textContent="Reload",h(l,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500"),h(r,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(u,d){c.block.m(u,c.anchor=d),c.mount=()=>n.parentNode,c.anchor=n,y(u,n,d),y(u,l,d),y(u,o,d),y(u,r,d),i||(a=[M(l,"click",t[19]),M(r,"click",t[20])],i=!0)},p(u,d){t=u,c.ctx=t,d[0]&256&&e!==(e=t[8])&&Je(e,c)||Jt(c,t,d)},d(u){u&&(w(n),w(l),w(o),w(r)),c.block.d(u),c.token=null,c=null,i=!1,re(a)}}}function Qn(t){let e,n,l;return{c(){e=m("p"),e.textContent="error",n=R(),l=m("br")},m(o,r){y(o,e,r),y(o,n,r),y(o,l,r)},p:j,d(o){o&&(w(e),w(n),w(l))}}}function es(t){let e,n=(t[29].name??Ae)+"",l,o,r,i=(t[29].description??"no description")+"",a,c,u,d;return{c(){e=m("p"),l=J(n),o=R(),r=m("p"),a=J(i),u=R(),d=m("br"),h(e,"class","pb-4 text-xl font-bold"),h(r,"class",c=t[29].description?null:"italic")},m(f,_){y(f,e,_),k(e,l),y(f,o,_),y(f,r,_),k(r,a),y(f,u,_),y(f,d,_)},p(f,_){_[0]&256&&n!==(n=(f[29].name??Ae)+"")&&fe(l,n),_[0]&256&&i!==(i=(f[29].description??"no description")+"")&&fe(a,i),_[0]&256&&c!==(c=f[29].description?null:"italic")&&h(r,"class",c)},d(f){f&&(w(e),w(o),w(r),w(u),w(d))}}}function ts(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function ns(t){let e,n,l,o,r,i,a,c,u,d,f;function _($,N){return $[3].length==0?Nn:Un}let g=_(t),p=g(t);function v($,N){return $[0].hasBoltPlugins?jn:Mn}let b=v(t),L=b(t);return{c(){e=m("div"),n=m("button"),l=J("Manage Plugins"),r=R(),i=m("hr"),a=R(),p.c(),c=R(),u=m("div"),L.c(),h(n,"class",o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(t[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),h(i,"class","p-1 dark:border-slate-700"),h(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),h(u,"class","h-full pt-10")},m($,N){y($,e,N),k(e,n),k(n,l),k(e,r),k(e,i),k(e,a),p.m(e,null),y($,c,N),y($,u,N),L.m(u,null),d||(f=M(n,"click",t[16]),d=!0)},p($,N){N[0]&64&&o!==(o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+($[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&h(n,"class",o),g===(g=_($))&&p?p.p($,N):(p.d(1),p=g($),p&&(p.c(),p.m(e,null))),b===(b=v($))&&L?L.p($,N):(L.d(1),L=b($),L&&(L.c(),L.m(u,null)))},d($){$&&(w(e),w(c),w(u)),p.d(),L.d(),d=!1,f()}}}function ss(t){let e,n,l={class:"h-[90%] w-[90%] text-center",$$slots:{default:[ns]},$$scope:{ctx:t}};return e=new Qe({props:l}),t[23](e),e.$on("close",t[24]),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),n=!0},p(o,r){const i={};r[0]&1007|r[1]&1024&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){t[23](null),K(e,o)}}}const ot="bolt.json",ls="main.lua",Ae="(unnamed)",Tt="(new character)";function os(t,e,n){let l,o,r,i;ue(t,at,I=>n(3,i=I));let a;const c=C.platform==="windows"?"\\":"/",u=c.concat(ot);function d(){a.open()}const f=I=>new Promise((W,G)=>{const H=I.concat(I.endsWith(c)?ot:u);var X=new XMLHttpRequest;X.onreadystatechange=()=>{X.readyState==4&&(X.status==200?W(JSON.parse(X.responseText)):G(X.responseText))},X.open("GET","/read-json-file?".concat(new URLSearchParams({path:H}).toString()),!0),X.send()}),_=I=>{const G=C.pluginList[I];if(!G)return null;const H=G.path;return H?f(H):null},g=(I,W)=>{f(I).then(G=>{do n(1,$=crypto.randomUUID());while(Object.keys(C.pluginList).includes($));n(0,C.pluginList[$]={name:G.name??Ae,path:I},C),n(7,U=!0)}).catch(G=>{console.error(`Config file '${W}' couldn't be fetched, reason: ${G}`)})};let p=!1;const v=()=>{n(5,p=!0);var I=new XMLHttpRequest;I.onreadystatechange=()=>{if(I.readyState==4&&(n(5,p=!1),I.status==200))if(I.responseText.endsWith(u)){const W=I.responseText.substring(0,I.responseText.length-ot.length);g(W,I.responseText)}else console.log(`Selection '${I.responseText}' is not named bolt.json; ignored`)},I.open("GET","/json-file-picker",!0),I.send()};lt();const b=(I,W,G,H)=>{const X=C.platform==="windows"?G.replaceAll("\\","/"):G,we=X.endsWith(c)?X:X.concat("/");var ee=new XMLHttpRequest;ee.onreadystatechange=()=>{ee.readyState==4&&(lt(),P.info(`Start-plugin status: ${ee.statusText.trim()}`))},ee.open("GET","/start-plugin?".concat(new URLSearchParams({client:I.toString(),id:W,path:we,main:H}).toString()),!0),ee.send()},L=(I,W)=>{var G=new XMLHttpRequest;G.onreadystatechange=()=>{G.readyState==4&&(lt(),P.info(`Stop-plugin status: ${G.statusText.trim()}`))},G.open("GET","/stop-plugin?".concat(new URLSearchParams({client:I.toString(),uid:W.toString()}).toString()),!0),G.send()};var $,N=!1,O;let U=!1;const B=()=>n(6,N=!1),T=I=>{n(2,O=I.uid),n(6,N=!0)};function S(){$=ct(this),n(1,$),n(0,C)}const x=()=>{n(8,r=null),n(7,U=!0);let I=C.pluginList;delete I[$],n(0,C.pluginList=I,C)},E=()=>n(8,r=_($)),q=I=>b(O,$,o,I.main??ls),ce=I=>{L(O,I.uid)};function Q(I){he[I?"unshift":"push"](()=>{a=I,n(4,a)})}const Y=()=>{U&&En()};return t.$$.update=()=>{t.$$.dirty[0]&12&&(i.some(I=>I.uid===O)||n(6,N=!1)),t.$$.dirty[0]&3&&n(15,l=C.pluginList[$]),t.$$.dirty[0]&32768&&n(9,o=l?l.path:null),t.$$.dirty[0]&2&&n(8,r=_($))},[C,$,O,i,a,p,N,U,r,o,_,v,b,L,d,l,B,T,S,x,E,q,ce,Q,Y]}class rs extends ae{constructor(e){super(),ie(this,e,os,ss,le,{open:14},null,[-1,-1])}get open(){return this.$$.ctx[14]}}function is(t){let e,n,l,o,r,i,a,c,u,d,f,_,g;return{c(){e=m("div"),n=m("h2"),n.textContent="Game is offline",l=R(),o=m("br"),r=R(),i=m("p"),i.textContent="This game appears to be offline for maintenance or an update. Launch anyway?",a=R(),c=m("div"),u=m("button"),u.textContent="No",d=R(),f=m("button"),f.textContent="Yes",h(n,"class","text-3xl font-extrabold"),h(u,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(f,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(c,"class","align-bottom")},m(p,v){y(p,e,v),k(e,n),k(e,l),k(e,o),k(e,r),k(e,i),k(e,a),k(e,c),k(c,u),k(c,d),k(c,f),_||(g=[M(u,"click",t[5]),M(f,"click",t[6])],_=!0)},p:j,d(p){p&&w(e),_=!1,re(g)}}}function as(t){let e,n,l={class:"h-fit w-3/5 px-5 py-3 text-center",$$slots:{default:[is]},$$scope:{ctx:t}};return e=new Qe({props:l}),t[7](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),n=!0},p(o,[r]){const i={};r&271&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){t[7](null),K(e,o)}}}function cs(t,e,n){let l,o,r,i;function a(f,_,g){n(3,i=f),n(1,o=_),n(2,r=g),l.open()}const c=()=>{l.close()},u=()=>{i(o,r),l.close()};function d(f){he[f?"unshift":"push"](()=>{l=f,n(0,l)})}return[l,o,r,i,a,c,u,d]}class us extends ae{constructor(e){super(),ie(this,e,cs,as,le,{open:4})}get open(){return this.$$.ctx[4]}}function Pt(t,e,n){const l=t.slice();return l[20]=e[n],l}function xt(t,e,n){const l=t.slice();return l[23]=e[n],l}function ds(t){let e,n,l={};return e=new rs({props:l}),t[16](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),n=!0},p(o,r){const i={};e.$set(i)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){t[16](null),K(e,o)}}}function It(t){let e,n;return{c(){e=m("div"),n=J(t[7]),h(e,"class","absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black")},m(l,o){y(l,e,o),k(e,n)},p(l,o){o&128&&fe(n,l[7])},d(l){l&&w(e)}}}function fs(t){let e,n,l;return{c(){e=m("button"),e.textContent="Plugin menu",e.disabled=!C.hasBoltPlugins,h(e,"title",C.hasBoltPlugins?null:"Coming soon..."),h(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(o,r){y(o,e,r),n||(l=M(e,"click",t[19]),n=!0)},p:j,d(o){o&&w(e),n=!1,l()}}}function ps(t){let e,n,l,o,r,i,a=oe(ft[t[1].selected.game]),c=[];for(let u=0;u<a.length;u+=1)c[u]=Ht(xt(t,a,u));return{c(){e=m("label"),n=m("span"),n.textContent="Game Client",l=R(),o=m("select");for(let u=0;u<c.length;u+=1)c[u].c();h(n,"class","text-sm"),h(o,"id","game_client_select"),h(o,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[1].selected.client===void 0&&Ee(()=>t[18].call(o)),h(e,"class","flex flex-col")},m(u,d){y(u,e,d),k(e,n),k(e,l),k(e,o);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(o,null);$e(o,t[1].selected.client,!0),r||(i=M(o,"change",t[18]),r=!0)},p(u,d){if(d&2){a=oe(ft[u[1].selected.game]);let f;for(f=0;f<a.length;f+=1){const _=xt(u,a,f);c[f]?c[f].p(_,d):(c[f]=Ht(_),c[f].c(),c[f].m(o,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=a.length}d&2&&$e(o,u[1].selected.client)},d(u){u&&w(e),Le(c,u),r=!1,i()}}}function Ht(t){let e,n=t[23]+"",l,o,r;return{c(){e=m("option"),l=J(n),h(e,"class","dark:bg-slate-900"),e.disabled=o=t[23]===ye.official&&C.platform==Me.Linux,e.__value=r=t[23],de(e,e.__value)},m(i,a){y(i,e,a),k(e,l)},p(i,a){a&2&&n!==(n=i[23]+"")&&fe(l,n),a&2&&o!==(o=i[23]===ye.official&&C.platform==Me.Linux)&&(e.disabled=o),a&2&&r!==(r=i[23])&&(e.__value=r,de(e,e.__value))},d(i){i&&w(e)}}}function Ot(t){let e;return{c(){e=m("option"),e.textContent="No characters",h(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",de(e,e.__value)},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function _s(t){let e;return{c(){e=J("New Character")},m(n,l){y(n,e,l)},p:j,d(n){n&&w(e)}}}function gs(t){let e=t[20].displayName+"",n;return{c(){n=J(e)},m(l,o){y(l,n,o)},p(l,o){o&32&&e!==(e=l[20].displayName+"")&&fe(n,e)},d(l){l&&w(n)}}}function Et(t){let e,n,l;function o(a,c){return a[20].displayName?gs:_s}let r=o(t),i=r(t);return{c(){e=m("option"),i.c(),n=R(),e.__value=l=t[20].accountId,de(e,e.__value),h(e,"class","dark:bg-slate-900")},m(a,c){y(a,e,c),i.m(e,null),k(e,n)},p(a,c){r===(r=o(a))&&i?i.p(a,c):(i.d(1),i=r(a),i&&(i.c(),i.m(e,n))),c&32&&l!==(l=a[20].accountId)&&(e.__value=l,de(e,e.__value))},d(a){a&&w(e),i.d()}}}function hs(t){let e,n,l,o,r,i,a,c,u,d,f,_,g,p,v,b,L,$,N,O,U,B,T,S,x={};e=new us({props:x}),t[15](e);let E=C.hasBoltPlugins&&ds(t),q=t[7]&&It(t);function ce(H,X){if(H[1].selected.game==te.osrs)return ps;if(H[1].selected.game===te.rs3)return fs}let Q=ce(t),Y=Q&&Q(t),I=oe(t[5]),W=[];for(let H=0;H<I.length;H+=1)W[H]=Et(Pt(t,I,H));let G=null;return I.length||(G=Ot()),{c(){se(e.$$.fragment),n=R(),E&&E.c(),l=R(),o=m("div"),q&&q.c(),r=R(),i=m("div"),a=m("img"),u=R(),d=m("button"),f=J("Play"),g=R(),Y&&Y.c(),p=R(),v=m("label"),b=m("span"),b.textContent="Character",L=R(),$=m("select"),N=m("option"),O=J("Select an account");for(let H=0;H<W.length;H+=1)W[H].c();G&&G.c(),Qt(a.src,c="svgs/rocket-solid.svg")||h(a,"src",c),h(a,"alt","Launch icon"),h(a,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),h(d,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),d.disabled=_=!t[8],h(b,"class","text-sm"),N.__value=void 0,de(N,N.__value),N.disabled=!0,h(N,"class","dark:bg-slate-900"),h($,"id","character_select"),h($,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),$.disabled=U=!t[8]||t[1].selected.user_id===null,h(v,"class","flex flex-col"),h(i,"class","flex flex-col items-center gap-4"),h(o,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(H,X){Z(e,H,X),y(H,n,X),E&&E.m(H,X),y(H,l,X),y(H,o,X),q&&q.m(o,null),k(o,r),k(o,i),k(i,a),k(i,u),k(i,d),k(d,f),k(i,g),Y&&Y.m(i,null),k(i,p),k(i,v),k(v,b),k(v,L),k(v,$),k($,N),k(N,O);for(let we=0;we<W.length;we+=1)W[we]&&W[we].m($,null);G&&G.m($,null),$e($,t[4]),B=!0,T||(S=[M(d,"click",t[17]),M($,"change",t[13])],T=!0)},p(H,[X]){const we={};if(e.$set(we),C.hasBoltPlugins&&E.p(H,X),H[7]?q?q.p(H,X):(q=It(H),q.c(),q.m(o,r)):q&&(q.d(1),q=null),(!B||X&256&&_!==(_=!H[8]))&&(d.disabled=_),Q===(Q=ce(H))&&Y?Y.p(H,X):(Y&&Y.d(1),Y=Q&&Q(H),Y&&(Y.c(),Y.m(i,p))),X&32){I=oe(H[5]);let ee;for(ee=0;ee<I.length;ee+=1){const dt=Pt(H,I,ee);W[ee]?W[ee].p(dt,X):(W[ee]=Et(dt),W[ee].c(),W[ee].m($,null))}for(;ee<W.length;ee+=1)W[ee].d(1);W.length=I.length,!I.length&&G?G.p(H,X):I.length?G&&(G.d(1),G=null):(G=Ot(),G.c(),G.m($,null))}(!B||X&258&&U!==(U=!H[8]||H[1].selected.user_id===null))&&($.disabled=U),(!B||X&48)&&$e($,H[4])},i(H){B||(D(e.$$.fragment,H),D(E),B=!0)},o(H){F(e.$$.fragment,H),F(E),B=!1},d(H){H&&(w(n),w(l),w(o)),t[15](null),K(e,H),E&&E.d(H),q&&q.d(),Y&&Y.d(),Le(W,H),G&&G.d(),T=!1,re(S)}}}function ms(t,e,n){let l,o,r,i,a,c,u,d,f,{config:_,initialized:g}=A;ue(t,_,T=>n(1,i=T)),ue(t,g,T=>n(8,u=T));let p=ve(null);ue(t,p,T=>n(7,c=T));let v=ve(!0);ue(t,v,T=>n(6,a=T));function b(T,S){if(!l)return P.warn("Please log in or select a user to play.");if(!o)return P.warn("Please select a character from the select menu.");const x=z.findSession(i.selected.user_id);if(!x)return P.warn("Unable to launch game, session was not found.");const{session_id:E}=x,q=z.findAccount(x.accounts,o);if(!q)return P.warn("Unable to launch game, account was not found.");const{accountId:ce,displayName:Q}=q,Y=C.platform===Me.Windows,I=C.platform===Me.Linux;switch(T){case te.osrs:switch(S){case ye.official:mt(Y,!0,E,ce,Q);break;case ye.runelite:zt(E,ce,Q,!1);break;case ye.hdos:On(E,ce,Q);break}break;case te.rs3:I?Hn(E,ce,Q):mt(Y,!1,E,ce,Q);break}}function L(T){const S=T.target.value;if(!l)return;const x=i.userDetails[l];x?(x.account_id=S,me(_,i.userDetails[l]=x,i)):me(_,i.userDetails[l]={account_id:S},i)}function $(T){he[T?"unshift":"push"](()=>{d=T,n(2,d)})}function N(T){he[T?"unshift":"push"](()=>{f=T,n(3,f)})}const O=()=>{a?b(i.selected.game,i.selected.client):d.open(b,i.selected.game,i.selected.client)};function U(){i.selected.client=ct(this),_.set(i)}const B=()=>{f.open()};return t.$$.update=()=>{var T,S;if(t.$$.dirty&2&&n(14,l=i.selected.user_id),t.$$.dirty&16386&&n(4,o=(T=i.userDetails[l??""])==null?void 0:T.account_id),t.$$.dirty&2&&n(5,r=((S=z.findSession(i.selected.user_id))==null?void 0:S.accounts)??[]),t.$$.dirty&2)if(i.check_announcements){const x=`${C.env.psa_url}${i.selected.game==te.osrs?"osrs":C.env.provider}.json`;fetch(x,{method:"GET"}).then(E=>E.json()).then(E=>{me(p,c=E.psa&&E.psa.length>0?E.psa:null,c),me(v,a=!(E.isDisabled??!1),a)})}else me(p,c=null,c),me(v,a=!0,a)},[b,i,d,f,o,r,a,c,u,_,g,p,v,L,l,$,N,O,U,B]}class bs extends ae{constructor(e){super(),ie(this,e,ms,hs,le,{launch:0})}get launch(){return this.$$.ctx[0]}}function Ut(t,e,n){const l=t.slice();return l[1]=e[n].date,l[2]=e[n].severity,l[3]=e[n].content,l}function Nt(t){var c;let e,n=((c=t[1])==null?void 0:c.toLocaleTimeString())+"",l,o,r=t[3]+"",i,a;return{c(){e=m("li"),l=J(n),o=J(`
				- `),i=J(r),a=R(),ne(e,"text-rose-500",t[2]===Ne.error),ne(e,"text-orange-700",t[2]===Ne.warn)},m(u,d){y(u,e,d),k(e,l),k(e,o),k(e,i),k(e,a)},p(u,d){var f;d&1&&n!==(n=((f=u[1])==null?void 0:f.toLocaleTimeString())+"")&&fe(l,n),d&1&&r!==(r=u[3]+"")&&fe(i,r),d&1&&ne(e,"text-rose-500",u[2]===Ne.error),d&1&&ne(e,"text-orange-700",u[2]===Ne.warn)},d(u){u&&w(e)}}}function ks(t){let e,n,l,o,r=oe(t[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=Nt(Ut(t,r,a));return{c(){e=m("div"),n=m("div"),n.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',l=R(),o=m("ol");for(let a=0;a<i.length;a+=1)i[a].c();h(n,"class","absolute right-6 top-2"),h(o,"id","message_list"),h(o,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),h(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,c){y(a,e,c),k(e,n),k(e,l),k(e,o);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(o,null)},p(a,[c]){if(c&1){r=oe(a[0]);let u;for(u=0;u<r.length;u+=1){const d=Ut(a,r,u);i[u]?i[u].p(d,c):(i[u]=Nt(d),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},i:j,o:j,d(a){a&&w(e),Le(i,a)}}}function ws(t,e,n){let{logs:l}=e;return t.$$set=o=>{"logs"in o&&n(0,l=o.logs)},[l]}class ys extends ae{constructor(e){super(),ie(this,e,ws,ks,le,{logs:0})}}function Mt(t,e,n){const l=t.slice();return l[7]=e[n],l}function jt(t,e){let n,l=e[7].user.displayName+"",o,r;return{key:t,first:null,c(){n=m("option"),o=J(l),n.__value=r=e[7].user.userId,de(n,n.__value),h(n,"class","dark:bg-slate-900"),this.first=n},m(i,a){y(i,n,a),k(n,o)},p(i,a){e=i,a&2&&l!==(l=e[7].user.displayName+"")&&fe(o,l),a&2&&r!==(r=e[7].user.userId)&&(n.__value=r,de(n,n.__value))},d(i){i&&w(n)}}}function vs(t){let e,n,l=[],o=new Map,r,i,a,c,u,d,f,_,g,p=oe(t[1]);const v=b=>b[7].user.userId;for(let b=0;b<p.length;b+=1){let L=Mt(t,p,b),$=v(L);o.set($,l[b]=jt($,L))}return{c(){e=m("select"),n=m("option"),n.textContent="Select a user";for(let b=0;b<l.length;b+=1)l[b].c();r=R(),i=m("div"),a=m("button"),a.textContent="Log In",c=R(),u=m("button"),d=J("Log Out"),n.__value=null,de(n,n.__value),n.disabled=!0,h(n,"class","dark:bg-slate-900"),h(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),t[0].selected.user_id===void 0&&Ee(()=>t[4].call(e)),h(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(u,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),u.disabled=f=!t[0].selected.user_id,h(i,"class","mt-5 flex")},m(b,L){y(b,e,L),k(e,n);for(let $=0;$<l.length;$+=1)l[$]&&l[$].m(e,null);$e(e,t[0].selected.user_id,!0),y(b,r,L),y(b,i,L),k(i,a),k(i,c),k(i,u),k(u,d),_||(g=[M(e,"change",t[4]),M(a,"click",t[5]),M(u,"click",t[6])],_=!0)},p(b,[L]){L&2&&(p=oe(b[1]),l=pn(l,L,v,1,b,p,o,e,fn,jt,null,Mt)),L&3&&$e(e,b[0].selected.user_id),L&3&&f!==(f=!b[0].selected.user_id)&&(u.disabled=f)},i:j,o:j,d(b){b&&(w(e),w(r),w(i));for(let L=0;L<l.length;L+=1)l[L].d();_=!1,re(g)}}}function $s(t,e,n){let l,o;const{sessions:r,config:i}=A;ue(t,r,d=>n(1,o=d)),ue(t,i,d=>n(0,l=d));function a(){l.selected.user_id=ct(this),i.set(l)}return[l,o,r,i,a,()=>{const{origin:d,redirect:f,clientid:_}=C.env;_e.openLoginWindow(d,f,_)},async()=>{l.selected.user_id&&(await z.logout(l.selected.user_id),z.saveCredentials())}]}class Ss extends ae{constructor(e){super(),ie(this,e,$s,vs,le,{})}}function Ls(t,{callback:e,ignore:n=[]}){const l=o=>{const r=n.some(i=>i.contains(o.target));t&&!t.contains(o.target)&&!o.defaultPrevented&&!r&&e()};return document.addEventListener("click",l,!0),document.addEventListener("contextmenu",l,!0),{destroy(){document.removeEventListener("click",l,!0),document.removeEventListener("contextmenu",l,!0)}}}const Cs=t=>({}),At=t=>({});function Dt(t){let e,n,l,o,r,i;const a=t[9].content,c=ze(a,t,t[8],At);return{c(){e=m("div"),c&&c.c(),h(e,"class",n="dropdown-color absolute z-20 rounded-lg border-2 "+t[1]+" "+t[2]+" svelte-xifudk")},m(u,d){y(u,e,d),c&&c.m(e,null),o=!0,r||(i=tn(l=Ls.call(null,e,{callback:t[3],ignore:[t[5]]})),r=!0)},p(u,d){c&&c.p&&(!o||d&256)&&Ye(c,a,u,u[8],o?Ve(a,u[8],d,Cs):Ze(u[8]),At),(!o||d&6&&n!==(n="dropdown-color absolute z-20 rounded-lg border-2 "+u[1]+" "+u[2]+" svelte-xifudk"))&&h(e,"class",n),l&&We(l.update)&&d&32&&l.update.call(null,{callback:u[3],ignore:[u[5]]})},i(u){o||(D(c,u),o=!0)},o(u){F(c,u),o=!1},d(u){u&&w(e),c&&c.d(u),r=!1,i()}}}function Rs(t){let e,n,l,o,r,i,a;const c=t[9].default,u=ze(c,t,t[8],null);let d=t[4]&&Dt(t);return{c(){e=m("div"),n=m("button"),u&&u.c(),l=R(),d&&d.c(),h(e,"class",o="relative h-fit w-fit "+t[0]+" svelte-xifudk")},m(f,_){y(f,e,_),k(e,n),u&&u.m(n,null),t[10](n),k(e,l),d&&d.m(e,null),r=!0,i||(a=M(n,"click",t[6]),i=!0)},p(f,[_]){u&&u.p&&(!r||_&256)&&Ye(u,c,f,f[8],r?Ve(c,f[8],_,null):Ze(f[8]),null),f[4]?d?(d.p(f,_),_&16&&D(d,1)):(d=Dt(f),d.c(),D(d,1),d.m(e,null)):d&&(De(),F(d,1,1,()=>{d=null}),qe()),(!r||_&1&&o!==(o="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&h(e,"class",o)},i(f){r||(D(u,f),D(d),r=!0)},o(f){F(u,f),F(d),r=!1},d(f){f&&w(e),u&&u.d(f),t[10](null),d&&d.d(),i=!1,a()}}}function Ts(t,e,n){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,c=!1,u;function d(){n(4,c=!0)}function f(){n(4,c=!1)}function _(){c?f():d()}function g(p){he[p?"unshift":"push"](()=>{u=p,n(5,u)})}return t.$$set=p=>{"class"in p&&n(0,r=p.class),"position"in p&&n(1,i=p.position),"align"in p&&n(2,a=p.align),"$$scope"in p&&n(8,o=p.$$scope)},[r,i,a,f,c,u,_,d,o,l,g]}class Ps extends ae{constructor(e){super(),ie(this,e,Ts,Rs,le,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function xs(t){let e,n,l,o,r,i,a,c,u,d,f,_,g;return{c(){e=m("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,n=R(),l=m("div"),o=m("label"),o.textContent="Check game announcements:",r=R(),i=m("input"),a=R(),c=m("div"),u=m("label"),u.textContent="Close Bolt after launching a game:",d=R(),f=m("input"),h(e,"id","data_dir_button"),h(e,"class","p-2 hover:opacity-75"),h(o,"for","check_announcements"),h(i,"id","check_announcements"),h(i,"type","checkbox"),h(i,"class","ml-2"),h(l,"class","mx-auto p-2"),h(u,"for","close_after_launch"),h(f,"id","close_after_launch"),h(f,"type","checkbox"),h(f,"class","ml-2"),h(c,"class","mx-auto p-2")},m(p,v){y(p,e,v),y(p,n,v),y(p,l,v),k(l,o),k(l,r),k(l,i),i.checked=t[0].check_announcements,y(p,a,v),y(p,c,v),k(c,u),k(c,d),k(c,f),f.checked=t[0].close_after_launch,_||(g=[M(e,"click",t[3]),M(i,"change",t[4]),M(f,"change",t[5])],_=!0)},p(p,[v]){v&1&&(i.checked=p[0].check_announcements),v&1&&(f.checked=p[0].close_after_launch)},i:j,o:j,d(p){p&&(w(e),w(n),w(l),w(a),w(c)),_=!1,re(g)}}}function Is(t,e,n){let l;function o(){var u=new XMLHttpRequest;u.open("GET","/browse-data"),u.onreadystatechange=()=>{u.readyState==4&&P.info(`Browse status: '${u.responseText.trim()}'`)},u.send()}const{config:r}=A;ue(t,r,u=>n(0,l=u));const i=()=>{o()};function a(){l.check_announcements=this.checked,r.set(l)}function c(){l.close_after_launch=this.checked,r.set(l)}return[l,o,r,i,a,c]}class Hs extends ae{constructor(e){super(),ie(this,e,Is,xs,le,{})}}function Os(t){let e,n,l,o,r,i,a,c,u,d,f,_,g,p,v,b,L,$,N;return{c(){var O,U;e=m("button"),n=m("div"),n.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,o=R(),r=m("div"),i=m("label"),i.textContent="Use custom RuneLite JAR:",a=R(),c=m("input"),u=R(),d=m("div"),f=m("textarea"),g=R(),p=m("br"),v=R(),b=m("button"),L=J("Select File"),h(n,"class","flex"),e.disabled=l=!((O=t[0])!=null&&O.session_id)||!((U=t[3])!=null&&U.accountId),h(e,"class","p-2 pb-5 hover:opacity-75"),h(i,"for","use_custom_jar"),h(c,"id","use_custom_jar"),h(c,"type","checkbox"),h(c,"class","ml-2"),h(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),h(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=_=!t[1].runelite_use_custom_jar,h(b,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),b.disabled=t[2],h(d,"class","mx-auto p-2"),ne(d,"opacity-25",!t[1].runelite_use_custom_jar)},m(O,U){y(O,e,U),k(e,n),y(O,o,U),y(O,r,U),k(r,i),k(r,a),k(r,c),c.checked=t[1].runelite_use_custom_jar,y(O,u,U),y(O,d,U),k(d,f),de(f,t[1].runelite_custom_jar),k(d,g),k(d,p),k(d,v),k(d,b),k(b,L),$||(N=[M(e,"click",t[7]),M(c,"change",t[8]),M(f,"input",t[9]),M(b,"click",t[10])],$=!0)},p(O,[U]){var B,T;U&9&&l!==(l=!((B=O[0])!=null&&B.session_id)||!((T=O[3])!=null&&T.accountId))&&(e.disabled=l),U&2&&(c.checked=O[1].runelite_use_custom_jar),U&2&&_!==(_=!O[1].runelite_use_custom_jar)&&(f.disabled=_),U&2&&de(f,O[1].runelite_custom_jar),U&4&&(b.disabled=O[2]),U&2&&ne(d,"opacity-25",!O[1].runelite_use_custom_jar)},i:j,o:j,d(O){O&&(w(e),w(o),w(r),w(u),w(d)),$=!1,re(N)}}}function Es(t,e,n){let l,o,r;const{config:i}=A;ue(t,i,p=>n(1,r=p));let a=!1;async function c(){n(2,a=!0),me(i,r.runelite_custom_jar=await z.openFilePicker(),r),console.log("done picking"),n(2,a=!1)}function u(){!(l!=null&&l.session_id)||!(o!=null&&o.accountId)||!(o!=null&&o.displayName)||zt(l.session_id,o.accountId,o.displayName,!0)}const d=()=>u();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function _(){r.runelite_custom_jar=this.value,i.set(r)}const g=()=>{c()};return t.$$.update=()=>{var p;t.$$.dirty&2&&n(0,l=z.findSession(r.selected.user_id)),t.$$.dirty&3&&n(3,o=z.findAccount((l==null?void 0:l.accounts)??[],(p=r.userDetails[r.selected.user_id??""])==null?void 0:p.account_id))},[l,r,a,o,i,c,u,d,f,_,g]}class Us extends ae{constructor(e){super(),ie(this,e,Es,Os,le,{})}}function Ns(t){let e,n,l,o,r,i;return{c(){e=m("div"),n=m("label"),n.textContent="Enable Bolt plugin loader:",l=R(),o=m("input"),h(n,"for","enable_plugins"),h(o,"type","checkbox"),h(o,"name","enable_plugins"),h(o,"id","enable_plugins"),h(o,"class","ml-2"),h(e,"class","mx-auto p-2")},m(a,c){y(a,e,c),k(e,n),k(e,l),k(e,o),o.checked=t[0].rs_plugin_loader,r||(i=M(o,"change",t[2]),r=!0)},p(a,c){c&1&&(o.checked=a[0].rs_plugin_loader)},d(a){a&&w(e),r=!1,i()}}}function Ms(t){let e,n,l,o,r,i,a,c,u,d,f,_=C.hasBoltPlugins&&Ns(t);return{c(){_&&_.c(),e=R(),n=m("div"),l=m("label"),l.textContent="Use custom config URI:",o=R(),r=m("input"),i=R(),a=m("div"),c=m("textarea"),h(l,"for","use_custom_uri"),h(r,"id","use_custom_uri"),h(r,"type","checkbox"),h(r,"class","ml-2"),h(n,"class","mx-auto p-2"),h(c,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),c.disabled=u=!t[0].use_custom_rs_config_uri,h(c,"rows","4"),h(c,"placeholder",C.env.default_config_uri),h(a,"class","p-2")},m(g,p){_&&_.m(g,p),y(g,e,p),y(g,n,p),k(n,l),k(n,o),k(n,r),r.checked=t[0].use_custom_rs_config_uri,y(g,i,p),y(g,a,p),k(a,c),de(c,t[0].rs_config_uri),d||(f=[M(r,"change",t[3]),M(c,"input",t[4])],d=!0)},p(g,[p]){C.hasBoltPlugins&&_.p(g,p),p&1&&(r.checked=g[0].use_custom_rs_config_uri),p&1&&u!==(u=!g[0].use_custom_rs_config_uri)&&(c.disabled=u),p&1&&de(c,g[0].rs_config_uri)},i:j,o:j,d(g){g&&(w(e),w(n),w(i),w(a)),_&&_.d(g),d=!1,re(f)}}}function js(t,e,n){let l;const{config:o}=A;ue(t,o,c=>n(0,l=c));function r(){l.rs_plugin_loader=this.checked,o.set(l)}function i(){l.use_custom_rs_config_uri=this.checked,o.set(l)}function a(){l.rs_config_uri=this.value,o.set(l)}return[l,o,r,i,a]}class As extends ae{constructor(e){super(),ie(this,e,js,Ms,le,{})}}function Ds(t){let e,n;return e=new As({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),n=!0},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){F(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function qs(t){let e,n;return e=new Us({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),n=!0},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){F(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Bs(t){let e,n;return e=new Hs({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),n=!0},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){F(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Gs(t){let e,n,l,o,r,i,a,c,u,d,f,_,g,p,v,b,L,$,N,O;const U=[Bs,qs,Ds],B=[];function T(S,x){return S[1]==S[2].general?0:S[1]==S[2].osrs?1:S[1]==S[2].rs3?2:-1}return~(b=T(t))&&(L=B[b]=U[b](t)),{c(){e=m("div"),n=m("div"),l=m("button"),o=J("General"),i=R(),a=m("button"),c=J("OSRS"),d=R(),f=m("button"),_=J("RS3"),p=R(),v=m("div"),L&&L.c(),h(l,"class",r=t[1]===t[2].general?Te:Pe),h(a,"class",u=t[1]===t[2].osrs?Te:Pe),h(f,"class",g=t[1]===t[2].rs3?Te:Pe),h(n,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),h(v,"class","col-span-3 p-5 pt-10 text-center"),h(e,"class","grid h-full grid-cols-4")},m(S,x){y(S,e,x),k(e,n),k(n,l),k(l,o),k(n,i),k(n,a),k(a,c),k(n,d),k(n,f),k(f,_),k(e,p),k(e,v),~b&&B[b].m(v,null),$=!0,N||(O=[M(l,"click",t[4]),M(a,"click",t[5]),M(f,"click",t[6])],N=!0)},p(S,x){(!$||x&2&&r!==(r=S[1]===S[2].general?Te:Pe))&&h(l,"class",r),(!$||x&2&&u!==(u=S[1]===S[2].osrs?Te:Pe))&&h(a,"class",u),(!$||x&2&&g!==(g=S[1]===S[2].rs3?Te:Pe))&&h(f,"class",g);let E=b;b=T(S),b!==E&&(L&&(De(),F(B[E],1,1,()=>{B[E]=null}),qe()),~b?(L=B[b],L||(L=B[b]=U[b](S),L.c()),D(L,1),L.m(v,null)):L=null)},i(S){$||(D(L),$=!0)},o(S){F(L),$=!1},d(S){S&&w(e),~b&&B[b].d(),N=!1,re(O)}}}function Fs(t){let e,n,l={class:"h-3/4 w-3/4 select-none",$$slots:{default:[Gs]},$$scope:{ctx:t}};return e=new Qe({props:l}),t[7](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),n=!0},p(o,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){t[7](null),K(e,o)}}}let Te="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",Pe="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function Xs(t,e,n){let l;function o(){l.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=0;const a=()=>{n(1,i=r.general)},c=()=>{n(1,i=r.osrs)},u=()=>{n(1,i=r.rs3)};function d(f){he[f?"unshift":"push"](()=>{l=f,n(0,l)})}return[l,i,r,o,a,c,u,d]}class Js extends ae{constructor(e){super(),ie(this,e,Xs,Fs,le,{open:3})}get open(){return this.$$.ctx[3]}}function Ws(t){const e=t.slice(),n=z.findSession(e[1].selected.user_id??"");return e[11]=n,e}function zs(t){let e,n,l;return{c(){e=m("button"),e.textContent="Login",h(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(o,r){y(o,e,r),n||(l=M(e,"click",t[10]),n=!0)},p:j,i:j,o:j,d(o){o&&w(e),n=!1,l()}}}function Vs(t){let e,n;return e=new Ps({props:{align:"center",$$slots:{content:[Zs],default:[Ys]},$$scope:{ctx:t}}}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),n=!0},p(l,o){const r={};o&4098&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(D(e.$$.fragment,l),n=!0)},o(l){F(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Ys(t){var o;let e,n=(((o=t[11])==null?void 0:o.user.displayName)??"No user selected")+"",l;return{c(){e=m("button"),l=J(n),h(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){y(r,e,i),k(e,l)},p(r,i){var a;i&2&&n!==(n=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&fe(l,n)},d(r){r&&w(e)}}}function Zs(t){let e,n,l;return n=new Ss({}),{c(){e=m("div"),se(n.$$.fragment),h(e,"slot","content"),h(e,"class","w-40")},m(o,r){y(o,e,r),Z(n,e,null),l=!0},p:j,i(o){l||(D(n.$$.fragment,o),l=!0)},o(o){F(n.$$.fragment,o),l=!1},d(o){o&&w(e),K(n)}}}function Ks(t){let e,n,l,o,r,i,a,c,u,d,f,_,g,p,v,b,L,$,N={};e=new Js({props:N}),t[5](e);const O=[Vs,zs],U=[];function B(S,x){return S[2].length>0?0:1}function T(S,x){return x===0?Ws(S):S}return p=B(t),v=U[p]=O[p](T(t,p)),{c(){se(e.$$.fragment),n=R(),l=m("div"),o=m("div"),r=m("button"),r.textContent="RS3",i=R(),a=m("button"),a.textContent="OSRS",c=R(),u=m("div"),d=m("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=R(),_=m("button"),_.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',g=R(),v.c(),h(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),ne(r,"text-black",t[1].selected.game===te.rs3),ne(r,"bg-blue-500",t[1].selected.game===te.rs3),h(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),ne(a,"text-black",t[1].selected.game===te.osrs),ne(a,"bg-blue-500",t[1].selected.game===te.osrs),h(o,"class","m-3 ml-9 font-bold"),h(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),h(_,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),h(u,"class","m-2 ml-auto flex gap-2"),h(l,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(S,x){Z(e,S,x),y(S,n,x),y(S,l,x),k(l,o),k(o,r),k(o,i),k(o,a),k(l,c),k(l,u),k(u,d),k(u,f),k(u,_),k(u,g),U[p].m(u,null),b=!0,L||($=[M(r,"click",t[6]),M(a,"click",t[7]),M(d,"click",t[8]),M(_,"click",t[9])],L=!0)},p(S,[x]){const E={};e.$set(E),(!b||x&2)&&ne(r,"text-black",S[1].selected.game===te.rs3),(!b||x&2)&&ne(r,"bg-blue-500",S[1].selected.game===te.rs3),(!b||x&2)&&ne(a,"text-black",S[1].selected.game===te.osrs),(!b||x&2)&&ne(a,"bg-blue-500",S[1].selected.game===te.osrs);let q=p;p=B(S),p===q?U[p].p(T(S,p),x):(De(),F(U[q],1,1,()=>{U[q]=null}),qe(),v=U[p],v?v.p(T(S,p),x):(v=U[p]=O[p](T(S,p)),v.c()),D(v,1),v.m(u,null))},i(S){b||(D(e.$$.fragment,S),D(v),b=!0)},o(S){F(e.$$.fragment,S),F(v),b=!1},d(S){S&&(w(n),w(l)),t[5](null),K(e,S),U[p].d(),L=!1,re($)}}}function Qs(t,e,n){let l,o;const{config:r,sessions:i}=A;ue(t,r,p=>n(1,l=p)),ue(t,i,p=>n(2,o=p));let a;function c(p){he[p?"unshift":"push"](()=>{a=p,n(0,a)})}return[a,l,o,r,i,c,()=>{me(r,l.selected.game=te.rs3,l)},()=>{me(r,l.selected.game=te.osrs,l)},()=>me(r,l.use_dark_theme=!l.use_dark_theme,l),()=>a.open(),()=>{const{origin:p,redirect:v,clientid:b}=C.env;_e.openLoginWindow(p,v,b)}]}class el extends ae{constructor(e){super(),ie(this,e,Qs,Ks,le,{})}}function tl(t){let e,n,l,o,r,i,a,c,u,d,f,_,g;return e=new In({}),l=new el({}),c=new bs({}),_=new ys({props:{logs:t[0]}}),{c(){se(e.$$.fragment),n=R(),se(l.$$.fragment),o=R(),r=m("div"),i=m("div"),a=R(),se(c.$$.fragment),u=R(),d=m("div"),f=R(),se(_.$$.fragment),h(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,v){Z(e,p,v),y(p,n,v),Z(l,p,v),y(p,o,v),y(p,r,v),k(r,i),k(r,a),Z(c,r,null),k(r,u),k(r,d),y(p,f,v),Z(_,p,v),g=!0},p(p,v){const b={};v&1&&(b.logs=p[0]),_.$set(b)},i(p){g||(D(e.$$.fragment,p),D(l.$$.fragment,p),D(c.$$.fragment,p),D(_.$$.fragment,p),g=!0)},o(p){F(e.$$.fragment,p),F(l.$$.fragment,p),F(c.$$.fragment,p),F(_.$$.fragment,p),g=!1},d(p){p&&(w(n),w(o),w(r),w(f)),K(e,p),K(l,p),K(c),K(_,p)}}}function nl(t){let e,n,l,o;return e=new Wt({props:{$$slots:{default:[tl]},$$scope:{ctx:t}}}),{c(){se(e.$$.fragment)},m(r,i){Z(e,r,i),n=!0,l||(o=M(window,"beforeunload",t[2]),l=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){n||(D(e.$$.fragment,r),n=!0)},o(r){F(e.$$.fragment,r),n=!1},d(r){K(e,r),l=!1,o()}}}function sl(t,e,n){let l;const o=P.logs;return ue(t,o,i=>n(0,l=i)),[l,o,()=>z.saveConfig()]}class ll extends ae{constructor(e){super(),ie(this,e,sl,nl,le,{})}}const qt={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new Ln(qt):(ol(),kn(),rl(),il().finally(()=>{A.initialized.set(!0)}),new ll(qt));function ol(){const t=new URLSearchParams(window.location.search);C.platform=t.get("platform"),C.isFlathub=t.get("flathub")==="1",C.rs3DebInstalledHash=t.get("rs3_deb_installed_hash"),C.rs3ExeInstalledHash=t.get("rs3_exe_installed_hash"),C.rs3AppInstalledHash=t.get("rs3_app_installed_hash"),C.osrsExeInstalledHash=t.get("osrs_exe_installed_hash"),C.osrsAppInstalledHash=t.get("osrs_app_installed_hash"),C.runeLiteInstalledId=t.get("runelite_installed_id"),C.hdosInstalledVersion=t.get("hdos_installed_version");const e=t.get("plugins");if(C.hasBoltPlugins=e!==null,e!==null)try{C.pluginList=JSON.parse(e)}catch{P.error("Unable to parse plugin list")}const n=t.get("credentials");if(n)try{const l=JSON.parse(n),o=l.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");o?A.sessions.set(l):(A.sessions.set([]),z.saveCredentials(),P.warn("Credentials saved on disk are out of date. Please sign in again.")),A.sessions.set(o?l:[])}catch{A.sessions.set([]),z.saveCredentials(),P.error("Unable to parse saved credentials. Please sign in again.")}}function rl(){const{origin:t,origin_2fa:e}=C.env,n=[window.location.origin,t,e];let l=null;window.addEventListener("message",async o=>{var r;if(!n.includes(o.origin)){P.info(`discarding window message from origin ${o.origin}`);return}switch(o.data.type){case"authTokenUpdate":{l=o.data.tokens;break}case"authSessionUpdate":{if(l===null)return P.error("auth is null. Please try again.");const i=o.data.sessionId,a=await z.login(l,i);a.ok?P.info(`Added new user '${a.value.user.displayName}'`):P.error(`Unable to add new user. Please try again. ${a.error}`),z.saveCredentials(),_e.pendingLoginWindow=null,l=null;break}case"authFailed":{P.error(`Unable to authenticate: ${o.data.reason}`),_e.pendingLoginWindow=null,l=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&P.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(o.data.url);break}case"gameClientList":pe(A.config).close_after_launch&&o.data.clients.length>pe(at).length?fetch("/close"):at.set(o.data.clients);break;default:{const i=((r=o.data)==null?void 0:r.type)??"no type provided";P.info(`Unknown message type: ${i}`);break}}})}async function il(){const t=pe(A.sessions),e=[];t.length>0&&P.info("Logging in...");for(const n of t){const l=await _e.refreshOAuthToken(n.tokens);if(!l.ok){l.error===0?P.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):(P.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),e.push(n.tokens.sub));continue}const o=l.value;n.tokens=o;const r=await z.login(o,n.session_id);r.ok?P.info(`Signed into saved user '${r.value.user.displayName}'`):(P.error(`Unable to sign into saved user '${n.user.displayName}' - please sign in again. ${r.error}`),e.push(n.tokens.sub))}e.forEach(async n=>{await z.logout(n)}),A.sessions.set(t),await z.saveCredentials()}
