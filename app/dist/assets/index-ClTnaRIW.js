(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var br=(e=>(e[e.SECOND=1e3]="SECOND",e[e.MINUTE=6e4]="MINUTE",e[e.HALF_HOUR=18e5]="HALF_HOUR",e[e.HOUR=36e5]="HOUR",e[e.DAY=864e5]="DAY",e[e.WEEK=6048e5]="WEEK",e[e.MONTH=2592e6]="MONTH",e))(br||{});class Kt{static set(t,n,r,a){const o=new Date;o.setTime(o.getTime()+r*a);const i=`expires=${o.toUTCString()}`;document.cookie=`${t}=${n};${i};path=/`}static get(t){const n=`${t}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let o=r[a];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(n)===0)return o.substring(n.length,o.length)}return null}static remove(t){document.cookie=`${t}=; Max-Age=-99999999;`}}function et(e){return{ok:!0,value:e}}function ae(e){return{ok:!1,error:e}}var Ee=(e=>(e.rs3="rs3",e.osrs="osrs",e))(Ee||{}),en=(e=>(e.official="Official",e.runelite="RuneLite",e.hdos="HDOS",e))(en||{});const da={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class Un{static parseTokenResponse(t){try{const n=JSON.parse(t),r=n.id_token.split(".");if(r.length!==3){const i=`Malformed id_token: ${r.length} sections, expected 3`;return ae(i)}const a=JSON.parse(atob(r[0]));if(a.typ!=="JWT"){const i=`Bad id_token header: typ ${a.typ}, expected JWT`;return ae(i)}const o=JSON.parse(atob(r[1]));return et({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:o.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return ae("Unable to parse token response")}}static parseSessionResponse(t){try{const n=JSON.parse(t);return n.sessionId?et(n.sessionId):ae("sessionId does not exist on parsed object")}catch{return ae("Unable to parse session response")}}static decodeBolt(t){const n={};for(const r in t){const a=r,o=t[a];typeof o=="string"?n[a]=atob(o):Array.isArray(o)&&o.every(i=>typeof i=="string")?n[a]=o.map(i=>atob(i)):n[a]=o}return n}}var wr=(e=>(e.Windows="windows",e.Linux="linux",e.MacOS="mac",e))(wr||{});const $={env:Un.decodeBolt(s()),platform:null,rs3debInstalledHash:null,rs3exeInstalledHash:null,rs3appInstalledHash:null,osrsexeInstalledHash:null,osrsappInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasLibArchive:!1,hasBoltPlugins:!1,pluginConfig:{}};class lr{static async makeLoginUrl(t){const n=new TextEncoder().encode(t.pkceCodeVerifier),r=await crypto.subtle.digest("SHA-256",n);let a="";const o=new Uint8Array(r);for(let c=0;c<o.byteLength;c++)a+=String.fromCharCode(o[c]);const i=btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:t.authMethod,login_type:t.loginType,flow:t.flow,response_type:"code",client_id:t.clientid,redirect_uri:t.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:t.pkceState}).toString())}static makeRandomVerifier(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(r){return t[r%t.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=n.length-1,a=crypto.getRandomValues(new Uint8Array(12));return Array.from(a).map(o=>Math.round(o*(r-0)/255+0)).map(o=>n[o]).join("")}}class Ce{static pendingLoginWindow=null;static async openLoginWindow(t,n,r){if(Ce.pendingLoginWindow!==null)return Ce.pendingLoginWindow.window.focus();const a=lr.makeRandomState(),o=lr.makeRandomVerifier(),i=new TextEncoder().encode(o),c=await crypto.subtle.digest("SHA-256",i);let l="";const u=new Uint8Array(c);for(let _=0;_<u.byteLength;_++)l+=String.fromCharCode(u[_]);const f=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:r,redirect_uri:n,code_challenge:f,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:a}),p=`${t}/oauth2/auth?${d.toString()}`;Kt.set("auth_verifier",o,10,br.MINUTE),Ce.pendingLoginWindow=window.open(p,"","width=480,height=720")}static navigateToAuthConsent(t,n,r){const a=lr.makeRandomState(),o=new URLSearchParams({id_token_hint:n,nonce:r,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:a,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${t}/oauth2/auth?${o.toString()}`;Kt.set("auth_nonce",r,10,br.MINUTE),window.location.href=i}static async refreshOAuthToken(t){return new Promise(n=>{if(t.expiry-Date.now()<3e4){const r=new URLSearchParams({grant_type:"refresh_token",client_id:$.env.clientid,refresh_token:t.refresh_token}),a=new XMLHttpRequest;a.onreadystatechange=()=>{if(a.readyState==4)if(a.status==200){const i=Un.parseTokenResponse(a.response);i.ok?n(et(i.value)):n(ae(0))}else n(ae(a.status))},a.onerror=()=>{n(ae(0))};const o=$.env.origin.concat("/oauth2/token");a.open("POST",o,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("Accept","application/json"),a.send(r)}else n(et(t))})}static async getOAuthToken(t,n,r,a,o){const i=`${t}/oauth2/token`;return new Promise(c=>{const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const f=Un.parseTokenResponse(l.response);return f.ok?c(et(f.value)):c(ae(f.error))}else return c(ae(`Error: from ${i}: ${l.status}: ${l.response}`))},l.open("POST",i,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json");const u=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:o,code_verifier:r,redirect_uri:a});l.send(u)})}static revokeOauthCreds(t){const n=`${$.env.origin}/oauth2/revoke`;return new Promise(r=>{const a=new XMLHttpRequest;a.open("POST",n,!0),a.onreadystatechange=()=>{a.readyState==4&&r(a.status)},a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const o=new URLSearchParams({token:t,client_id:$.env.clientid});a.send(o)})}static async getSessionId(t,n){const r=`${t}/sessions`;return new Promise(a=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const c=Un.parseSessionResponse(o.response);return c.ok?a(et(c.value)):a(ae(c.error))}else ae(`Error: from ${r}: ${o.status}: ${o.response}`)},o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json");const i={idToken:n};o.send(JSON.stringify(i))})}static validateIdToken(t,n){const r=t.split(".");if(r.length!==3)return ae(`Malformed id_token: ${r.length} sections, expected 3`);const a=JSON.parse(atob(r[0]));return a.typ!=="JWT"?ae(`Bad id_token header: typ ${a.typ}, expected JWT`):JSON.parse(atob(r[1])).nonce!==n?ae("Incorrect nonce in id_token"):et(void 0)}}class Mn{static async buildSession(t,n){const r=await Mn.getUser(t.sub,t.access_token);if(!r.ok)return ae(`Failed to fetch user. Status: ${r.error}`);const a=await Mn.getUserAccounts(n);return a.ok?et({user:r.value,accounts:a.value,tokens:t,session_id:n}):ae(`Failed to fetch game accounts. Status: ${a.error}`)}static getUser(t,n){return new Promise(r=>{const a=`${$.env.api}/users/${t}/displayName`,o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=JSON.parse(o.response);r(et(i))}else r(ae(o.status))},o.open("GET",a,!0),o.setRequestHeader("Authorization","Bearer ".concat(n)),o.send()})}static getUserAccounts(t){const n=`${$.env.auth_api}/accounts`;return new Promise(r=>{const a=new XMLHttpRequest;a.onreadystatechange=async()=>{if(a.readyState==4)if(a.status==200){const o=JSON.parse(a.response);r(et(o))}else r(ae(a.status))},a.open("GET",n,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(t)),a.send()})}}const ps=!1;var zn=Array.isArray,_a=Array.prototype.indexOf,Rr=Array.from,Dn=Object.defineProperty,tn=Object.getOwnPropertyDescriptor,hs=Object.getOwnPropertyDescriptors,va=Object.prototype,pa=Array.prototype,Pr=Object.getPrototypeOf,Yr=Object.isExtensible;const nt=()=>{};function ha(e){return typeof e?.then=="function"}function ga(e){return e()}function jn(e){for(var t=0;t<e.length;t++)e[t]()}function ma(){var e,t,n=new Promise((r,a)=>{e=r,t=a});return{promise:n,resolve:e,reject:t}}function ba(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const He=2,Ir=4,Jn=8,fn=16,yt=32,Gt=64,Tr=128,Ge=256,Fn=512,he=1024,Ve=2048,Ot=4096,rt=8192,dn=16384,Or=32768,Sn=65536,Zr=1<<17,wa=1<<18,_n=1<<19,gs=1<<20,yr=1<<21,Ar=1<<22,Ft=1<<23,Pt=Symbol("$state"),ya=Symbol(""),Ur=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ms(e){return e===this.v}function Nr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function bs(e){return!Nr(e,this.v)}function ws(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ka(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xa(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Sa(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function $a(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ea(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function La(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ca(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ra(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Pa(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}let $n=!1,Ia=!1;function Ta(){$n=!0}const Xn=1,Yn=2,ys=4,Oa=8,Aa=16,Ua=1,Na=2,ce=Symbol(),Ha="http://www.w3.org/1999/xhtml";let ee=null;function Tt(e){ee=e}function me(e,t=!1,n){ee={p:ee,c:null,e:null,s:e,x:null,l:$n&&!t?{s:null,u:null,$:[]}:null}}function be(e){var t=ee,n=t.e;if(n!==null){t.e=null;for(var r of n)Bs(r)}return e!==void 0&&(t.x=e),ee=t.p,e??{}}function vn(){return!$n||ee!==null&&ee.l===null}let Lt=[],qn=[];function ks(){var e=Lt;Lt=[],jn(e)}function Ma(){var e=qn;qn=[],jn(e)}function Da(){return Lt.length>0||qn.length>0}function pn(e){if(Lt.length===0&&!wn){var t=Lt;queueMicrotask(()=>{t===Lt&&ks()})}Lt.push(e)}function ja(){Lt.length>0&&ks(),qn.length>0&&Ma()}function Fa(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function qa(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Ba=!1;function Qt(e){if(typeof e!="object"||e===null||Pt in e)return e;const t=Pr(e);if(t!==va&&t!==pa)return e;var n=new Map,r=zn(e),a=oe(0),o=qt,i=c=>{if(qt===o)return c();var l=j,u=qt;ge(null),ss(o);var f=c();return ge(l),ss(u),f};return r&&n.set("length",oe(e.length)),new Proxy(e,{defineProperty(c,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&La();var f=n.get(l);return f===void 0?f=i(()=>{var d=oe(u.value);return n.set(l,d),d}):R(f,u.value,!0),!0},deleteProperty(c,l){var u=n.get(l);if(u===void 0){if(l in c){const f=i(()=>oe(ce));n.set(l,f),yn(a)}}else R(u,ce),yn(a);return!0},get(c,l,u){if(l===Pt)return e;var f=n.get(l),d=l in c;if(f===void 0&&(!d||tn(c,l)?.writable)&&(f=i(()=>{var _=Qt(d?c[l]:ce),h=oe(_);return h}),n.set(l,f)),f!==void 0){var p=v(f);return p===ce?void 0:p}return Reflect.get(c,l,u)},getOwnPropertyDescriptor(c,l){var u=Reflect.getOwnPropertyDescriptor(c,l);if(u&&"value"in u){var f=n.get(l);f&&(u.value=v(f))}else if(u===void 0){var d=n.get(l),p=d?.v;if(d!==void 0&&p!==ce)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return u},has(c,l){if(l===Pt)return!0;var u=n.get(l),f=u!==void 0&&u.v!==ce||Reflect.has(c,l);if(u!==void 0||F!==null&&(!f||tn(c,l)?.writable)){u===void 0&&(u=i(()=>{var p=f?Qt(c[l]):ce,_=oe(p);return _}),n.set(l,u));var d=v(u);if(d===ce)return!1}return f},set(c,l,u,f){var d=n.get(l),p=l in c;if(r&&l==="length")for(var _=u;_<d.v;_+=1){var h=n.get(_+"");h!==void 0?R(h,ce):_ in c&&(h=i(()=>oe(ce)),n.set(_+"",h))}if(d===void 0)(!p||tn(c,l)?.writable)&&(d=i(()=>oe(void 0)),R(d,Qt(u)),n.set(l,d));else{p=d.v!==ce;var g=i(()=>Qt(u));R(d,g)}var m=Reflect.getOwnPropertyDescriptor(c,l);if(m?.set&&m.set.call(f,u),!p){if(r&&typeof l=="string"){var k=n.get("length"),b=Number(l);Number.isInteger(b)&&b>=k.v&&R(k,b+1)}yn(a)}return!0},ownKeys(c){v(a);var l=Reflect.ownKeys(c).filter(d=>{var p=n.get(d);return p===void 0||p.v!==ce});for(var[u,f]of n)f.v!==ce&&!(u in c)&&l.push(u);return l},setPrototypeOf(){Ca()}})}function Kr(e){try{if(e!==null&&typeof e=="object"&&Pt in e)return e[Pt]}catch{}return e}function Wa(e,t){return Object.is(Kr(e),Kr(t))}var Qr,xs,Ss,$s;function Ga(){if(Qr===void 0){Qr=window,xs=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ss=tn(t,"firstChild").get,$s=tn(t,"nextSibling").get,Yr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Yr(n)&&(n.__t=void 0)}}function hn(e=""){return document.createTextNode(e)}function Bn(e){return Ss.call(e)}function En(e){return $s.call(e)}function C(e,t){return Bn(e)}function B(e,t=!1){{var n=Bn(e);return n instanceof Comment&&n.data===""?En(n):n}}function w(e,t=1,n=!1){let r=e;for(;t--;)r=En(r);return r}function Va(e){e.textContent=""}function Es(){return!1}const za=new WeakMap;function Ls(e){var t=F;if(t===null)return j.f|=Ft,e;if((t.f&Or)===0){if((t.f&Tr)===0)throw!t.parent&&e instanceof Error&&Cs(e),e;t.b.error(e)}else ln(e,t)}function ln(e,t){for(;t!==null;){if((t.f&Tr)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&Cs(e),e}function Cs(e){const t=za.get(e);t&&(Dn(e,"message",{value:t.message}),Dn(e,"stack",{value:t.stack}))}const cr=new Set;let K=null,Nn=null,kr=new Set,Wt=[],Zn=null,xr=!1,wn=!1;class vt{current=new Map;#a=new Map;#t=new Set;#d=0;#o=null;#u=!1;#s=[];#n=[];#e=[];#r=[];#i=[];#f=[];#c=[];skipped_effects=new Set;process(t){Wt=[],Nn=null;for(const a of t)this.#_(a);if(this.#s.length===0&&this.#d===0){this.#v();var n=this.#e,r=this.#r;this.#e=[],this.#r=[],this.#i=[],Nn=K,K=null,es(n),es(r),K===null?K=this:cr.delete(this),this.#o?.resolve()}else this.#l(this.#e),this.#l(this.#r),this.#l(this.#i);for(const a of this.#s)rn(a);for(const a of this.#n)rn(a);this.#s=[],this.#n=[]}#_(t){t.f^=he;for(var n=t.first;n!==null;){var r=n.f,a=(r&(yt|Gt))!==0,o=a&&(r&he)!==0,i=o||(r&rt)!==0||this.skipped_effects.has(n);if(!i&&n.fn!==null){if(a)n.f^=he;else if((r&Ir)!==0)this.#r.push(n);else if((r&he)===0)if((r&Ar)!==0){var c=n.b?.is_pending()?this.#n:this.#s;c.push(n)}else Qn(n)&&((n.f&fn)!==0&&this.#i.push(n),rn(n));var l=n.first;if(l!==null){n=l;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}}#l(t){for(const n of t)((n.f&Ve)!==0?this.#f:this.#c).push(n),Re(n,he);t.length=0}capture(t,n){this.#a.has(t)||this.#a.set(t,n),this.current.set(t,t.v)}activate(){K=this}deactivate(){K=null,Nn=null;for(const t of kr)if(kr.delete(t),t(),K!==null)break}neuter(){this.#u=!0}flush(){Wt.length>0?Ps():this.#v(),K===this&&(this.#d===0&&cr.delete(this),this.deactivate())}#v(){if(!this.#u)for(const t of this.#t)t();this.#t.clear()}increment(){this.#d+=1}decrement(){if(this.#d-=1,this.#d===0){for(const t of this.#f)Re(t,Ve),cn(t);for(const t of this.#c)Re(t,Ot),cn(t);this.#e=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(t){this.#t.add(t)}settled(){return(this.#o??=ma()).promise}static ensure(){if(K===null){const t=K=new vt;cr.add(K),wn||vt.enqueue(()=>{K===t&&t.flush()})}return K}static enqueue(t){pn(t)}}function Rs(e){var t=wn;wn=!0;try{for(var n;;){if(ja(),Wt.length===0&&!Da()&&(K?.flush(),Wt.length===0))return Zn=null,n;Ps()}}finally{wn=t}}function Ps(){var e=nn;xr=!0;try{var t=0;for(ns(!0);Wt.length>0;){var n=vt.ensure();if(t++>1e3){var r,a;Ja()}n.process(Wt),It.clear()}}finally{xr=!1,ns(e),Zn=null}}function Ja(){try{Ea()}catch(e){ln(e,Zn)}}let Mt=null;function es(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(dn|rt))===0&&Qn(r)&&(Mt=[],rn(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Vs(r):r.fn=null),Mt?.length>0)){It.clear();for(const a of Mt)rn(a);Mt=[]}}Mt=null}}function cn(e){for(var t=Zn=e;t.parent!==null;){t=t.parent;var n=t.f;if(xr&&t===F&&(n&fn)!==0)return;if((n&(Gt|yt))!==0){if((n&he)===0)return;t.f^=he}}Wt.push(t)}function Xa(e){let t=0,n=bt(0),r;return()=>{_o()&&(v(n),Ln(()=>(t===0&&(r=P(()=>e(()=>yn(n)))),t+=1,()=>{pn(()=>{t-=1,t===0&&(r?.(),r=void 0,yn(n))})})))}}var Ya=Sn|_n|Tr;function Za(e,t,n){new Ka(e,t,n)}class Ka{parent;#a=!1;#t;#d=null;#o;#u;#s;#n=null;#e=null;#r=null;#i=null;#f=0;#c=0;#_=!1;#l=null;#v=()=>{this.#l&&ct(this.#l,this.#f)};#m=Xa(()=>(this.#l=bt(this.#f),()=>{this.#l=null}));constructor(t,n,r){this.#t=t,this.#o=n,this.#u=r,this.parent=F.b,this.#a=!!this.#o.pending,this.#s=Cn(()=>{F.b=this;{try{this.#n=xe(()=>r(this.#t))}catch(a){this.error(a)}this.#c>0?this.#h():this.#a=!1}},Ya)}#b(){try{this.#n=xe(()=>this.#u(this.#t))}catch(t){this.error(t)}this.#a=!1}#w(){const t=this.#o.pending;t&&(this.#e=xe(()=>t(this.#t)),vt.enqueue(()=>{this.#n=this.#p(()=>(vt.ensure(),xe(()=>this.#u(this.#t)))),this.#c>0?this.#h():(ht(this.#e,()=>{this.#e=null}),this.#a=!1)}))}is_pending(){return this.#a||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#o.pending}#p(t){var n=F,r=j,a=ee;ze(this.#s),ge(this.#s),Tt(this.#s.ctx);try{return t()}catch(o){return Ls(o),null}finally{ze(n),ge(r),Tt(a)}}#h(){const t=this.#o.pending;this.#n!==null&&(this.#i=document.createDocumentFragment(),Qa(this.#n,this.#i)),this.#e===null&&(this.#e=xe(()=>t(this.#t)))}#g(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#g(t);return}this.#c+=t,this.#c===0&&(this.#a=!1,this.#e&&ht(this.#e,()=>{this.#e=null}),this.#i&&(this.#t.before(this.#i),this.#i=null))}update_pending_count(t){this.#g(t),this.#f+=t,kr.add(this.#v)}get_effect_pending(){return this.#m(),v(this.#l)}error(t){var n=this.#o.onerror;let r=this.#o.failed;if(this.#_||!n&&!r)throw t;this.#n&&(Ne(this.#n),this.#n=null),this.#e&&(Ne(this.#e),this.#e=null),this.#r&&(Ne(this.#r),this.#r=null);var a=!1,o=!1;const i=()=>{if(a){qa();return}a=!0,o&&Pa(),vt.ensure(),this.#f=0,this.#r!==null&&ht(this.#r,()=>{this.#r=null}),this.#a=this.has_pending_snippet(),this.#n=this.#p(()=>(this.#_=!1,xe(()=>this.#u(this.#t)))),this.#c>0?this.#h():this.#a=!1};var c=j;try{ge(null),o=!0,n?.(t,i),o=!1}catch(l){ln(l,this.#s&&this.#s.parent)}finally{ge(c)}r&&pn(()=>{this.#r=this.#p(()=>{this.#_=!0;try{return xe(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return ln(l,this.#s.parent),null}finally{this.#_=!1}})})}}function Qa(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var a=n===r?null:En(n);t.append(n),n=a}}function eo(e,t,n){const r=vn()?Kn:Hr;if(t.length===0){n(e.map(r));return}var a=K,o=F,i=to();Promise.all(t.map(c=>no(c))).then(c=>{a?.activate(),i();try{n([...e.map(r),...c])}catch(l){(o.f&dn)===0&&ln(l,o)}a?.deactivate(),Is()}).catch(c=>{ln(c,o)})}function to(){var e=F,t=j,n=ee,r=K;return function(){ze(e),ge(t),Tt(n),r?.activate()}}function Is(){ze(null),ge(null),Tt(null)}function Kn(e){var t=He|Ve,n=j!==null&&(j.f&He)!==0?j:null;return F===null||n!==null&&(n.f&Ge)!==0?t|=Ge:F.f|=_n,{ctx:ee,deps:null,effects:null,equals:ms,f:t,fn:e,reactions:null,rv:0,v:ce,wv:0,parent:n??F,ac:null}}function no(e,t){let n=F;n===null&&ka();var r=n.b,a=void 0,o=bt(ce),i=null,c=!j;return ho(()=>{try{var l=e();i&&Promise.resolve(l).catch(()=>{})}catch(_){l=Promise.reject(_)}var u=()=>l;a=i?.then(u,u)??Promise.resolve(l),i=a;var f=K,d=r.is_pending();c&&(r.update_pending_count(1),d||f.increment());const p=(_,h=void 0)=>{i=null,d||f.activate(),h?h!==Ur&&(o.f|=Ft,ct(o,h)):((o.f&Ft)!==0&&(o.f^=Ft),ct(o,_)),c&&(r.update_pending_count(-1),d||f.decrement()),Is()};if(a.then(p,_=>p(null,_||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(l=>{function u(f){function d(){f===a?l(o):u(a)}f.then(d,d)}u(a)})}function Be(e){const t=Kn(e);return Us(t),t}function Hr(e){const t=Kn(e);return t.equals=bs,t}function Ts(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ne(t[n])}}function ro(e){for(var t=e.parent;t!==null;){if((t.f&He)===0)return t;t=t.parent}return null}function Mr(e){var t,n=F;ze(ro(e));try{Ts(e),t=Ds(e)}finally{ze(n)}return t}function Os(e){var t=Mr(e);if(e.equals(t)||(e.v=t,e.wv=Hs()),!gn){var n=(Ct||(e.f&Ge)!==0)&&e.deps!==null?Ot:he;Re(e,n)}}const It=new Map;function bt(e,t){var n={f:0,v:e,reactions:null,equals:ms,rv:0,wv:0};return n}function oe(e,t){const n=bt(e);return Us(n),n}function We(e,t=!1,n=!0){const r=bt(e);return t||(r.equals=bs),$n&&n&&ee!==null&&ee.l!==null&&(ee.l.s??=[]).push(r),r}function R(e,t,n=!1){j!==null&&(!tt||(j.f&Zr)!==0)&&vn()&&(j.f&(He|fn|Ar|Zr))!==0&&!pt?.includes(e)&&Ra();let r=n?Qt(t):t;return ct(e,r)}function ct(e,t){if(!e.equals(t)){var n=e.v;gn?It.set(e,t):It.set(e,n),e.v=t;var r=vt.ensure();r.capture(e,n),(e.f&He)!==0&&((e.f&Ve)!==0&&Mr(e),Re(e,(e.f&Ge)===0?he:Ot)),e.wv=Hs(),As(e,Ve),vn()&&F!==null&&(F.f&he)!==0&&(F.f&(yt|Gt))===0&&(qe===null?io([e]):qe.push(e))}return t}function yn(e){R(e,e.v+1)}function As(e,t){var n=e.reactions;if(n!==null)for(var r=vn(),a=n.length,o=0;o<a;o++){var i=n[o],c=i.f;if(!(!r&&i===F)){var l=(c&Ve)===0;l&&Re(i,t),(c&He)!==0?As(i,Ot):l&&((c&fn)!==0&&Mt!==null&&Mt.push(i),cn(i))}}}let Zt=null;function so(e){var t=Zt;try{if(Zt=new Set,P(e),t!==null)for(var n of Zt)t.add(n);return Zt}finally{Zt=t}}function ao(e){for(var t of so(e))ct(t,t.v)}let ts=!1;function oo(){ts||(ts=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Dr(e){var t=j,n=F;ge(null),ze(null);try{return e()}finally{ge(t),ze(n)}}function jr(e,t,n,r=n){e.addEventListener(t,()=>Dr(n));const a=e.__on_r;a?e.__on_r=()=>{a(),r(!0)}:e.__on_r=()=>r(!0),oo()}let nn=!1;function ns(e){nn=e}let gn=!1;function rs(e){gn=e}let j=null,tt=!1;function ge(e){j=e}let F=null;function ze(e){F=e}let pt=null;function Us(e){j!==null&&(pt===null?pt=[e]:pt.push(e))}let ke=null,Ae=0,qe=null;function io(e){qe=e}let Ns=1,xn=0,qt=xn;function ss(e){qt=e}let Ct=!1;function Hs(){return++Ns}function Qn(e){var t=e.f;if((t&Ve)!==0)return!0;if((t&Ot)!==0){var n=e.deps,r=(t&Ge)!==0;if(n!==null){var a,o,i=(t&Fn)!==0,c=r&&F!==null&&!Ct,l=n.length;if((i||c)&&(F===null||(F.f&dn)===0)){var u=e,f=u.parent;for(a=0;a<l;a++)o=n[a],(i||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);i&&(u.f^=Fn),c&&f!==null&&(f.f&Ge)===0&&(u.f^=Ge)}for(a=0;a<l;a++)if(o=n[a],Qn(o)&&Os(o),o.wv>e.wv)return!0}(!r||F!==null&&!Ct)&&Re(e,he)}return!1}function Ms(e,t,n=!0){var r=e.reactions;if(r!==null&&!pt?.includes(e))for(var a=0;a<r.length;a++){var o=r[a];(o.f&He)!==0?Ms(o,t,!1):t===o&&(n?Re(o,Ve):(o.f&he)!==0&&Re(o,Ot),cn(o))}}function Ds(e){var t=ke,n=Ae,r=qe,a=j,o=Ct,i=pt,c=ee,l=tt,u=qt,f=e.f;ke=null,Ae=0,qe=null,Ct=(f&Ge)!==0&&(tt||!nn||j===null),j=(f&(yt|Gt))===0?e:null,pt=null,Tt(e.ctx),tt=!1,qt=++xn,e.ac!==null&&(Dr(()=>{e.ac.abort(Ur)}),e.ac=null);try{e.f|=yr;var d=e.fn,p=d(),_=e.deps;if(ke!==null){var h;if(Wn(e,Ae),_!==null&&Ae>0)for(_.length=Ae+ke.length,h=0;h<ke.length;h++)_[Ae+h]=ke[h];else e.deps=_=ke;if(!Ct||(f&He)!==0&&e.reactions!==null)for(h=Ae;h<_.length;h++)(_[h].reactions??=[]).push(e)}else _!==null&&Ae<_.length&&(Wn(e,Ae),_.length=Ae);if(vn()&&qe!==null&&!tt&&_!==null&&(e.f&(He|Ot|Ve))===0)for(h=0;h<qe.length;h++)Ms(qe[h],e);return a!==null&&a!==e&&(xn++,qe!==null&&(r===null?r=qe:r.push(...qe))),(e.f&Ft)!==0&&(e.f^=Ft),p}catch(g){return Ls(g)}finally{e.f^=yr,ke=t,Ae=n,qe=r,j=a,Ct=o,pt=i,Tt(c),tt=l,qt=u}}function lo(e,t){let n=t.reactions;if(n!==null){var r=_a.call(n,e);if(r!==-1){var a=n.length-1;a===0?n=t.reactions=null:(n[r]=n[a],n.pop())}}n===null&&(t.f&He)!==0&&(ke===null||!ke.includes(t))&&(Re(t,Ot),(t.f&(Ge|Fn))===0&&(t.f^=Fn),Ts(t),Wn(t,0))}function Wn(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)lo(e,n[r])}function rn(e){var t=e.f;if((t&dn)===0){Re(e,he);var n=F,r=nn;F=e,nn=!0;try{(t&fn)!==0?go(e):Gs(e),Ws(e);var a=Ds(e);e.teardown=typeof a=="function"?a:null,e.wv=Ns;var o;ps&&Ia&&(e.f&Ve)!==0&&e.deps}finally{nn=r,F=n}}}async function co(){await Promise.resolve(),Rs()}function v(e){var t=e.f,n=(t&He)!==0;if(Zt?.add(e),j!==null&&!tt){var r=F!==null&&(F.f&dn)!==0;if(!r&&!pt?.includes(e)){var a=j.deps;if((j.f&yr)!==0)e.rv<xn&&(e.rv=xn,ke===null&&a!==null&&a[Ae]===e?Ae++:ke===null?ke=[e]:(!Ct||!ke.includes(e))&&ke.push(e));else{(j.deps??=[]).push(e);var o=e.reactions;o===null?e.reactions=[j]:o.includes(j)||o.push(j)}}}else if(n&&e.deps===null&&e.effects===null){var i=e,c=i.parent;c!==null&&(c.f&Ge)===0&&(i.f^=Ge)}if(gn){if(It.has(e))return It.get(e);if(n){i=e;var l=i.v;return((i.f&he)===0&&i.reactions!==null||js(i))&&(l=Mr(i)),It.set(i,l),l}}else n&&(i=e,Qn(i)&&Os(i));if((e.f&Ft)!==0)throw e.v;return e.v}function js(e){if(e.v===ce)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(It.has(t)||(t.f&He)!==0&&js(t))return!0;return!1}function Q(e){return e&&v(e)}function P(e){var t=tt;try{return tt=!0,e()}finally{tt=t}}const uo=-7169;function Re(e,t){e.f=e.f&uo|t}function Fs(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Pt in e)Sr(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Pt in n&&Sr(n)}}}function Sr(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{Sr(e[r],t)}catch{}const n=Pr(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=hs(n);for(let a in r){const o=r[a].get;if(o)try{o.call(e)}catch{}}}}}function qs(e){F===null&&j===null&&$a(),j!==null&&(j.f&Ge)!==0&&F===null&&Sa(),gn&&xa()}function fo(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ut(e,t,n,r=!0){var a=F;a!==null&&(a.f&rt)!==0&&(e|=rt);var o={ctx:ee,deps:null,nodes_start:null,nodes_end:null,f:e|Ve,first:null,fn:t,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{rn(o),o.f|=Or}catch(l){throw Ne(o),l}else t!==null&&cn(o);if(r){var i=o;if(n&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&_n)===0&&(i=i.first),i!==null&&(i.parent=a,a!==null&&fo(i,a),j!==null&&(j.f&He)!==0&&(e&Gt)===0)){var c=j;(c.effects??=[]).push(i)}}return o}function _o(){return j!==null&&!tt}function Fr(e){const t=ut(Jn,null,!1);return Re(t,he),t.teardown=e,t}function un(e){qs();var t=F.f,n=!j&&(t&yt)!==0&&(t&Or)===0;if(n){var r=ee;(r.e??=[]).push(e)}else return Bs(e)}function Bs(e){return ut(Ir|gs,e,!1)}function vo(e){return qs(),ut(Jn|gs,e,!0)}function po(e){vt.ensure();const t=ut(Gt|_n,e,!0);return(n={})=>new Promise(r=>{n.outro?ht(t,()=>{Ne(t),r(void 0)}):(Ne(t),r(void 0))})}function qr(e){return ut(Ir,e,!1)}function ho(e){return ut(Ar|_n,e,!0)}function Ln(e,t=0){return ut(Jn|t,e,!0)}function W(e,t=[],n=[]){eo(t,n,r=>{ut(Jn,()=>e(...r.map(v)),!0)})}function Cn(e,t=0){var n=ut(fn|t,e,!0);return n}function xe(e,t=!0){return ut(yt|_n,e,!0,t)}function Ws(e){var t=e.teardown;if(t!==null){const n=gn,r=j;rs(!0),ge(null);try{t.call(null)}finally{rs(n),ge(r)}}}function Gs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const a=n.ac;a!==null&&Dr(()=>{a.abort(Ur)});var r=n.next;(n.f&Gt)!==0?n.parent=null:Ne(n,t),n=r}}function go(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&yt)===0&&Ne(t),t=n}}function Ne(e,t=!0){var n=!1;(t||(e.f&wa)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(mo(e.nodes_start,e.nodes_end),n=!0),Gs(e,t&&!n),Wn(e,0),Re(e,dn);var r=e.transitions;if(r!==null)for(const o of r)o.stop();Ws(e);var a=e.parent;a!==null&&a.first!==null&&Vs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function mo(e,t){for(;e!==null;){var n=e===t?null:En(e);e.remove(),e=n}}function Vs(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function ht(e,t){var n=[];Br(e,n,!0),zs(n,()=>{Ne(e),t&&t()})}function zs(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var a of e)a.out(r)}else t()}function Br(e,t,n){if((e.f&rt)===0){if(e.f^=rt,e.transitions!==null)for(const i of e.transitions)(i.is_global||n)&&t.push(i);for(var r=e.first;r!==null;){var a=r.next,o=(r.f&Sn)!==0||(r.f&yt)!==0;Br(r,t,o?n:!1),r=a}}}function sn(e){Js(e,!0)}function Js(e,t){if((e.f&rt)!==0){e.f^=rt,(e.f&he)===0&&(Re(e,Ve),cn(e));for(var n=e.first;n!==null;){var r=n.next,a=(n.f&Sn)!==0||(n.f&yt)!==0;Js(n,a?t:!1),n=r}if(e.transitions!==null)for(const o of e.transitions)(o.is_global||t)&&o.in()}}const bo=["touchstart","touchmove"];function wo(e){return bo.includes(e)}const Xs=new Set,$r=new Set;function st(e){for(var t=0;t<e.length;t++)Xs.add(e[t]);for(var n of $r)n(e)}let as=null;function Tn(e){var t=this,n=t.ownerDocument,r=e.type,a=e.composedPath?.()||[],o=a[0]||e.target;as=e;var i=0,c=as===e&&e.__root;if(c){var l=a.indexOf(c);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=a.indexOf(t);if(u===-1)return;l<=u&&(i=l)}if(o=a[i]||e.target,o!==t){Dn(e,"currentTarget",{configurable:!0,get(){return o||n}});var f=j,d=F;ge(null),ze(null);try{for(var p,_=[];o!==null;){var h=o.assignedSlot||o.parentNode||o.host||null;try{var g=o["__"+r];if(g!=null&&(!o.disabled||e.target===o))if(zn(g)){var[m,...k]=g;m.apply(o,[e,...k])}else g.call(o,e)}catch(b){p?_.push(b):p=b}if(e.cancelBubble||h===t||h===null)break;o=h}if(p){for(let b of _)queueMicrotask(()=>{throw b});throw p}}finally{e.__root=t,delete e.currentTarget,ge(f),ze(d)}}}function yo(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Gn(e,t){var n=F;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function L(e,t){var n=(t&Ua)!==0,r=(t&Na)!==0,a,o=!e.startsWith("<!>");return()=>{a===void 0&&(a=yo(o?e:"<!>"+e),n||(a=Bn(a)));var i=r||xs?document.importNode(a,!0):a.cloneNode(!0);if(n){var c=Bn(i),l=i.lastChild;Gn(c,l)}else Gn(i,i);return i}}function os(e=""){{var t=hn(e+"");return Gn(t,t),t}}function lt(){var e=document.createDocumentFragment(),t=document.createComment(""),n=hn();return e.append(t,n),Gn(t,n),e}function S(e,t){e!==null&&e.before(t)}function pe(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function is(e,t){return ko(e,t)}const Xt=new Map;function ko(e,{target:t,anchor:n,props:r={},events:a,context:o,intro:i=!0}){Ga();var c=new Set,l=d=>{for(var p=0;p<d.length;p++){var _=d[p];if(!c.has(_)){c.add(_);var h=wo(_);t.addEventListener(_,Tn,{passive:h});var g=Xt.get(_);g===void 0?(document.addEventListener(_,Tn,{passive:h}),Xt.set(_,1)):Xt.set(_,g+1)}}};l(Rr(Xs)),$r.add(l);var u=void 0,f=po(()=>{var d=n??t.appendChild(hn());return Za(d,{pending:()=>{}},p=>{if(o){me({});var _=ee;_.c=o}a&&(r.$$events=a),u=e(p,r)||{},o&&be()}),()=>{for(var p of c){t.removeEventListener(p,Tn);var _=Xt.get(p);--_===0?(document.removeEventListener(p,Tn),Xt.delete(p)):Xt.set(p,_)}$r.delete(l),d!==n&&d.parentNode?.removeChild(d)}});return xo.set(u,f),u}let xo=new WeakMap;const ur=0,On=1,fr=2;function ls(e,t,n,r,a){var o=e,i=vn(),c=ee,l=ce,u,f,d,p=i?bt(void 0):We(void 0,!1,!1),_=i?bt(void 0):We(void 0,!1,!1),h=!1;function g(k,b){h=!0,b&&(ze(m),ge(m),Tt(c));try{k===ur&&n&&(u?sn(u):u=xe(()=>n(o))),k===On&&r&&(f?sn(f):f=xe(()=>r(o,p))),k===fr&&a&&(d?sn(d):d=xe(()=>a(o,_))),k!==ur&&u&&ht(u,()=>u=null),k!==On&&f&&ht(f,()=>f=null),k!==fr&&d&&ht(d,()=>d=null)}finally{b&&(Tt(null),ge(null),ze(null),Rs())}}var m=Cn(()=>{if(l!==(l=t())){if(ha(l)){var k=l;h=!1,k.then(b=>{k===l&&(ct(p,b),g(On,!0))},b=>{if(k===l&&(ct(_,b),g(fr,!0),!a))throw _.v}),pn(()=>{h||g(ur,!0)})}else ct(p,l),g(On,!1);return()=>l=ce}})}function X(e,t,n=!1){var r=e,a=null,o=null,i=ce,c=n?Sn:0,l=!1;const u=(_,h=!0)=>{l=!0,p(h,_)};var f=null;function d(){f!==null&&(f.lastChild.remove(),r.before(f),f=null);var _=i?a:o,h=i?o:a;_&&sn(_),h&&ht(h,()=>{i?o=null:a=null})}const p=(_,h)=>{if(i!==(i=_)){var g=Es(),m=r;if(g&&(f=document.createDocumentFragment(),f.append(m=hn())),i?a??=h&&xe(()=>h(m)):o??=h&&xe(()=>h(m)),g){var k=K,b=i?a:o,N=i?o:a;b&&k.skipped_effects.delete(b),N&&k.skipped_effects.add(N),k.add_callback(d)}else d()}};Cn(()=>{l=!1,t(u),l||p(null,null)},c)}function Dt(e,t){return t}function So(e,t,n){for(var r=e.items,a=[],o=t.length,i=0;i<o;i++)Br(t[i].e,a,!0);var c=o>0&&a.length===0&&n!==null;if(c){var l=n.parentNode;Va(l),l.append(n),r.clear(),it(e,t[0].prev,t[o-1].next)}zs(a,()=>{for(var u=0;u<o;u++){var f=t[u];c||(r.delete(f.k),it(e,f.prev,f.next)),Ne(f.e,!c)}})}function Rt(e,t,n,r,a,o=null){var i=e,c={flags:t,items:new Map,first:null},l=(t&ys)!==0;if(l){var u=e;i=u.appendChild(hn())}var f=null,d=!1,p=new Map,_=Hr(()=>{var k=n();return zn(k)?k:k==null?[]:Rr(k)}),h,g;function m(){$o(g,h,c,p,i,a,t,r,n),o!==null&&(h.length===0?f?sn(f):f=xe(()=>o(i)):f!==null&&ht(f,()=>{f=null}))}Cn(()=>{g??=F,h=v(_);var k=h.length;if(!(d&&k===0)){d=k===0;var b,N,D,U;if(Es()){var x=new Set,E=K;for(N=0;N<k;N+=1){D=h[N],U=r(D,N);var M=c.items.get(U)??p.get(U);M?(t&(Xn|Yn))!==0&&Ys(M,D,N,t):(b=Zs(null,c,null,null,D,U,N,a,t,n,!0),p.set(U,b)),x.add(U)}for(const[q,te]of c.items)x.has(q)||E.skipped_effects.add(te.e);E.add_callback(m)}else m();v(_)}})}function $o(e,t,n,r,a,o,i,c,l){var u=(i&Oa)!==0,f=(i&(Xn|Yn))!==0,d=t.length,p=n.items,_=n.first,h=_,g,m=null,k,b=[],N=[],D,U,x,E;if(u)for(E=0;E<d;E+=1)D=t[E],U=c(D,E),x=p.get(U),x!==void 0&&(x.a?.measure(),(k??=new Set).add(x));for(E=0;E<d;E+=1){if(D=t[E],U=c(D,E),x=p.get(U),x===void 0){var M=r.get(U);if(M!==void 0){r.delete(U),p.set(U,M);var q=m?m.next:h;it(n,m,M),it(n,M,q),dr(M,q,a),m=M}else{var te=h?h.e.nodes_start:a;m=Zs(te,n,m,m===null?n.first:m.next,D,U,E,o,i,l)}p.set(U,m),b=[],N=[],h=m.next;continue}if(f&&Ys(x,D,E,i),(x.e.f&rt)!==0&&(sn(x.e),u&&(x.a?.unfix(),(k??=new Set).delete(x))),x!==h){if(g!==void 0&&g.has(x)){if(b.length<N.length){var re=N[0],ne;m=re.prev;var Me=b[0],V=b[b.length-1];for(ne=0;ne<b.length;ne+=1)dr(b[ne],re,a);for(ne=0;ne<N.length;ne+=1)g.delete(N[ne]);it(n,Me.prev,V.next),it(n,m,Me),it(n,V,re),h=re,m=V,E-=1,b=[],N=[]}else g.delete(x),dr(x,h,a),it(n,x.prev,x.next),it(n,x,m===null?n.first:m.next),it(n,m,x),m=x;continue}for(b=[],N=[];h!==null&&h.k!==U;)(h.e.f&rt)===0&&(g??=new Set).add(h),N.push(h),h=h.next;if(h===null)continue;x=h}b.push(x),m=x,h=x.next}if(h!==null||g!==void 0){for(var Se=g===void 0?[]:Rr(g);h!==null;)(h.e.f&rt)===0&&Se.push(h),h=h.next;var ue=Se.length;if(ue>0){var De=(i&ys)!==0&&d===0?a:null;if(u){for(E=0;E<ue;E+=1)Se[E].a?.measure();for(E=0;E<ue;E+=1)Se[E].a?.fix()}So(n,Se,De)}}u&&pn(()=>{if(k!==void 0)for(x of k)x.a?.apply()}),e.first=n.first&&n.first.e,e.last=m&&m.e;for(var at of r.values())Ne(at.e);r.clear()}function Ys(e,t,n,r){(r&Xn)!==0&&ct(e.v,t),(r&Yn)!==0?ct(e.i,n):e.i=n}function Zs(e,t,n,r,a,o,i,c,l,u,f){var d=(l&Xn)!==0,p=(l&Aa)===0,_=d?p?We(a,!1,!1):bt(a):a,h=(l&Yn)===0?i:bt(i),g={i:h,v:_,k:o,a:null,e:null,prev:n,next:r};try{if(e===null){var m=document.createDocumentFragment();m.append(e=hn())}return g.e=xe(()=>c(e,_,h,u),Ba),g.e.prev=n&&n.e,g.e.next=r&&r.e,n===null?f||(t.first=g):(n.next=g,n.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function dr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,a=t?t.e.nodes_start:n,o=e.e.nodes_start;o!==null&&o!==r;){var i=En(o);a.before(o),o=i}}function it(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Vn(e,t,...n){var r=e,a=nt,o;Cn(()=>{a!==(a=t())&&(o&&(Ne(o),o=null),o=xe(()=>a(r,...n)))},Sn)}function Eo(e,t,n){qr(()=>{var r=P(()=>t(e,n?.())||{});if(n&&r?.update){var a=!1,o={};Ln(()=>{var i=n();Fs(i),a&&Nr(o,i)&&(o=i,r.update(i))}),a=!0}if(r?.destroy)return()=>r.destroy()})}function Ks(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Ks(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Lo(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Ks(e))&&(r&&(r+=" "),r+=t);return r}function Hn(e){return typeof e=="object"?Lo(e):e??""}const cs=[...` 	
\r\fÂ \v\uFEFF`];function Co(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var o=a.length,i=0;(i=r.indexOf(a,i))>=0;){var c=i+o;(i===0||cs.includes(r[i-1]))&&(c===r.length||cs.includes(r[c]))?r=(i===0?"":r.substring(0,i))+r.substring(c+1):i=c}}return r===""?null:r}function Pe(e,t,n,r,a,o){var i=e.__className;if(i!==n||i===void 0){var c=Co(n,r,o);c==null?e.removeAttribute("class"):e.className=c,e.__className=n}else if(o&&a!==o)for(var l in o){var u=!!o[l];(a==null||u!==!!a[l])&&e.classList.toggle(l,u)}return o}function Wr(e,t,n=!1){if(e.multiple){if(t==null)return;if(!zn(t))return Fa();for(var r of e.options)r.selected=t.includes(kn(r));return}for(r of e.options){var a=kn(r);if(Wa(a,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Qs(e){var t=new MutationObserver(()=>{Wr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Fr(()=>{t.disconnect()})}function Gr(e,t,n=t){var r=!0;jr(e,"change",a=>{var o=a?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(o),kn);else{var c=e.querySelector(o)??e.querySelector("option:not([disabled])");i=c&&kn(c)}n(i)}),qr(()=>{var a=t();if(Wr(e,a,r),r&&a===void 0){var o=e.querySelector(":checked");o!==null&&(a=kn(o),n(a))}e.__value=a,r=!1}),Qs(e)}function kn(e){return"__value"in e?e.__value:e.value}const Ro=Symbol("is custom element"),Po=Symbol("is html");function gt(e,t,n,r){var a=Io(e);a[t]!==(a[t]=n)&&(t==="loading"&&(e[ya]=n),n==null?e.removeAttribute(t):typeof n!="string"&&To(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Io(e){return e.__attributes??={[Ro]:e.nodeName.includes("-"),[Po]:e.namespaceURI===Ha}}var us=new Map;function To(e){var t=e.getAttribute("is")||e.nodeName,n=us.get(t);if(n)return n;us.set(t,n=[]);for(var r,a=e,o=Element.prototype;o!==a;){r=hs(a);for(var i in r)r[i].set&&n.push(i);a=Pr(a)}return n}function jt(e,t,n=t){var r=new WeakSet;jr(e,"input",async a=>{var o=a?e.defaultValue:e.value;if(o=_r(e)?vr(o):o,n(o),K!==null&&r.add(K),await co(),o!==(o=t())){var i=e.selectionStart,c=e.selectionEnd;e.value=o??"",c!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(c,e.value.length))}}),P(t)==null&&e.value&&(n(_r(e)?vr(e.value):e.value),K!==null&&r.add(K)),Ln(()=>{var a=t();if(e===document.activeElement){var o=Nn??K;if(r.has(o))return}_r(e)&&a===vr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function an(e,t,n=t){jr(e,"change",r=>{var a=r?e.defaultChecked:e.checked;n(a)}),P(t)==null&&n(e.checked),Ln(()=>{var r=t();e.checked=!!r})}function _r(e){var t=e.type;return t==="number"||t==="range"}function vr(e){return e===""?null:+e}function ea(e,t,n){var r=tn(e,t);r&&r.set&&(e[t]=n,Fr(()=>{e[t]=null}))}function fs(e,t){return e===t||e?.[Pt]===t}function wt(e={},t,n,r){return qr(()=>{var a,o;return Ln(()=>{a=o,o=[],P(()=>{e!==n(...o)&&(t(e,...o),a&&fs(n(...a),e)&&t(null,...a))})}),()=>{pn(()=>{o&&fs(n(...o),e)&&t(null,...o)})}}),e}function At(e=!1){const t=ee,n=t.l.u;if(!n)return;let r=()=>Fs(t.s);if(e){let a=0,o={};const i=Kn(()=>{let c=!1;const l=t.s;for(const u in l)l[u]!==o[u]&&(o[u]=l[u],c=!0);return c&&a++,a});r=()=>v(i)}n.b.length&&vo(()=>{ds(t,r),jn(n.b)}),un(()=>{const a=P(()=>n.m.map(ga));return()=>{for(const o of a)typeof o=="function"&&o()}}),n.a.length&&un(()=>{ds(t,r),jn(n.a)})}function ds(e,t){if(e.l.s)for(const n of e.l.s)v(n);t()}let Er=Symbol();function ve(e,t,n){const r=n[t]??={store:null,source:We(void 0),unsubscribe:nt};if(r.store!==e&&!(Er in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=nt;else{var a=!0;r.unsubscribe=ta(e,o=>{a?r.source.v=o:R(r.source,o)}),a=!1}return e&&Er in n?Le(e):v(r.source)}function An(e,t){return e.set(t),t}function Je(){const e={};function t(){Fr(()=>{for(var n in e)e[n].unsubscribe();Dn(e,Er,{enumerable:!1,value:!0})})}return[e,t]}function ie(e,t,n){return e.set(n),t}function on(e,t,n,r){var a=r,o=!0,i=()=>(o&&(o=!1,a=r),a),c;c=e[t],c===void 0&&r!==void 0&&(c=i());var l;return l=()=>{var u=e[t];return u===void 0?i():(o=!0,u)},l}function Vr(e){ee===null&&ws(),$n&&ee.l!==null?Ao(ee).m.push(e):un(()=>{const t=P(e);if(typeof t=="function")return t})}function Oo(e){ee===null&&ws(),Vr(()=>()=>P(e))}function Ao(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function ta(e,t,n){if(e==null)return t(void 0),nt;const r=P(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Yt=[];function Bt(e,t=nt){let n=null;const r=new Set;function a(c){if(Nr(e,c)&&(e=c,n)){const l=!Yt.length;for(const u of r)u[1](),Yt.push(u,e);if(l){for(let u=0;u<Yt.length;u+=2)Yt[u][0](Yt[u+1]);Yt.length=0}}}function o(c){a(c(e))}function i(c,l=nt){const u=[c,l];return r.add(u),r.size===1&&(n=t(a,o)||nt),c(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:a,update:o,subscribe:i}}function Le(e){let t;return ta(e,n=>t=n)(),t}var Lr=(e=>(e.info="info",e.warn="warn",e.error="error",e))(Lr||{});class Uo{logs=Bt([]);_addLog(t,n){this.logs.update(r=>(r.unshift({date:new Date,severity:t,content:n}),r))}info(t){this._addLog("info",t)}warn(t){this._addLog("warn",t)}error(t){this._addLog("error",t)}updateLogAtIndex(t,n){this.logs.update(r=>(r[t]&&(r[t].content=n),r))}}const A=new Uo;function No(e,t){let n=!1;return e.subscribe(r=>{n?t(r):n=!0})}const Ho={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,discard_expired_sessions:!0,rs_launch_command:null,osrs_launch_command:null,runelite_custom_jar:null,runelite_launch_command:null,hdos_launch_command:null,selected:{game:Ee.osrs,client:en.runelite,user_id:null},userDetails:{}};function Mo(){const t=new URLSearchParams(window.location.search).get("config");function n(a){return typeof a=="object"&&typeof a.use_dark_theme=="boolean"&&typeof a.rs_plugin_loader=="boolean"&&typeof a.close_after_launch=="boolean"&&typeof a.check_announcements=="boolean"&&typeof a.flatpak_rich_presence=="boolean"&&typeof a.runelite_use_custom_jar=="boolean"&&typeof a.selected=="object"&&Object.values(Ee).includes(a.selected.game)&&Object.values(en).includes(a.selected.client)&&(typeof a.selected.user_id=="string"||a.selected.user_id===null)&&typeof a.userDetails=="object"}const{config:r}=O;if(t)try{const a=JSON.parse(t);typeof a.check_announcements>"u"&&(a.check_announcements=!0,O.configHasPendingChanges=!0),typeof a.close_after_launch>"u"&&(a.close_after_launch=!1,O.configHasPendingChanges=!0),typeof a.discard_expired_sessions>"u"&&(a.discard_expired_sessions=!0,O.configHasPendingChanges=!0),n(a)?r.set(a):(A.error("The config saved on disk is not the correct format. It has been restored to default."),O.configHasPendingChanges=!0)}catch{A.error("Unable to parse config, restoring to default"),O.configHasPendingChanges=!0}else O.configHasPendingChanges=!0;No(O.config,()=>{O.configHasPendingChanges=!0})}const O={initialized:Bt(!1),configHasPendingChanges:!1,pluginConfigHasPendingChanges:!1,config:Bt(Ho),sessions:Bt([])};let pr=!1,hr=!1;class fe{static async login(t,n){const r=await Mn.buildSession(t,n);if(!r.ok)return ae(r.error);const a=r.value,i=Le(O.sessions).findIndex(c=>c.user.userId===t.sub);return i!==-1?O.sessions.update(c=>(c[i]=a,c)):(O.sessions.update(c=>(c.push(a),c)),O.config.update(c=>(c.selected.user_id=a.user.userId,c))),et(a)}static async logout(t){const{sessions:n,config:r}=O;return n.update(a=>{const o=a.findIndex(i=>i.user.userId===t);return o>-1&&(Ce.revokeOauthCreds(a[o].tokens.access_token),a.splice(o,1)),a}),r.update(a=>(typeof a.userDetails[t]<"u"&&delete a.userDetails[t],a.selected.user_id===t&&(a.selected.user_id=null),a)),Le(n)}static postJSON(t,n,r=null){const a=JSON.stringify(n);return fetch(t,{method:"POST",body:a,headers:{"Content-Type":"application/json"}}).then(i=>{i.ok||i.text().then(c=>A.error(`${t} error: ${i.status}: ${c}`)),r&&r(i)})}static saveConfig(t=!0){if(pr||t&&!O.configHasPendingChanges)return;pr=!0;const n=Le(O.config);return n.rs_launch_command===""&&(n.rs_launch_command=null),n.osrs_launch_command===""&&(n.osrs_launch_command=null),n.runelite_launch_command===""&&(n.runelite_launch_command=null),n.hdos_launch_command===""&&(n.hdos_launch_command=null),this.postJSON("/save-config",n,()=>pr=!1),n}static savePluginConfig(t=!0){hr||t&&!O.pluginConfigHasPendingChanges||(hr=!0,this.postJSON("/save-plugin-config",$.pluginConfig,()=>hr=!1))}static async saveCredentials(){return this.postJSON("/save-credentials",Le(O.sessions))}static async openFilePicker(){const t=await fetch("/jar-file-picker");return t.status===200?t.text():null}static findSession(t){return Le(O.sessions).find(r=>r.user.userId===t)}static findAccount(t,n){return t.find(r=>r.accountId==n)}}const Cr=Bt([]),Do="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Do);Ta();var jo=L("<main><!></main>");function na(e,t){const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme);var c=jo();let l;var u=C(c);Vn(u,()=>t.children??nt),W(f=>l=Pe(c,1,"fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50",null,l,f),[()=>({dark:v(i)})]),S(e,c),a()}var Fo=L('<div class="flex h-full items-center justify-center"><img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/></div>');function qo(e,t){me(t,!1);const n=window.opener;$.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function r(c){const l=Kt.get("auth_verifier");if(!l)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:u,redirect:f}=$.env,d=await Ce.getOAuthToken($.env.origin,u,l,f,c);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function a(c){const l=Kt.get("auth_nonce"),u=Ce.validateIdToken(c,l??"");if(!u.ok)return o(u.error),null;const f=await Ce.getSessionId($.env.auth_api,c);return f.ok?f.value:(o(`Unable to retreive session id. ${f.error}`),null)}function o(c){i({type:"authFailed",reason:c}),fetch("/close")}function i(c){n.postMessage(c,window.location.origin)}Vr(async()=>{const c=new URLSearchParams(window.location.search),l=c.get("code"),u=c.get("state"),f=c.get("id_token");if(f==null&&l&&u){const d=await r(l);if(!d)return o("tokens object is null.");i({type:"authTokenUpdate",tokens:d});const p=crypto.randomUUID();Ce.navigateToAuthConsent($.env.origin,d.id_token,p)}else if(f&&l&&u){const d=await a(f);if(!d)return o("sessionId is null");i({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),Oo(()=>{Kt.remove("auth_verifier"),Kt.remove("auth_nonce")}),At(),na(e,{children:(c,l)=>{var u=Fo();S(c,u)}}),be()}var Bo=(e,t,n)=>{e.key==="Escape"&&(e.preventDefault(),t()&&n())},Wo=L('<button class="absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button>'),Go=L("<dialog><!> <!></dialog>");function er(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme),c=on(t,"class",3,""),l=on(t,"canSelfClose",3,!0),u=on(t,"onClose",3,()=>{}),f,d=oe(!1);function p(){f.showModal(),R(d,!0)}function _(){u()(),f.close(),R(d,!1)}var h={open:p,close:_},g=Go();g.__keydown=[Bo,l,_],g.__mousedown=x=>{f===x.target&&_()};let m;var k=C(g);{var b=x=>{var E=Wo();E.__click=_,S(x,E)};X(k,x=>{l()&&x(b)})}var N=w(k,2);{var D=x=>{var E=lt(),M=B(E);Vn(M,()=>t.children??nt),S(x,E)};X(N,x=>{v(d)&&x(D)})}wt(g,x=>f=x,()=>f),W(x=>m=Pe(g,1,`${c()??""} backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none`,"svelte-1nslvnn",m,x),[()=>({dark:v(i)})]),S(e,g);var U=be(h);return a(),U}st(["keydown","mousedown","click"]);var Vo=(e,t)=>v(t).close(),zo=L('<p class="p-2"></p> <p class="p-2"></p> <button class="m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75">I Understand</button>',1);function Jo(e,t){me(t,!1);const n=()=>ve(o,"$sessions",r),[r,a]=Je(),{sessions:o}=O;let i=We();Vr(()=>{n().length==0&&v(i).open()}),At(),wt(er(e,{canSelfClose:!1,class:"w-1/2 text-center",children:(c,l)=>{var u=zo(),f=B(u);f.textContent=atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==");var d=w(f,2);d.textContent=atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu");var p=w(d,2);p.__click=[Vo,i],S(c,u)},$$slots:{default:!0},$$legacy:!0}),c=>R(i,c),()=>v(i)),be(),a()}st(["click"]);const Ue={method:"GET"},Xo={"Content-Type":"application/octet-stream"};let gr=null;const Yo=120*1e3,Zo="https://api.github.com/repos/runelite/launcher/releases",Ko="https://cdn.hdos.dev/client/getdown.txt",tr=e=>e?{method:"POST",headers:Xo,body:e}:Ue,mt=(e,t,n,r)=>{fetch(e,t).then(a=>{a.ok?n(a):(a.text().then(o=>A.error(`request failed: ${a.url}: ${a.status}: ${o}`)),r())}).catch(()=>{A.error(`request failed: ${e}: connection error`),r()})},zr=async(e,t,n,r,a)=>{const o=p=>{A.error(`error downloading: ${p}`),r()};A.info(t);const i=p=>A.updateLogAtIndex(0,`${t} ${p}`);if(!e.body)return o("no HTTP response body");const c=e.body.getReader();if(!c)return o("invalid HTTP response");const l=e.headers.get("content-length")??a;if(!l)return o("cannot estimate download size");const u=parseInt(l);if(!l)return o("cannot estimate download size");const f=new Uint8Array(u);let d=0;for(;;){const p=await c.read();if(p.done)break;const _=p.value;f.set(_,d),d+=_.length;const h=(Math.round(1e3*d/u)/10).toFixed(1);i(h)}i("done"),n(f)};function Qo(e,t,n){const r=(c,l)=>{const u={},f=Le(O.config);c&&(u.hash=c),e&&(u.jx_session_id=e),t&&(u.jx_character_id=t),n&&(u.jx_display_name=n),f.rs_launch_command&&f.rs_launch_command.length>0&&(u.launch_command=f.rs_launch_command),f.rs_plugin_loader&&(u.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?u.config_uri=f.rs_config_uri:u.config_uri=$.env.default_config_uri,fetch("/launch-rs3-deb?".concat(new URLSearchParams(u).toString()),tr(l)).then(d=>{d.text().then(p=>A.info(`game launch status: '${p.trim()}'`)),d.ok&&(c&&($.rs3debInstalledHash=c),f.close_after_launch&&!f.rs_plugin_loader&&fetch("/close"))})},a=()=>{$.rs3debInstalledHash&&r()},o=$.env.content_url,i=o.concat("dists/trusty/non-free/binary-amd64/Packages");mt(i,Ue,c=>c.text().then(l=>{const u=Object.fromEntries(l.split(`
`).map(f=>f.split(": ")));if(!u.Filename||!u.Size||!u.SHA256){A.error(`could not parse package data from URL: ${i}`),a();return}if(u.SHA256===$.rs3debInstalledHash){A.info("game client is up-to-date"),r();return}mt(o.concat(u.Filename),Ue,f=>zr(f,"downloading RS3 client...",d=>r(u.SHA256,d),r,u.Size),a)}),a)}function ra(e,t,n,r){const a=r?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",o=Le(O.config),i=(l,u,f)=>{const d={};l&&(d.id=l),f&&(d.jar_path=f),e&&(d.jx_session_id=e),t&&(d.jx_character_id=t),n&&(d.jx_display_name=n),o.runelite_launch_command&&o.runelite_launch_command!==""&&(d.launch_command=o.runelite_launch_command),o.flatpak_rich_presence&&(d.flatpak_rich_presence=""),fetch(a.concat(new URLSearchParams(d).toString()),tr(u)).then(p=>{p.text().then(_=>A.info(`game launch status: '${_.trim()}'`)),p.ok&&(l&&($.runeLiteInstalledId=l),o.close_after_launch&&!r&&fetch("/close"))})},c=()=>{$.runeLiteInstalledId&&i()};if(o.runelite_use_custom_jar){i(null,null,o.runelite_custom_jar);return}if($.runeLiteInstalledId!==null&&gr!==null&&gr+Yo>Date.now()){i();return}mt(Zo,Ue,l=>l.json().then(u=>{gr=Date.now();const f=u.map(d=>d.assets).flat().find(d=>d.name.toLowerCase()=="runelite.jar");if(!f){A.info("note: no runelite releases found, so skipping update check"),c();return}if(f.id==$.runeLiteInstalledId){A.info("game is up-to-date"),i();return}mt(f.browser_download_url,Ue,d=>zr(d,"downloading RuneLite launcher...",p=>i(f.id,p),c,f.size),c)}),c)}function ei(e,t,n){const r=Le(O.config),a=(i,c)=>{const l={};i&&(l.version=i),e&&(l.jx_session_id=e),t&&(l.jx_character_id=t),n&&(l.jx_display_name=n),r.hdos_launch_command&&r.hdos_launch_command.length>0&&(l.launch_command=r.hdos_launch_command),fetch("/launch-hdos-jar?".concat(new URLSearchParams(l).toString()),tr(c)).then(u=>{u.text().then(f=>A.info(`game launch status: '${f.trim()}'`)),u.ok&&(i&&($.hdosInstalledVersion=i),r.close_after_launch&&fetch("/close"))})},o=()=>{$.hdosInstalledVersion&&a()};mt(Ko,Ue,i=>i.text().then(c=>{const l=c.match(/^launcher\.version *= *(.*?)$/m);if(!l||l.length<2){A.error("couldn't parse latest launcher version"),o();return}const u=l[1];if(u===$.hdosInstalledVersion){A.info("game is up-to-date"),a();return}mt(`https://cdn.hdos.dev/launcher/v${u}/hdos-launcher.jar`,Ue,f=>zr(f,"downloading HDOS launcher...",d=>a(u,d),o),o)}),o)}function mr(){fetch("/list-game-clients",Ue).then(e=>{e.ok||e.text().then(t=>A.error(`failed to get client list: ${e.status}: ${t}`))})}function _s(e,t,n,r,a){const o=`${t?"osrs":$.env.provider}-${e?"win":"mac"}`,i=t?"osrs":"rs3",c=e?"exe":"app",l=`${i}${c}InstalledHash`,u=(d,p)=>{const _={},h=Le(O.config),g=t?h.osrs_launch_command:h.rs_launch_command;d&&(_.hash=d),n&&(_.jx_session_id=n),r&&(_.jx_character_id=r),a&&(_.jx_display_name=a),g&&g!==""&&(_.launch_command=g),t||(h.rs_plugin_loader&&(_.plugin_loader="1"),_.config_uri=h.use_custom_rs_config_uri&&h.rs_config_uri?h.rs_config_uri:$.env.default_config_uri);const m=k=>fetch(`/launch-${i}-${c}?${new URLSearchParams(_).toString()}`,k).then(b=>{b.text().then(N=>A.info(`game launch status: '${N.trim()}'`)),b.ok&&(d&&($[l]=d),h.close_after_launch&&(t||!h.rs_plugin_loader)&&fetch("/close"))});p?p.then(k=>m(tr(k))):m(Ue)},f=()=>{$.hdosInstalledVersion&&u()};mt(`${$.env.direct6_url}${o}/${o}.json`,Ue,d=>d.text().then(p=>{const _=JSON.parse(atob(p.split(".")[1])).environments.production;if($[l]===_.id){A.info("game client is up-to-date"),u();return}A.info(`downloading client version ${_.version}...`),mt(`${$.env.direct6_url}${o}/catalog/${_.id}/catalog.json`,Ue,h=>h.text().then(g=>{const m=JSON.parse(atob(g.split(".")[1])),k=b=>b.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:");mt(k(m.metafile),Ue,b=>b.text().then(N=>{const D=JSON.parse(atob(N.split(".")[1])),U=D.pieces.digests.map(M=>{const q=atob(M).split("").map(re=>re.charCodeAt(0).toString(16).padStart(2,"0")).join(""),te=k(m.config.remote.baseUrl).concat(m.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",q.substring(0,2)).replace("{TargetDigest}",q));return fetch(te,Ue).then(re=>re.blob().then(ne=>{const Me=new DecompressionStream("gzip");return new Response(ne.slice(6).stream().pipeThrough(Me)).blob()}))});let x=0,E=null;for(let M=0;M<D.files.length;M+=1)if(e?D.files[M].name.endsWith(".exe"):D.files[M].name.includes(".app/Contents/MacOS/"))if(E!==null){A.error(`can't parse ${b.url}: file list has multiple possibilities for main exe`),f();return}else E=D.files[M].size;else E===null&&(x+=D.files[M].size);if(E===null){A.error(`can't parse ${b.url}: file list has no possibilities for main exe`),f();return}Promise.all(U).then(M=>{const q=new Blob(M).slice(x,x+E);u(D.id,q.arrayBuffer())})}),f)}),f)}),f)}var ti=(e,t)=>{v(t).close()},ni=(e,t,n,r,a)=>{v(t)(v(n),v(r)),v(a).close()},ri=L('<div><h2 class="text-3xl font-extrabold">Game is offline</h2> <br/> <p>This game appears to be offline for maintenance or an update. Launch anyway?</p> <div class="align-bottom"><button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">No</button> <button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75">Yes</button></div></div>');function si(e,t){me(t,!1);let n=We(),r=We(),a=We(),o=We();function i(l,u,f){R(o,l),R(r,u),R(a,f),v(n).open()}var c={open:i};return wt(er(e,{class:"h-fit w-3/5 px-5 py-3 text-center",children:(l,u)=>{var f=ri(),d=w(C(f),6),p=C(d);p.__click=[ti,n];var _=w(p,2);_.__click=[ni,o,r,a,n],S(l,f)},$$slots:{default:!0},$$legacy:!0}),l=>R(n,l),()=>v(n)),ea(t,"open",i),be(c)}st(["click"]);const ai=()=>fetch("/open-external-url",{method:"POST",body:"https://bolt.adamcake.com/plugins"});var oi=(e,t)=>R(t,!1),ii=L("<p>(start an RS3 game client with plugins enabled and it will be listed here.)</p>"),li=(e,t,n,r,a,o,i)=>{R(t,v(n).uid,!0),R(r,!0),R(a,!1),R(o,""),R(i,null)},ci=L("<button> </button> <br/>",1),ui=(e,t)=>R(t,null),fi=L('<option class="dark:bg-slate-900"> </option>'),di=(e,t,n)=>{R(t,!v(t)),R(n,"")},_i=(e,t,n,r)=>{t(v(n)),R(r,!1),R(n,"")},vi=(e,t,n)=>{R(t,!1),R(n,"")},pi=L('<label for="plugin-updater-url-input">URL:</label> <textarea rows="1" id="plugin-updater-url-input" class="w-[50%] max-w-[60%] resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800"></textarea> <button title="Confirm" class="select-none rounded-sm bg-emerald-500 hover:opacity-75"><img src="svgs/check-solid.svg" class="h-5 w-5" alt="Confirm"/></button> <button title="Close URL entry" class="select-none rounded-sm bg-rose-500 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button> <br/><br/>',1),hi=L('<br/> <span class="pb-4 text-xl font-bold italic text-slate-600"> </span>',1),gi=L('<p class="pb-4 text-xl font-bold"> <!></p> <p> </p> <br/>',1),mi=L("<p>error</p> <br/>",1),bi=L("<p>loading...</p>"),wi=(e,t,n)=>{const r=t[Q(n)].path;fetch(r?"/browse-directory?".concat(new URLSearchParams({path:r}).toString()):"/browse-plugin-data?".concat(new URLSearchParams({id:Q(n)}).toString()))},yi=(e,t)=>fetch("/browse-plugin-config?".concat(new URLSearchParams({id:Q(t)}).toString())),ki=(e,t,n,r)=>t(v(n),Q(r)),xi=L('<button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Check updates</button> &nbsp;',1),Si=L('<!> <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse data</button> &nbsp; <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse config</button> <br/> <!> <button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500">Remove</button>',1),$i=L(`<p>You have no plugins installed. You can install plugins either from an updater URL, or by
						downloading them onto your computer and selecting the "bolt.json" file.</p>`),Ei=L('<span class="align-middle"><button class="mx-1 aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from updater URL"><img src="svgs/download-solid.svg" alt="Install plugin from updater URL"/></button> <button class="aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from local directory"><img src="svgs/folder-solid.svg" alt="Install plugin from local directory"/></button></span> <br/> <!> <!>',1),Li=(e,t,n,r,a,o,i)=>t(Q(n),Q(r),v(a)??null,v(o).main??i),Ci=L('<button class="mx-auto mb-1 w-auto select-none rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"> </button>'),Ri=L("<p>(no plugins installed)</p>"),Pi=L("<p>can't start plugin: does not appear to be configured</p>"),Ii=(e,t,n,r)=>{t(Q(n),v(r).uid)},Ti=L('<p> <button class="select-none rounded-sm bg-rose-500 shadow-lg hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/></button></p>'),Oi=L("<p> </p>"),Ai=L('<!> <br/> <br/> <hr class="p-1 dark:border-slate-700"/> <!>',1),Ui=L("<p>error</p>"),Ni=L("<p>loading...</p>"),Hi=L("<br/> <!>",1),Mi=L('<select class="mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select> <!>',1),Di=L("<p>error</p>"),ji=L('<p class="text-red-500"> </p>'),Fi=L("<p> </p>"),qi=L("<br/><br/> <!>",1),Bi=L('<div class="left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"><button>Manage Plugins</button> <hr class="p-1 dark:border-slate-700"/> <!></div> <div class="h-full pt-10"><!> <!></div> <div class="absolute bottom-2 right-4"><button class="m-0 cursor-pointer select-none border-none bg-transparent p-0 text-sm text-gray-500 underline">about plugins</button></div>',1);function Wi(e,t){me(t,!0);const n=()=>ve(Cr,"$clientList",r),[r,a]=Je();let o,i=oe(null),c=oe(!1),l=Qt($.pluginConfig);const u=$.platform==="windows"?"\\":"/",f="bolt.json",d=u.concat(f),p="main.lua";function _(){R(De,!1),o.open()}const h=()=>{$.pluginConfig=l,fe.savePluginConfig()},g=y=>{console.log(y),R(i,y,!0),R(c,!1)},m=y=>{console.error(y),R(i,y,!0),R(c,!0)},k=y=>new Promise((I,T)=>{const J=y.concat(y.endsWith(u)?f:d);var H=new XMLHttpRequest;H.onreadystatechange=()=>{H.readyState==4&&(H.status==200?I(JSON.parse(H.responseText)):T(H.responseText))},H.open("GET","/read-json-file?".concat(new URLSearchParams({path:J}).toString()),!0),H.send()}),b=y=>fetch("/get-plugindir-json?".concat(new URLSearchParams({id:y}).toString())).then(I=>I.ok?I.json():null),N=y=>{const I=l[y];if(!I)return null;const T=I.path;return T?k(T):b(y)},D=()=>{const y=Object.keys(l);let I;do I=crypto.randomUUID();while(y.includes(I));return I},U="(unnamed)",x="(new character)",E=(y,I)=>{k(y).then(T=>{R(V,D(),!0),l[Q(V)]={name:T.name??U,path:y,version:T.version},$.pluginConfig=l,O.pluginConfigHasPendingChanges=!0}).catch(T=>m(`config file '${I}' couldn't be fetched, reason: ${T}`))},M=y=>{g("downloading..."),fetch(y).then(async I=>{if(!I.ok){m(`can't install plugin: updater URL returned ${I.status}: ${I.statusText}`);return}const T=await I.json();if(T.url){const J=await fetch(T.url);if(!J.ok){m(`can't install plugin: remote download URL returned ${I.status}: ${I.statusText}`);return}const H=await J.arrayBuffer();if(T.sha256){const Ye=await crypto.subtle.digest("SHA-256",H),Vt=Array.from(new Uint8Array(Ye)).map(mn=>mn.toString(16).padStart(2,"0")).join("");if(T.sha256!==Vt){m("can't install plugin: incorrect file hash");return}}const Z=D();if(!(await fetch("/install-plugin?".concat(new URLSearchParams({id:Z}).toString()),{method:"POST",body:H})).ok){m(`can't install plugin: ${I.statusText}`);return}const ft=await b(Z);ft?(R(V,Z,!0),l[Q(V)]={name:ft.name??U,version:ft.version,updaterURL:y,sha256:T.sha256},$.pluginConfig=l,O.pluginConfigHasPendingChanges=!0,g(`plugin '${ft.name}' installed`)):m(`can't install plugin: ${f} not found`)}}).catch(()=>{m("can't install plugin: unhandled exception")})};let q=oe(!1);const te=()=>{R(q,!0);var y=new XMLHttpRequest;y.onreadystatechange=()=>{if(y.readyState==4&&(R(q,!1),y.status==200))if(y.responseText.endsWith(d)){const I=y.responseText.substring(0,y.responseText.length-f.length);E(I,y.responseText)}else m(`selection '${y.responseText}' is not named ${f}; ignored`)},y.open("GET","/json-file-picker",!0),y.send()};mr();const re=(y,I,T,J)=>{let H=null;if(T){const Xe=$.platform==="windows"?T.replaceAll("\\","/"):T;H=Xe.endsWith(u)?Xe:Xe.concat("/")}var Z=new XMLHttpRequest;Z.onreadystatechange=()=>{Z.readyState==4&&(mr(),A.info(`Start-plugin status: ${Z.statusText.trim()}`))},H?Z.open("GET","/start-plugin?".concat(new URLSearchParams({client:y.toString(),id:I,main:J,path:H}).toString()),!0):Z.open("GET","/start-plugin?".concat(new URLSearchParams({client:y.toString(),id:I,main:J}).toString()),!0),Z.send()},ne=(y,I)=>{var T=new XMLHttpRequest;T.onreadystatechange=()=>{T.readyState==4&&(mr(),A.info(`Stop-plugin status: ${T.statusText.trim()}`))},T.open("GET","/stop-plugin?".concat(new URLSearchParams({client:y.toString(),uid:I.toString()}).toString()),!0),T.send()},Me=(y,I)=>{const T=y.updaterURL;fetch(T).then(async J=>{if(!J.ok){m(`can't update plugin: updater URL returned ${J.status}: ${J.statusText}`);return}let H=await J.json();if(!H.url){g(`can't update plugin '${y.name}': no remote download URL is configured`);return}let Z=!1;if(H.sha256?y.sha256!==H.sha256&&(Z=!0):H.version&&y.version!==H.version&&(Z=!0),Z){const Xe=await fetch(H.url);if(!Xe.ok){m(`can't update plugin: remote download URL returned ${Xe.status}: ${Xe.statusText}`);return}const ft=await Xe.arrayBuffer();if(H.sha256){const Vt=await crypto.subtle.digest("SHA-256",ft),mn=Array.from(new Uint8Array(Vt)).map(nr=>nr.toString(16).padStart(2,"0")).join("");if(H.sha256!==mn){m(`can't update plugin '${y.name}': incorrect file hash`);return}}fetch("/install-plugin?".concat(new URLSearchParams({id:I}).toString()),{method:"POST",body:ft});const Ye=await b(I);Ye?(H.sha256&&(y.sha256=H.sha256),Ye.name&&(y.name=Ye.name),Ye.version&&(y.version=Ye.version),O.pluginConfigHasPendingChanges=!0,g(`plugin '${Ye.name}' updated`)):m(`can't update plugin '${y.name}': ${f} not found`)}else g(`plugin '${y.name}' is already up-to-date`)})};var V=oe(""),Se=oe(!1),ue=oe(0);let De=oe(!1),at=oe("");un(()=>{n().some(y=>y.uid===Q(ue))||R(Se,!1)});let Ie=Be(()=>l[Q(V)]),kt=Be(()=>N(Q(V)));un(()=>{v(kt)&&v(kt).then(y=>{let I=!1;y.name!==v(Ie).name&&(v(Ie).name=y.name,I=!0),y.version!==v(Ie).version&&(v(Ie).version=y.version,I=!0),I&&(R(Ie,v(Ie)),O.pluginConfigHasPendingChanges=!0)})});let z=Be(()=>v(Ie)?v(Ie).path:null);var Y={open:_};wt(er(e,{class:"h-[90%] w-[90%] text-center",onClose:h,children:(y,I)=>{var T=Bi(),J=B(T),H=C(J);H.__click=[oi,Se];var Z=w(H,4);{var Xe=de=>{var je=ii();S(de,je)},ft=de=>{var je=lt(),xt=B(je);Rt(xt,1,n,Dt,(bn,Ut)=>{var Ze=ci(),se=B(Ze);se.__click=[li,ue,Ut,Se,De,at,i];var Te=C(se);W(()=>{Pe(se,1,`m-1 h-[28px] w-[95%] select-none rounded-lg border-2 ${Q(Se)&&Q(ue)===v(Ut).uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white"} hover:opacity-75`),pe(Te,v(Ut).identity||x)}),S(bn,Ze)}),S(de,je)};X(Z,de=>{n().length==0?de(Xe):de(ft,!1)})}var Ye=w(J,2),Vt=C(Ye);{var mn=de=>{var je=Mi(),xt=B(je);xt.__change=[ui,i],Rt(xt,21,()=>Object.entries(l),Dt,(se,Te)=>{var Nt=Be(()=>ba(v(Te),2));let Fe=()=>v(Nt)[0],Oe=()=>v(Nt)[1];var ot=fi(),zt=C(ot),Jt={};W(()=>{pe(zt,Oe().name??U),Jt!==(Jt=Fe())&&(ot.value=(ot.__value=Fe())??"")}),S(se,ot)});var bn=w(xt,2);{var Ut=se=>{var Te=Ei(),Nt=B(Te),Fe=C(Nt);Fe.__click=[di,De,at];var Oe=w(Fe,2);Oe.__click=te;var ot=w(Nt,4);{var zt=le=>{var _e=pi(),Ke=w(B(_e),2),St=w(Ke,2);St.__click=[_i,M,at,De];var dt=w(St,2);dt.__click=[vi,De,at],jt(Ke,()=>v(at),we=>R(at,we)),S(le,_e)};X(ot,le=>{v(De)&&le(zt)})}var Jt=w(ot,2);{var rr=le=>{var _e=lt(),Ke=B(_e);{var St=dt=>{var we=Si(),_t=B(we);ls(_t,()=>v(kt),ye=>{var $e=bi();S(ye,$e)},(ye,$e)=>{var Qe=gi(),Et=B(Qe),Ht=C(Et),or=w(Ht);{var la=ir=>{var Xr=hi(),ua=w(B(Xr),2),fa=C(ua);W(()=>pe(fa,`v${v($e).version??""}`)),S(ir,Xr)};X(or,ir=>{v($e).version&&ir(la)})}var Jr=w(Et,2),ca=C(Jr);W(()=>{pe(Ht,`${v($e).name??U??""} `),Pe(Jr,1,Hn(v($e).description?null:"italic")),pe(ca,v($e).description??"no description")}),S(ye,Qe)},ye=>{var $e=mi();S(ye,$e)});var Rn=w(_t,2);Rn.__click=[wi,l,V];var Pn=w(Rn,2);Pn.__click=[yi,V];var $t=w(Pn,4);{var In=ye=>{var $e=xi(),Qe=B($e);Qe.__click=[ki,Me,Ie,V],S(ye,$e)};X($t,ye=>{v(Ie).updaterURL&&ye(In)})}var ar=w($t,2);ar.__click=()=>{R(kt,null),O.pluginConfigHasPendingChanges=!0;const ye=l[Q(V)];ye&&(fetch("/uninstall-plugin?".concat(new URLSearchParams({id:Q(V),delete_data_dir:typeof ye.path=="string"?"0":"1"}).toString())),g(`plugin '${ye.name}' uninstalled`),delete l[Q(V)])},S(dt,we)};X(Ke,dt=>{Object.keys(l).includes(Q(V))&&v(kt)!==null&&dt(St)})}S(le,_e)},sr=le=>{var _e=$i();S(le,_e)};X(Jt,le=>{Object.entries(l).length!==0?le(rr):le(sr,!1)})}W(()=>{Fe.disabled=!$.hasLibArchive||v(q),Oe.disabled=v(q)}),S(se,Te)},Ze=se=>{var Te=Hi(),Nt=w(B(Te),2);ls(Nt,()=>v(kt),Fe=>{var Oe=Ni();S(Fe,Oe)},(Fe,Oe)=>{var ot=Ai(),zt=B(ot);{var Jt=le=>{var _e=Ci();_e.__click=[Li,re,ue,V,z,Oe,p];var Ke=C(_e);W(()=>pe(Ke,`Start ${v(Oe).name??""}`)),S(le,_e)},rr=le=>{var _e=lt(),Ke=B(_e);{var St=we=>{var _t=Ri();S(we,_t)},dt=we=>{var _t=Pi();S(we,_t)};X(Ke,we=>{Object.entries(l).length===0?we(St):we(dt,!1)},!0)}S(le,_e)};X(zt,le=>{v(Oe)&&v(Oe).main&&Object.keys(l).includes(Q(V))?le(Jt):le(rr,!1)})}var sr=w(zt,8);Rt(sr,1,n,Dt,(le,_e)=>{var Ke=lt(),St=B(Ke);{var dt=we=>{var _t=lt(),Rn=B(_t);Rt(Rn,17,()=>v(_e).plugins,Dt,(Pn,$t)=>{var In=lt(),ar=B(In);{var ye=Qe=>{var Et=Ti(),Ht=C(Et),or=w(Ht);or.__click=[Ii,ne,ue,$t],W(()=>pe(Ht,`${l[v($t).id].name??v($t).id??""} `)),S(Qe,Et)},$e=Qe=>{var Et=Oi(),Ht=C(Et);W(()=>pe(Ht,v($t).id)),S(Qe,Et)};X(ar,Qe=>{Object.keys(l).includes(v($t).id)?Qe(ye):Qe($e,!1)})}S(Pn,In)}),S(we,_t)};X(St,we=>{v(_e).uid===Q(ue)&&we(dt)})}S(le,Ke)}),S(Fe,ot)},Fe=>{var Oe=Ui();S(Fe,Oe)}),S(se,Te)};X(bn,se=>{Q(Se)?se(Ze,!1):se(Ut)})}Gr(xt,()=>Q(V),se=>R(V,se)),S(de,je)},nr=de=>{var je=Di();S(de,je)};X(Vt,de=>{$.hasBoltPlugins?de(mn):de(nr,!1)})}var sa=w(Vt,2);{var aa=de=>{var je=qi(),xt=w(B(je),3);{var bn=Ze=>{var se=ji(),Te=C(se);W(()=>pe(Te,`[error] ${v(i)??""}`)),S(Ze,se)},Ut=Ze=>{var se=Fi(),Te=C(se);W(()=>pe(Te,`[info] ${v(i)??""}`)),S(Ze,se)};X(xt,Ze=>{v(c)?Ze(bn):Ze(Ut,!1)})}S(de,je)};X(sa,de=>{v(i)&&de(aa)})}var oa=w(Ye,2),ia=C(oa);ia.__click=[ai],W(()=>Pe(H,1,`mx-auto mb-2 w-[95%] select-none rounded-lg border-2 ${Q(Se)?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black"} p-2 font-bold hover:opacity-75`)),S(y,T)},$$slots:{default:!0}}),y=>o=y,()=>o);var G=be(Y);return a(),G}st(["click","change"]);var Gi=L('<div class="absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black"> </div>'),Vi=L('<option class="dark:bg-slate-900"> </option>'),zi=L('<label class="flex flex-col"><span class="text-sm">Game Client</span> <select id="game_client_select" class="w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select></label>'),Ji=L('<button class="w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Plugin menu</button>'),Xi=L('<option class="dark:bg-slate-900"><!></option>'),Yi=L('<option class="dark:bg-slate-900" disabled selected>No characters</option>'),Zi=L('<!> <!> <div class="bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800"><!> <div class="flex flex-col items-center gap-4"><img src="svgs/rocket-solid.svg" alt="Launch icon" class="mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"/> <button class="w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500">Play</button> <!> <label class="flex flex-col"><span class="text-sm">Character</span> <select id="character_select" class="mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"><option disabled class="dark:bg-slate-900">Select an account</option><!></select></label></div></div>',1);function Ki(e,t){me(t,!0);const n=()=>ve(f,"$config",i),r=()=>ve(g,"$psa",i),a=()=>ve(m,"$gameEnabled",i),o=()=>ve(d,"$initialized",i),[i,c]=Je();let l,u,{config:f,initialized:d}=O,p=Be(()=>n().selected.user_id),_=Be(()=>n().userDetails[v(p)??""]?.account_id),h=Be(()=>fe.findSession(n().selected.user_id)?.accounts??[]),g=Bt(null),m=Bt(!0);un(()=>{if(n().check_announcements){const z=n().selected.game==Ee.osrs?"osrs":$.env.provider,Y=`${$.env.psa_url}${z}/${z}.json`;fetch(Y,{method:"GET",cache:"no-store"}).then(G=>G.json()).then(G=>{An(g,G.psaEnabled&&G.psaMessage?G.psaMessage:null),An(m,!(G.playDisabled??!1))})}else An(g,null),An(m,!0)});function k(z,Y){if(!v(p))return A.warn("Please log in or select a user to play.");if(!v(_))return A.warn("Please select a character from the select menu.");const G=fe.findSession(n().selected.user_id);if(!G)return A.warn("Unable to launch game, session was not found.");const{session_id:y}=G,I=fe.findAccount(G.accounts,v(_));if(!I)return A.warn("Unable to launch game, account was not found.");const{accountId:T,displayName:J}=I,H=$.platform===wr.Windows,Z=$.platform===wr.Linux;switch(z){case Ee.osrs:switch(Y){case en.official:_s(H||Z,!0,y,T,J);break;case en.runelite:ra(y,T,J,!1);break;case en.hdos:ei(y,T,J);break}break;case Ee.rs3:Z?Qo(y,T,J):_s(H,!1,y,T,J);break}}function b(z){const Y=z.target.value;if(!v(p))return;const G=n().userDetails[v(p)];G?(G.account_id=Y,ie(f,P(n).userDetails[v(p)]=G,P(n))):ie(f,P(n).userDetails[v(p)]={account_id:Y},P(n))}var N={launch:k},D=Zi(),U=B(D);wt(si(U,{}),z=>l=z,()=>l);var x=w(U,2);wt(Wi(x,{}),z=>u=z,()=>u);var E=w(x,2),M=C(E);{var q=z=>{var Y=Gi(),G=C(Y);W(()=>pe(G,r())),S(z,Y)};X(M,z=>{r()&&z(q)})}var te=w(M,2),re=w(C(te),2);re.__click=()=>{a()?k(n().selected.game,n().selected.client):l.open(k,n().selected.game,n().selected.client)};var ne=w(re,2);{var Me=z=>{var Y=zi(),G=w(C(Y),2);Rt(G,5,()=>da[n().selected.game],Dt,(y,I)=>{var T=Vi(),J=C(T),H={};W(()=>{pe(J,v(I)),H!==(H=v(I))&&(T.value=(T.__value=v(I))??"")}),S(y,T)}),Gr(G,()=>n().selected.client,y=>ie(f,P(n).selected.client=y,P(n))),S(z,Y)},V=z=>{var Y=lt(),G=B(Y);{var y=I=>{var T=Ji();T.__click=()=>{u.open()},W(()=>{T.disabled=!$.hasBoltPlugins,gt(T,"title",$.hasBoltPlugins?null:"This feature is disabled")}),S(I,T)};X(G,I=>{n().selected.game===Ee.rs3&&I(y)},!0)}S(z,Y)};X(ne,z=>{n().selected.game==Ee.osrs?z(Me):z(V,!1)})}var Se=w(ne,2),ue=w(C(Se),2);ue.__change=b;var De=C(ue);De.value=(De.__value=void 0)??"";var at=w(De);Rt(at,17,()=>v(h),Dt,(z,Y)=>{var G=Xi(),y=C(G);{var I=H=>{var Z=os();W(()=>pe(Z,v(Y).displayName)),S(H,Z)},T=H=>{var Z=os("New Character");S(H,Z)};X(y,H=>{v(Y).displayName?H(I):H(T,!1)})}var J={};W(()=>{J!==(J=v(Y).accountId)&&(G.value=(G.__value=v(Y).accountId)??"")}),S(z,G)},z=>{var Y=Yi();S(z,Y)});var Ie;Qs(ue),W(()=>{re.disabled=!o(),ue.disabled=!o()||n().selected.user_id===null,Ie!==(Ie=v(_))&&(ue.value=(ue.__value=v(_))??"",Wr(ue,v(_)))}),S(e,D);var kt=be(N);return c(),kt}st(["click","change"]);var Qi=L("<li> </li>"),el=L('<div class="fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900"><div class="absolute right-6 top-2"><img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/></div> <ol id="message_list" class="h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"></ol></div>');function tl(e,t){me(t,!0);var n=el(),r=w(C(n),2);Rt(r,21,()=>t.logs,Dt,(a,o)=>{let i=()=>v(o).date,c=()=>v(o).severity,l=()=>v(o).content;var u=Qi();let f;var d=C(u);W((p,_)=>{f=Pe(u,1,"",null,f,p),pe(d,`${_??""}
				- ${l()??""}`)},[()=>({"text-rose-500":c()===Lr.error,"text-orange-700":c()===Lr.warn}),()=>i()?.toLocaleTimeString()]),S(a,u)}),S(e,n),be()}var nl=L('<option class="dark:bg-slate-900"> </option>'),rl=()=>{const{origin:e,redirect:t,clientid:n}=$.env;Ce.openLoginWindow(e,t,n)},sl=async(e,t,n)=>{t().selected.user_id&&(await fe.logout(t().selected.user_id),fe.saveCredentials())},al=L('<select class="w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"><option disabled class="dark:bg-slate-900">Select a user</option><!></select> <div class="mt-5 flex"><button class="mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Log In</button> <button class="mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75">Log Out</button></div>',1);function ol(e,t){me(t,!1);const n=()=>ve(c,"$config",a),r=()=>ve(i,"$sessions",a),[a,o]=Je(),{sessions:i,config:c}=O;At();var l=al(),u=B(l);W(()=>{n(),ao(()=>{r()})});var f=C(u);f.value=(f.__value=null)??"";var d=w(f);Rt(d,1,r,g=>g.user.userId,(g,m)=>{var k=nl(),b=C(k),N={};W(()=>{pe(b,v(m).user.displayName),N!==(N=v(m).user.userId)&&(k.value=(k.__value=v(m).user.userId)??"")}),S(g,k)});var p=w(u,2),_=C(p);_.__click=[rl];var h=w(_,2);h.__click=[sl,n,c],W(()=>h.disabled=!n().selected.user_id),Gr(u,()=>n().selected.user_id,g=>ie(c,P(n).selected.user_id=g,P(n))),S(e,l),be(),o()}st(["click"]);function il(e,{callback:t,ignore:n=[]}){const r=a=>{const o=n.some(i=>i.contains(a.target));e&&!e.contains(a.target)&&!a.defaultPrevented&&!o&&t()};return document.addEventListener("click",r,!0),document.addEventListener("contextmenu",r,!0),{destroy(){document.removeEventListener("click",r,!0),document.removeEventListener("contextmenu",r,!0)}}}function ll(e,t,n,r){v(t)?n():r()}var cl=L("<div><!></div>"),ul=L("<div><button><!></button> <!></div>");function fl(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>n().use_dark_theme),c=on(t,"class",3,""),l=on(t,"position",3,"bottom"),u=on(t,"align",3,"start"),f=oe(!1),d=oe(void 0);function p(){R(f,!0)}function _(){R(f,!1)}var h={open:p,close:_},g=ul();let m;var k=C(g);k.__click=[ll,f,_,p];var b=C(k);Vn(b,()=>t.children??nt),wt(k,x=>R(d,x),()=>v(d));var N=w(k,2);{var D=x=>{var E=cl(),M=C(E);Vn(M,()=>t.content??nt),Eo(E,(q,te)=>il?.(q,te),()=>({callback:_,ignore:[v(d)]})),W(()=>Pe(E,1,`dropdown-color absolute z-20 rounded-lg border-2 ${l()??""} ${u()??""}`,"svelte-11xj3vp")),S(x,E)};X(N,x=>{v(f)&&x(D)})}W(x=>m=Pe(g,1,`relative h-fit w-fit ${c()??""}`,"svelte-11xj3vp",m,x),[()=>({dark:v(i)})]),S(e,g);var U=be(h);return a(),U}st(["click"]);var dl=(e,t)=>{t()},_l=L('<button id="data_dir_button" class="p-2 hover:opacity-75"><div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/> Browse App Data</div></button> <div class="mx-auto p-2"><label for="check_announcements">Check game announcements:</label> <input id="check_announcements" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="close_after_launch">Close Bolt after launching a game:</label> <input id="close_after_launch" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="discard_expired_logins">Discard expired login sessions:</label> <input id="discard_expired_logins" type="checkbox" class="ml-2"/></div>',1);function vl(e,t){me(t,!1);const n=()=>ve(i,"$config",r),[r,a]=Je();function o(){var b=new XMLHttpRequest;b.open("GET","/browse-data"),b.onreadystatechange=()=>{b.readyState==4&&A.info(`Browse status: '${b.responseText.trim()}'`)},b.send()}const{config:i}=O,c="Allow checking for official announcements about game status. These will be displayed above the 'play' button. Disabling will reduce the number of web requests made when opening the launcher.",l="Close the launcher immediately after launching a game",u="Discard login sessions if they're no longer valid, prompting the player to sign-in again. If unchecked, the only way to discard a login will be by manually pressing the 'log out' button, even if your login no longer works.";At();var f=_l(),d=B(f);d.__click=[dl,o];var p=w(d,2);gt(p,"title",c);var _=w(C(p),2),h=w(p,2);gt(h,"title",l);var g=w(C(h),2),m=w(h,2);gt(m,"title",u);var k=w(C(m),2);an(_,()=>n().check_announcements,b=>ie(i,P(n).check_announcements=b,P(n))),an(g,()=>n().close_after_launch,b=>ie(i,P(n).close_after_launch=b,P(n))),an(k,()=>n().discard_expired_sessions,b=>ie(i,P(n).discard_expired_sessions=b,P(n))),S(e,f),be(),a()}st(["click"]);var pl=(e,t)=>t(),hl=(e,t)=>{t()},gl=L('<button class="p-2 pb-5 hover:opacity-75"><div class="flex"><img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/> Configure RuneLite</div></button> <div class="mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"><label for="use_custom_jar">Use custom RuneLite JAR:</label> <input id="use_custom_jar" type="checkbox" class="ml-2"/></div> <div><textarea class="h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"></textarea> <br/> <button class="mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 enabled:hover:opacity-75">Select File</button></div> <div class="p-2"><label for="osrs_custom_launch_command">OSRS launch command:</label> <br/> <textarea id="osrs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="runelite_custom_launch_command">RuneLite launch command:</label> <br/> <textarea id="runelite_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="hdos_custom_launch_command">HDOS launch command:</label> <br/> <textarea id="hdos_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function ml(e,t){me(t,!0);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;let i=Be(()=>fe.findSession(n().selected.user_id)),c=Be(()=>fe.findAccount(v(i)?.accounts??[],n().userDetails[n().selected.user_id??""]?.account_id)),l=oe(!1);async function u(){R(l,!0),ie(o,P(n).runelite_custom_jar=await fe.openFilePicker(),P(n)),console.log("done picking"),R(l,!1)}function f(){!v(i)?.session_id||!v(c)?.accountId||!v(c)?.displayName||ra(v(i).session_id,v(c).accountId,v(c).displayName,!0)}var d=gl(),p=B(d);p.__click=[pl,f];var _=w(p,2),h=w(C(_),2),g=w(_,2);let m;var k=C(g),b=w(k,4);b.__click=[hl,u];var N=w(g,2),D=w(C(N),4);gt(D,"placeholder","%command%");var U=w(N,2),x=w(C(U),4);gt(x,"placeholder","%command%");var E=w(U,2),M=w(C(E),4);gt(M,"placeholder","%command%"),W(q=>{p.disabled=!v(i)?.session_id||!v(c)?.accountId,m=Pe(g,1,"mx-auto p-2",null,m,q),k.disabled=!n().runelite_use_custom_jar,b.disabled=v(l)||!n().runelite_use_custom_jar},[()=>({"opacity-25":!n().runelite_use_custom_jar})]),an(h,()=>n().runelite_use_custom_jar,q=>ie(o,P(n).runelite_use_custom_jar=q,P(n))),jt(k,()=>n().runelite_custom_jar,q=>ie(o,P(n).runelite_custom_jar=q,P(n))),jt(D,()=>n().osrs_launch_command,q=>ie(o,P(n).osrs_launch_command=q,P(n))),jt(x,()=>n().runelite_launch_command,q=>ie(o,P(n).runelite_launch_command=q,P(n))),jt(M,()=>n().hdos_launch_command,q=>ie(o,P(n).hdos_launch_command=q,P(n))),S(e,d),be(),a()}st(["click"]);var bl=L('<div class="mx-auto p-2"><label for="enable_plugins">Enable Bolt plugin loader:</label> <input type="checkbox" name="enable_plugins" id="enable_plugins" class="ml-2"/></div>'),wl=L('<!> <div class="mx-auto p-2"><label for="use_custom_uri">Use custom config URI:</label> <input id="use_custom_uri" type="checkbox" class="ml-2"/></div> <div class="p-2"><textarea class="rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="4"></textarea></div> <div class="p-2"><label for="rs_custom_launch_command">Launch command:</label> <br/> <textarea id="rs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function yl(e,t){me(t,!1);const n=()=>ve(o,"$config",r),[r,a]=Je(),{config:o}=O;At();var i=wl(),c=B(i);{var l=g=>{var m=bl(),k=w(C(m),2);an(k,()=>n().rs_plugin_loader,b=>ie(o,P(n).rs_plugin_loader=b,P(n))),S(g,m)};X(c,g=>{$.hasBoltPlugins&&g(l)})}var u=w(c,2),f=w(C(u),2),d=w(u,2),p=C(d),_=w(d,2),h=w(C(_),4);gt(h,"placeholder","%command%"),W(()=>{p.disabled=!n().use_custom_rs_config_uri,gt(p,"placeholder",$.env.default_config_uri)}),an(f,()=>n().use_custom_rs_config_uri,g=>ie(o,P(n).use_custom_rs_config_uri=g,P(n))),jt(p,()=>n().rs_config_uri,g=>ie(o,P(n).rs_config_uri=g,P(n))),jt(h,()=>n().rs_launch_command,g=>ie(o,P(n).rs_launch_command=g,P(n))),S(e,i),be(),a()}var kl=(e,t,n)=>{R(t,n.general)},xl=(e,t,n)=>{R(t,n.osrs)},Sl=(e,t,n)=>{R(t,n.rs3)},$l=L('<div class="grid h-full grid-cols-4"><div class="flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"><button>General</button> <button>OSRS</button> <button>RS3</button></div> <div class="col-span-3 p-5 pt-10 text-center"><!></div></div>');function El(e,t){me(t,!1);var n=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(n||{});let r=We(),a=We(0),o="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",i="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function c(){v(r).open()}const l=()=>fe.saveConfig();var u={open:c};return At(),wt(er(e,{class:"h-3/4 w-3/4 select-none",onClose:l,children:(f,d)=>{var p=$l(),_=C(p),h=C(_);h.__click=[kl,a,n];var g=w(h,2);g.__click=[xl,a,n];var m=w(g,2);m.__click=[Sl,a,n];var k=w(_,2),b=C(k);{var N=U=>{vl(U,{})},D=U=>{var x=lt(),E=B(x);{var M=te=>{ml(te,{})},q=te=>{var re=lt(),ne=B(re);{var Me=V=>{yl(V,{})};X(ne,V=>{v(a)==n.rs3&&V(Me)},!0)}S(te,re)};X(E,te=>{v(a)==n.osrs?te(M):te(q,!1)},!0)}S(U,x)};X(b,U=>{v(a)==n.general?U(N):U(D,!1)})}W(()=>{Pe(h,1,Hn(v(a)===n.general?o:i)),Pe(g,1,Hn(v(a)===n.osrs?o:i)),Pe(m,1,Hn(v(a)===n.rs3?o:i))}),S(f,p)},$$slots:{default:!0},$$legacy:!0}),f=>R(r,f),()=>v(r)),ea(t,"open",c),be(u)}st(["click"]);var Ll=(e,t,n)=>{ie(n,P(t).selected.game=Ee.rs3,P(t))},Cl=(e,t,n)=>{ie(n,P(t).selected.game=Ee.osrs,P(t))},Rl=(e,t,n)=>ie(n,P(t).use_dark_theme=!t().use_dark_theme,P(t)),Pl=(e,t)=>v(t).open(),Il=L('<div class="w-40"><!></div>'),Tl=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50"> </button>'),Ol=()=>{const{origin:e,redirect:t,clientid:n}=$.env;Ce.openLoginWindow(e,t,n)},Al=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50">Login</button>'),Ul=L('<!> <div class="fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900"><div class="m-3 ml-9 font-bold"><button>RS3</button> <button>OSRS</button></div> <div class="m-2 ml-auto flex gap-2"><button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/></button> <button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/></button> <!></div></div>',1);function Nl(e,t){me(t,!1);const n=()=>ve(i,"$config",a),r=()=>ve(c,"$sessions",a),[a,o]=Je(),{config:i,sessions:c}=O;let l=We();At();var u=Ul(),f=B(u);wt(El(f,{$$legacy:!0}),E=>R(l,E),()=>v(l));var d=w(f,2),p=C(d),_=C(p);let h;_.__click=[Ll,n,i];var g=w(_,2);let m;g.__click=[Cl,n,i];var k=w(p,2),b=C(k);b.__click=[Rl,n,i];var N=w(b,2);N.__click=[Pl,l];var D=w(N,2);{var U=E=>{const M=Hr(()=>fe.findSession(n().selected.user_id??""));fl(E,{align:"center",content:te=>{var re=Il(),ne=C(re);ol(ne,{}),S(te,re)},children:(te,re)=>{var ne=Tl(),Me=C(ne);W(()=>pe(Me,v(M)?.user.displayName??"No user selected")),S(te,ne)},$$slots:{content:!0,default:!0}})},x=E=>{var M=Al();M.__click=[Ol],S(E,M)};X(D,E=>{r().length>0?E(U):E(x,!1)})}W((E,M)=>{h=Pe(_,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75",null,h,E),m=Pe(g,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75",null,m,M)},[()=>({"text-black":n().selected.game===Ee.rs3,"bg-blue-500":n().selected.game===Ee.rs3}),()=>({"text-black":n().selected.game===Ee.osrs,"bg-blue-500":n().selected.game===Ee.osrs})]),S(e,u),be(),o()}st(["click"]);var Hl=L('<!> <!> <div class="mt-16 grid h-full grid-flow-col grid-cols-3"><div></div> <!> <div></div></div> <!>',1);function Ml(e,t){me(t,!1);const n=()=>ve(o,"$logs",r),[r,a]=Je(),o=A.logs;At(),na(e,{children:(i,c)=>{var l=Hl(),u=B(l);Jo(u,{});var f=w(u,2);Nl(f,{});var d=w(f,2),p=w(C(d),2);Ki(p,{});var _=w(d,2);tl(_,{get logs(){return n()}}),S(i,l)}}),be(),a()}const vs={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?is(qo,vs):(Dl(),Mo(),jl(),Fl().finally(()=>{O.initialized.set(!0)}),is(Ml,vs));function Dl(){const e=new URLSearchParams(window.location.search);$.platform=e.get("platform"),$.isFlathub=e.get("flathub")==="1",$.hasLibArchive=e.get("has_libarchive")==="1",$.rs3debInstalledHash=e.get("rs3_deb_installed_hash"),$.rs3exeInstalledHash=e.get("rs3_exe_installed_hash"),$.rs3appInstalledHash=e.get("rs3_app_installed_hash"),$.osrsexeInstalledHash=e.get("osrs_exe_installed_hash"),$.osrsappInstalledHash=e.get("osrs_app_installed_hash"),$.runeLiteInstalledId=e.get("runelite_installed_id"),$.hdosInstalledVersion=e.get("hdos_installed_version");const t=e.get("plugins");if($.hasBoltPlugins=t!==null,t!==null)try{$.pluginConfig=JSON.parse(t)}catch{A.error("Unable to parse plugin list")}const n=e.get("credentials");if(n)try{const r=JSON.parse(n),a=r.every(o=>typeof o.session_id=="string"&&typeof o.tokens=="object"&&typeof o.accounts=="object"&&typeof o.user=="object");a?O.sessions.set(r):(O.sessions.set([]),fe.saveCredentials(),A.warn("Credentials saved on disk are out of date. Please sign in again.")),O.sessions.set(a?r:[])}catch{O.sessions.set([]),fe.saveCredentials(),A.error("Unable to parse saved credentials. Please sign in again.")}}function jl(){const{origin:e,origin_2fa:t}=$.env,n=[window.location.origin,e,t];let r=null;window.addEventListener("message",async a=>{if(!n.includes(a.origin)){A.info(`discarding window message from origin ${a.origin}`);return}switch(a.data.type){case"authTokenUpdate":{r=a.data.tokens;break}case"authSessionUpdate":{if(r===null)return A.error("auth is null. Please try again.");const o=a.data.sessionId,i=await fe.login(r,o);i.ok?A.info(`Added new user '${i.value.user.displayName}'`):A.error(`Unable to add new user. Please try again. ${i.error}`),fe.saveCredentials(),Ce.pendingLoginWindow=null,r=null;break}case"authFailed":{A.error(`Unable to authenticate: ${a.data.reason}`),Ce.pendingLoginWindow=null,r=null;break}case"externalUrl":{const o=new XMLHttpRequest;o.onreadystatechange=()=>{o.readyState==4&&A.info(`External URL status: '${o.responseText.trim()}'`)},o.open("POST","/open-external-url",!0),o.send(a.data.url);break}case"gameClientList":Le(O.config).close_after_launch&&a.data.clients.length>Le(Cr).length?fetch("/close"):Cr.set(a.data.clients);break;default:{const o=a.data?.type??"no type provided";A.info(`Unknown message type: ${o}`);break}}})}async function Fl(){const e=Le(O.config).discard_expired_sessions,t=Le(O.sessions),n=[];t.length>0&&A.info("Logging in...");const r=t.map(i=>({promise:Ce.refreshOAuthToken(i.tokens),session:i})),a=[];for(const i of r){const c=i.session,l=await i.promise;if(!l.ok){l.error===0?A.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):l.error>=400&&l.error<500&&e?(A.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),n.push(c.tokens.sub)):A.error(`Unable to verify saved login due to HTTP error ${l.error}`);continue}const u=l.value;c.tokens=u,a.push({promise:fe.login(u,c.session_id),session:c})}for(const i of a){const c=i.session,l=await i.promise;l.ok?A.info(`Signed into saved user '${l.value.user.displayName}'`):(A.error(`Unable to sign into saved user '${c.user.displayName}' due to an error: ${l.error}`),e&&n.push(c.tokens.sub))}const o=n.map(fe.logout);for(const i of o)await i;O.sessions.set(t),await fe.saveCredentials()}
