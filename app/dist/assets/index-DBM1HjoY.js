(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var br=(e=>(e[e.SECOND=1e3]="SECOND",e[e.MINUTE=6e4]="MINUTE",e[e.HALF_HOUR=18e5]="HALF_HOUR",e[e.HOUR=36e5]="HOUR",e[e.DAY=864e5]="DAY",e[e.WEEK=6048e5]="WEEK",e[e.MONTH=2592e6]="MONTH",e))(br||{});class Xt{static set(t,n,r,a){const o=new Date;o.setTime(o.getTime()+r*a);const i=`expires=${o.toUTCString()}`;document.cookie=`${t}=${n};${i};path=/`}static get(t){const n=`${t}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let o=r[a];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(n)===0)return o.substring(n.length,o.length)}return null}static remove(t){document.cookie=`${t}=; Max-Age=-99999999;`}}function Ke(e){return{ok:!0,value:e}}function re(e){return{ok:!1,error:e}}var Ee=(e=>(e.rs3="rs3",e.osrs="osrs",e))(Ee||{}),Yt=(e=>(e.official="Official",e.runelite="RuneLite",e.hdos="HDOS",e))(Yt||{});const ca={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class Tn{static parseTokenResponse(t){try{const n=JSON.parse(t),r=n.id_token.split(".");if(r.length!==3){const i=`Malformed id_token: ${r.length} sections, expected 3`;return re(i)}const a=JSON.parse(atob(r[0]));if(a.typ!=="JWT"){const i=`Bad id_token header: typ ${a.typ}, expected JWT`;return re(i)}const o=JSON.parse(atob(r[1]));return Ke({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:o.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return re("Unable to parse token response")}}static parseSessionResponse(t){try{const n=JSON.parse(t);return n.sessionId?Ke(n.sessionId):re("sessionId does not exist on parsed object")}catch{return re("Unable to parse session response")}}static decodeBolt(t){const n={};for(const r in t){const a=r,o=t[a];typeof o=="string"?n[a]=atob(o):Array.isArray(o)&&o.every(i=>typeof i=="string")?n[a]=o.map(i=>atob(i)):n[a]=o}return n}}var wr=(e=>(e.Windows="windows",e.Linux="linux",e.MacOS="mac",e))(wr||{});const k={env:Tn.decodeBolt(s()),platform:null,rs3debInstalledHash:null,rs3exeInstalledHash:null,rs3appInstalledHash:null,osrsexeInstalledHash:null,osrsappInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasLibArchive:!1,hasBoltPlugins:!1,pluginConfig:{}};class lr{static async makeLoginUrl(t){const n=new TextEncoder().encode(t.pkceCodeVerifier),r=await crypto.subtle.digest("SHA-256",n);let a="";const o=new Uint8Array(r);for(let u=0;u<o.byteLength;u++)a+=String.fromCharCode(o[u]);const i=btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:t.authMethod,login_type:t.loginType,flow:t.flow,response_type:"code",client_id:t.clientid,redirect_uri:t.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:t.pkceState}).toString())}static makeRandomVerifier(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(r){return t[r%t.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=n.length-1,a=crypto.getRandomValues(new Uint8Array(12));return Array.from(a).map(o=>Math.round(o*(r-0)/255+0)).map(o=>n[o]).join("")}}class Pe{static pendingLoginWindow=null;static async openLoginWindow(t,n,r){if(Pe.pendingLoginWindow!==null)return Pe.pendingLoginWindow.window.focus();const a=lr.makeRandomState(),o=lr.makeRandomVerifier(),i=new TextEncoder().encode(o),u=await crypto.subtle.digest("SHA-256",i);let l="";const c=new Uint8Array(u);for(let _=0;_<c.byteLength;_++)l+=String.fromCharCode(c[_]);const f=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),d=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:r,redirect_uri:n,code_challenge:f,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:a}),h=`${t}/oauth2/auth?${d.toString()}`;Xt.set("auth_verifier",o,10,br.MINUTE),Pe.pendingLoginWindow=window.open(h,"","width=480,height=720")}static navigateToAuthConsent(t,n,r){const a=lr.makeRandomState(),o=new URLSearchParams({id_token_hint:n,nonce:r,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:a,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${t}/oauth2/auth?${o.toString()}`;Xt.set("auth_nonce",r,10,br.MINUTE),window.location.href=i}static async refreshOAuthToken(t){return new Promise(n=>{if(t.expiry-Date.now()<3e4){const r=new URLSearchParams({grant_type:"refresh_token",client_id:k.env.clientid,refresh_token:t.refresh_token}),a=new XMLHttpRequest;a.onreadystatechange=()=>{if(a.readyState==4)if(a.status==200){const i=Tn.parseTokenResponse(a.response);i.ok?n(Ke(i.value)):n(re(0))}else n(re(a.status))},a.onerror=()=>{n(re(0))};const o=k.env.origin.concat("/oauth2/token");a.open("POST",o,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("Accept","application/json"),a.send(r)}else n(Ke(t))})}static async getOAuthToken(t,n,r,a,o){const i=`${t}/oauth2/token`;return new Promise(u=>{const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const f=Tn.parseTokenResponse(l.response);return f.ok?u(Ke(f.value)):u(re(f.error))}else return u(re(`Error: from ${i}: ${l.status}: ${l.response}`))},l.open("POST",i,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json");const c=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:o,code_verifier:r,redirect_uri:a});l.send(c)})}static revokeOauthCreds(t){const n=`${k.env.origin}/oauth2/revoke`;return new Promise(r=>{const a=new XMLHttpRequest;a.open("POST",n,!0),a.onreadystatechange=()=>{a.readyState==4&&r(a.status)},a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const o=new URLSearchParams({token:t,client_id:k.env.clientid});a.send(o)})}static async getSessionId(t,n){const r=`${t}/sessions`;return new Promise(a=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const u=Tn.parseSessionResponse(o.response);return u.ok?a(Ke(u.value)):a(re(u.error))}else re(`Error: from ${r}: ${o.status}: ${o.response}`)},o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json");const i={idToken:n};o.send(JSON.stringify(i))})}static validateIdToken(t,n){const r=t.split(".");if(r.length!==3)return re(`Malformed id_token: ${r.length} sections, expected 3`);const a=JSON.parse(atob(r[0]));return a.typ!=="JWT"?re(`Bad id_token header: typ ${a.typ}, expected JWT`):JSON.parse(atob(r[1])).nonce!==n?re("Incorrect nonce in id_token"):Ke(void 0)}}class Un{static async buildSession(t,n){const r=await Un.getUser(t.sub,t.access_token);if(!r.ok)return re(`Failed to fetch user. Status: ${r.error}`);const a=await Un.getUserAccounts(n);return a.ok?Ke({user:r.value,accounts:a.value,tokens:t,session_id:n}):re(`Failed to fetch game accounts. Status: ${a.error}`)}static getUser(t,n){return new Promise(r=>{const a=`${k.env.api}/users/${t}/displayName`,o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=JSON.parse(o.response);r(Ke(i))}else r(re(o.status))},o.open("GET",a,!0),o.setRequestHeader("Authorization","Bearer ".concat(n)),o.send()})}static getUserAccounts(t){const n=`${k.env.auth_api}/accounts`;return new Promise(r=>{const a=new XMLHttpRequest;a.onreadystatechange=async()=>{if(a.readyState==4)if(a.status==200){const o=JSON.parse(a.response);r(Ke(o))}else r(re(a.status))},a.open("GET",n,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(t)),a.send()})}}const _s=!1;var Wn=Array.isArray,fa=Array.prototype.indexOf,Rr=Array.from,Nn=Object.defineProperty,Zt=Object.getOwnPropertyDescriptor,vs=Object.getOwnPropertyDescriptors,da=Object.prototype,_a=Array.prototype,Ir=Object.getPrototypeOf,Xr=Object.isExtensible;const et=()=>{};function va(e){return typeof e?.then=="function"}function pa(e){return e()}function Hn(e){for(var t=0;t<e.length;t++)e[t]()}function ha(){var e,t,n=new Promise((r,a)=>{e=r,t=a});return{promise:n,resolve:e,reject:t}}function ga(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const He=2,Tr=4,Gn=8,on=16,mt=32,Ft=64,Or=128,We=256,Mn=512,be=1024,Ge=2048,Pt=4096,tt=8192,ln=16384,Ar=32768,yn=65536,Yr=1<<17,ma=1<<18,un=1<<19,ps=1<<20,yr=1<<21,Ur=1<<22,Ht=1<<23,Ct=Symbol("$state"),ba=Symbol(""),Nr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function hs(e){return e===this.v}function Hr(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function gs(e){return!Hr(e,this.v)}function ms(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function wa(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ya(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ka(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function xa(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Sa(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function $a(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ca(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ea(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function La(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}let kn=!1,Pa=!1;function Ra(){kn=!0}const Vn=1,zn=2,bs=4,Ia=8,Ta=16,Oa=1,Aa=2,le=Symbol(),Ua="http://www.w3.org/1999/xhtml";let Q=null;function Lt(e){Q=e}function ye(e,t=!1,n){Q={p:Q,c:null,e:null,s:e,x:null,l:kn&&!t?{s:null,u:null,$:[]}:null}}function ke(e){var t=Q,n=t.e;if(n!==null){t.e=null;for(var r of n)Fs(r)}return e!==void 0&&(t.x=e),Q=t.p,e??{}}function cn(){return!kn||Q!==null&&Q.l===null}let xt=[],Dn=[];function ws(){var e=xt;xt=[],Hn(e)}function Na(){var e=Dn;Dn=[],Hn(e)}function Ha(){return xt.length>0||Dn.length>0}function qt(e){if(xt.length===0&&!gn){var t=xt;queueMicrotask(()=>{t===xt&&ws()})}xt.push(e)}function Ma(){xt.length>0&&ws(),Dn.length>0&&Na()}function Da(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ja(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Fa=!1;function pn(e){if(typeof e!="object"||e===null||Ct in e)return e;const t=Ir(e);if(t!==da&&t!==_a)return e;var n=new Map,r=Wn(e),a=se(0),o=Mt,i=u=>{if(Mt===o)return u();var l=q,c=Mt;we(null),ns(o);var f=u();return we(l),ns(c),f};return r&&n.set("length",se(e.length)),new Proxy(e,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&$a();var f=n.get(l);return f===void 0?f=i(()=>{var d=se(c.value);return n.set(l,d),d}):R(f,c.value,!0),!0},deleteProperty(u,l){var c=n.get(l);if(c===void 0){if(l in u){const f=i(()=>se(le));n.set(l,f),mn(a)}}else R(c,le),mn(a);return!0},get(u,l,c){if(l===Ct)return e;var f=n.get(l),d=l in u;if(f===void 0&&(!d||Zt(u,l)?.writable)&&(f=i(()=>{var _=pn(d?u[l]:le),v=se(_);return v}),n.set(l,f)),f!==void 0){var h=p(f);return h===le?void 0:h}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var f=n.get(l);f&&(c.value=p(f))}else if(c===void 0){var d=n.get(l),h=d?.v;if(d!==void 0&&h!==le)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(u,l){if(l===Ct)return!0;var c=n.get(l),f=c!==void 0&&c.v!==le||Reflect.has(u,l);if(c!==void 0||B!==null&&(!f||Zt(u,l)?.writable)){c===void 0&&(c=i(()=>{var h=f?pn(u[l]):le,_=se(h);return _}),n.set(l,c));var d=p(c);if(d===le)return!1}return f},set(u,l,c,f){var d=n.get(l),h=l in u;if(r&&l==="length")for(var _=c;_<d.v;_+=1){var v=n.get(_+"");v!==void 0?R(v,le):_ in u&&(v=i(()=>se(le)),n.set(_+"",v))}if(d===void 0)(!h||Zt(u,l)?.writable)&&(d=i(()=>se(void 0)),R(d,pn(c)),n.set(l,d));else{h=d.v!==le;var g=i(()=>pn(c));R(d,g)}var b=Reflect.getOwnPropertyDescriptor(u,l);if(b?.set&&b.set.call(f,c),!h){if(r&&typeof l=="string"){var x=n.get("length"),y=Number(l);Number.isInteger(y)&&y>=x.v&&R(x,y+1)}mn(a)}return!0},ownKeys(u){p(a);var l=Reflect.ownKeys(u).filter(d=>{var h=n.get(d);return h===void 0||h.v!==le});for(var[c,f]of n)f.v!==le&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Ca()}})}function Zr(e){try{if(e!==null&&typeof e=="object"&&Ct in e)return e[Ct]}catch{}return e}function qa(e,t){return Object.is(Zr(e),Zr(t))}var kr,ys,ks,xs;function Ba(){if(kr===void 0){kr=window,ys=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;ks=Zt(t,"firstChild").get,xs=Zt(t,"nextSibling").get,Xr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Xr(n)&&(n.__t=void 0)}}function fn(e=""){return document.createTextNode(e)}function jn(e){return ks.call(e)}function xn(e){return xs.call(e)}function P(e,t){return jn(e)}function G(e,t=!1){{var n=jn(e);return n instanceof Comment&&n.data===""?xn(n):n}}function w(e,t=1,n=!1){let r=e;for(;t--;)r=xn(r);return r}function Wa(e){e.textContent=""}function Ss(){return!1}const Ga=new WeakMap;function $s(e){var t=B;if(t===null)return q.f|=Ht,e;if((t.f&Ar)===0){if((t.f&Or)===0)throw!t.parent&&e instanceof Error&&Cs(e),e;t.b.error(e)}else rn(e,t)}function rn(e,t){for(;t!==null;){if((t.f&Or)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&Cs(e),e}function Cs(e){const t=Ga.get(e);t&&(Nn(e,"message",{value:t.message}),Nn(e,"stack",{value:t.stack}))}const ur=new Set;let Z=null,On=null,xr=new Set,jt=[],Jn=null,Sr=!1,gn=!1;class ft{current=new Map;#a=new Map;#t=new Set;#d=0;#o=null;#c=!1;#s=[];#n=[];#e=[];#r=[];#i=[];#f=[];#u=[];skipped_effects=new Set;process(t){jt=[],On=null;for(const a of t)this.#_(a);if(this.#s.length===0&&this.#d===0){this.#v();var n=this.#e,r=this.#r;this.#e=[],this.#r=[],this.#i=[],On=Z,Z=null,Kr(n),Kr(r),Z===null?Z=this:ur.delete(this),this.#o?.resolve()}else this.#l(this.#e),this.#l(this.#r),this.#l(this.#i);for(const a of this.#s)Qt(a);for(const a of this.#n)Qt(a);this.#s=[],this.#n=[]}#_(t){t.f^=be;for(var n=t.first;n!==null;){var r=n.f,a=(r&(mt|Ft))!==0,o=a&&(r&be)!==0,i=o||(r&tt)!==0||this.skipped_effects.has(n);if(!i&&n.fn!==null){if(a)n.f^=be;else if((r&Tr)!==0)this.#r.push(n);else if((r&be)===0)if((r&Ur)!==0){var u=n.b?.is_pending()?this.#n:this.#s;u.push(n)}else Zn(n)&&((n.f&on)!==0&&this.#i.push(n),Qt(n));var l=n.first;if(l!==null){n=l;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)n=c.next,c=c.parent}}#l(t){for(const n of t)((n.f&Ge)!==0?this.#f:this.#u).push(n),Re(n,be);t.length=0}capture(t,n){this.#a.has(t)||this.#a.set(t,n),this.current.set(t,t.v)}activate(){Z=this}deactivate(){Z=null,On=null;for(const t of xr)if(xr.delete(t),t(),Z!==null)break}neuter(){this.#c=!0}flush(){jt.length>0?Ls():this.#v(),Z===this&&(this.#d===0&&ur.delete(this),this.deactivate())}#v(){if(!this.#c)for(const t of this.#t)t();this.#t.clear()}increment(){this.#d+=1}decrement(){if(this.#d-=1,this.#d===0){for(const t of this.#f)Re(t,Ge),sn(t);for(const t of this.#u)Re(t,Pt),sn(t);this.#e=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(t){this.#t.add(t)}settled(){return(this.#o??=ha()).promise}static ensure(){if(Z===null){const t=Z=new ft;ur.add(Z),gn||ft.enqueue(()=>{Z===t&&t.flush()})}return Z}static enqueue(t){qt(t)}}function Es(e){var t=gn;gn=!0;try{for(var n;;){if(Ma(),jt.length===0&&!Ha()&&(Z?.flush(),jt.length===0))return Jn=null,n;Ls()}}finally{gn=t}}function Ls(){var e=Kt;Sr=!0;try{var t=0;for(es(!0);jt.length>0;){var n=ft.ensure();if(t++>1e3){var r,a;Va()}n.process(jt),Et.clear()}}finally{Sr=!1,es(e),Jn=null}}function Va(){try{Sa()}catch(e){rn(e,Jn)}}let At=null;function Kr(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(ln|tt))===0&&Zn(r)&&(At=[],Qt(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Ws(r):r.fn=null),At?.length>0)){Et.clear();for(const a of At)Qt(a);At=[]}}At=null}}function sn(e){for(var t=Jn=e;t.parent!==null;){t=t.parent;var n=t.f;if(Sr&&t===B&&(n&on)!==0)return;if((n&(Ft|mt))!==0){if((n&be)===0)return;t.f^=be}}jt.push(t)}function za(e){let t=0,n=ht(0),r;return()=>{co()&&(p(n),Sn(()=>(t===0&&(r=I(()=>e(()=>mn(n)))),t+=1,()=>{qt(()=>{t-=1,t===0&&(r?.(),r=void 0,mn(n))})})))}}var Ja=yn|un|Or;function Xa(e,t,n){new Ya(e,t,n)}class Ya{parent;#a=!1;#t;#d=null;#o;#c;#s;#n=null;#e=null;#r=null;#i=null;#f=0;#u=0;#_=!1;#l=null;#v=()=>{this.#l&&it(this.#l,this.#f)};#m=za(()=>(this.#l=ht(this.#f),()=>{this.#l=null}));constructor(t,n,r){this.#t=t,this.#o=n,this.#c=r,this.parent=B.b,this.#a=!!this.#o.pending,this.#s=$n(()=>{B.b=this;{try{this.#n=$e(()=>r(this.#t))}catch(a){this.error(a)}this.#u>0?this.#h():this.#a=!1}},Ja)}#b(){try{this.#n=$e(()=>this.#c(this.#t))}catch(t){this.error(t)}this.#a=!1}#w(){const t=this.#o.pending;t&&(this.#e=$e(()=>t(this.#t)),ft.enqueue(()=>{this.#n=this.#p(()=>(ft.ensure(),$e(()=>this.#c(this.#t)))),this.#u>0?this.#h():(_t(this.#e,()=>{this.#e=null}),this.#a=!1)}))}is_pending(){return this.#a||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#o.pending}#p(t){var n=B,r=q,a=Q;Ve(this.#s),we(this.#s),Lt(this.#s.ctx);try{return t()}catch(o){return $s(o),null}finally{Ve(n),we(r),Lt(a)}}#h(){const t=this.#o.pending;this.#n!==null&&(this.#i=document.createDocumentFragment(),Za(this.#n,this.#i)),this.#e===null&&(this.#e=$e(()=>t(this.#t)))}#g(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#g(t);return}this.#u+=t,this.#u===0&&(this.#a=!1,this.#e&&_t(this.#e,()=>{this.#e=null}),this.#i&&(this.#t.before(this.#i),this.#i=null))}update_pending_count(t){this.#g(t),this.#f+=t,xr.add(this.#v)}get_effect_pending(){return this.#m(),p(this.#l)}error(t){var n=this.#o.onerror;let r=this.#o.failed;if(this.#_||!n&&!r)throw t;this.#n&&(Ne(this.#n),this.#n=null),this.#e&&(Ne(this.#e),this.#e=null),this.#r&&(Ne(this.#r),this.#r=null);var a=!1,o=!1;const i=()=>{if(a){ja();return}a=!0,o&&La(),ft.ensure(),this.#f=0,this.#r!==null&&_t(this.#r,()=>{this.#r=null}),this.#a=this.has_pending_snippet(),this.#n=this.#p(()=>(this.#_=!1,$e(()=>this.#c(this.#t)))),this.#u>0?this.#h():this.#a=!1};var u=q;try{we(null),o=!0,n?.(t,i),o=!1}catch(l){rn(l,this.#s&&this.#s.parent)}finally{we(u)}r&&qt(()=>{this.#r=this.#p(()=>{this.#_=!0;try{return $e(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return rn(l,this.#s.parent),null}finally{this.#_=!1}})})}}function Za(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var a=n===r?null:xn(n);t.append(n),n=a}}function Ka(e,t,n){const r=cn()?Xn:Mr;if(t.length===0){n(e.map(r));return}var a=Z,o=B,i=Qa();Promise.all(t.map(u=>eo(u))).then(u=>{a?.activate(),i();try{n([...e.map(r),...u])}catch(l){(o.f&ln)===0&&rn(l,o)}a?.deactivate(),Ps()}).catch(u=>{rn(u,o)})}function Qa(){var e=B,t=q,n=Q,r=Z;return function(){Ve(e),we(t),Lt(n),r?.activate()}}function Ps(){Ve(null),we(null),Lt(null)}function Xn(e){var t=He|Ge,n=q!==null&&(q.f&He)!==0?q:null;return B===null||n!==null&&(n.f&We)!==0?t|=We:B.f|=un,{ctx:Q,deps:null,effects:null,equals:hs,f:t,fn:e,reactions:null,rv:0,v:le,wv:0,parent:n??B,ac:null}}function eo(e,t){let n=B;n===null&&wa();var r=n.b,a=void 0,o=ht(le),i=null,u=!q;return vo(()=>{try{var l=e();i&&Promise.resolve(l).catch(()=>{})}catch(_){l=Promise.reject(_)}var c=()=>l;a=i?.then(c,c)??Promise.resolve(l),i=a;var f=Z,d=r.is_pending();u&&(r.update_pending_count(1),d||f.increment());const h=(_,v=void 0)=>{i=null,d||f.activate(),v?v!==Nr&&(o.f|=Ht,it(o,v)):((o.f&Ht)!==0&&(o.f^=Ht),it(o,_)),u&&(r.update_pending_count(-1),d||f.decrement()),Ps()};if(a.then(h,_=>h(null,_||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(l=>{function c(f){function d(){f===a?l(o):c(a)}f.then(d,d)}c(a)})}function qe(e){const t=Xn(e);return Os(t),t}function Mr(e){const t=Xn(e);return t.equals=gs,t}function Rs(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ne(t[n])}}function to(e){for(var t=e.parent;t!==null;){if((t.f&He)===0)return t;t=t.parent}return null}function Dr(e){var t,n=B;Ve(to(e));try{Rs(e),t=Hs(e)}finally{Ve(n)}return t}function Is(e){var t=Dr(e);if(e.equals(t)||(e.v=t,e.wv=Us()),!dn){var n=(St||(e.f&We)!==0)&&e.deps!==null?Pt:be;Re(e,n)}}const Et=new Map;function ht(e,t){var n={f:0,v:e,reactions:null,equals:hs,rv:0,wv:0};return n}function se(e,t){const n=ht(e);return Os(n),n}function Be(e,t=!1,n=!0){const r=ht(e);return t||(r.equals=gs),kn&&n&&Q!==null&&Q.l!==null&&(Q.l.s??=[]).push(r),r}function R(e,t,n=!1){q!==null&&(!Qe||(q.f&Yr)!==0)&&cn()&&(q.f&(He|on|Ur|Yr))!==0&&!dt?.includes(e)&&Ea();let r=n?pn(t):t;return it(e,r)}function it(e,t){if(!e.equals(t)){var n=e.v;dn?Et.set(e,t):Et.set(e,n),e.v=t;var r=ft.ensure();r.capture(e,n),(e.f&He)!==0&&((e.f&Ge)!==0&&Dr(e),Re(e,(e.f&We)===0?be:Pt)),e.wv=Us(),Ts(e,Ge),cn()&&B!==null&&(B.f&be)!==0&&(B.f&(mt|Ft))===0&&(Fe===null?ao([e]):Fe.push(e))}return t}function mn(e){R(e,e.v+1)}function Ts(e,t){var n=e.reactions;if(n!==null)for(var r=cn(),a=n.length,o=0;o<a;o++){var i=n[o],u=i.f;if(!(!r&&i===B)){var l=(u&Ge)===0;l&&Re(i,t),(u&He)!==0?Ts(i,Pt):l&&((u&on)!==0&&At!==null&&At.push(i),sn(i))}}}let Jt=null;function no(e){var t=Jt;try{if(Jt=new Set,I(e),t!==null)for(var n of Jt)t.add(n);return Jt}finally{Jt=t}}function ro(e){for(var t of no(e))it(t,t.v)}let Qr=!1;function so(){Qr||(Qr=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Yn(e){var t=q,n=B;we(null),Ve(null);try{return e()}finally{we(t),Ve(n)}}function jr(e,t,n,r=n){e.addEventListener(t,()=>Yn(n));const a=e.__on_r;a?e.__on_r=()=>{a(),r(!0)}:e.__on_r=()=>r(!0),so()}let Kt=!1;function es(e){Kt=e}let dn=!1;function ts(e){dn=e}let q=null,Qe=!1;function we(e){q=e}let B=null;function Ve(e){B=e}let dt=null;function Os(e){q!==null&&(dt===null?dt=[e]:dt.push(e))}let Se=null,Ae=0,Fe=null;function ao(e){Fe=e}let As=1,wn=0,Mt=wn;function ns(e){Mt=e}let St=!1;function Us(){return++As}function Zn(e){var t=e.f;if((t&Ge)!==0)return!0;if((t&Pt)!==0){var n=e.deps,r=(t&We)!==0;if(n!==null){var a,o,i=(t&Mn)!==0,u=r&&B!==null&&!St,l=n.length;if((i||u)&&(B===null||(B.f&ln)===0)){var c=e,f=c.parent;for(a=0;a<l;a++)o=n[a],(i||!o?.reactions?.includes(c))&&(o.reactions??=[]).push(c);i&&(c.f^=Mn),u&&f!==null&&(f.f&We)===0&&(c.f^=We)}for(a=0;a<l;a++)if(o=n[a],Zn(o)&&Is(o),o.wv>e.wv)return!0}(!r||B!==null&&!St)&&Re(e,be)}return!1}function Ns(e,t,n=!0){var r=e.reactions;if(r!==null&&!dt?.includes(e))for(var a=0;a<r.length;a++){var o=r[a];(o.f&He)!==0?Ns(o,t,!1):t===o&&(n?Re(o,Ge):(o.f&be)!==0&&Re(o,Pt),sn(o))}}function Hs(e){var t=Se,n=Ae,r=Fe,a=q,o=St,i=dt,u=Q,l=Qe,c=Mt,f=e.f;Se=null,Ae=0,Fe=null,St=(f&We)!==0&&(Qe||!Kt||q===null),q=(f&(mt|Ft))===0?e:null,dt=null,Lt(e.ctx),Qe=!1,Mt=++wn,e.ac!==null&&(Yn(()=>{e.ac.abort(Nr)}),e.ac=null);try{e.f|=yr;var d=e.fn,h=d(),_=e.deps;if(Se!==null){var v;if(Fn(e,Ae),_!==null&&Ae>0)for(_.length=Ae+Se.length,v=0;v<Se.length;v++)_[Ae+v]=Se[v];else e.deps=_=Se;if(!St||(f&He)!==0&&e.reactions!==null)for(v=Ae;v<_.length;v++)(_[v].reactions??=[]).push(e)}else _!==null&&Ae<_.length&&(Fn(e,Ae),_.length=Ae);if(cn()&&Fe!==null&&!Qe&&_!==null&&(e.f&(He|Pt|Ge))===0)for(v=0;v<Fe.length;v++)Ns(Fe[v],e);return a!==null&&a!==e&&(wn++,Fe!==null&&(r===null?r=Fe:r.push(...Fe))),(e.f&Ht)!==0&&(e.f^=Ht),h}catch(g){return $s(g)}finally{e.f^=yr,Se=t,Ae=n,Fe=r,q=a,St=o,dt=i,Lt(u),Qe=l,Mt=c}}function oo(e,t){let n=t.reactions;if(n!==null){var r=fa.call(n,e);if(r!==-1){var a=n.length-1;a===0?n=t.reactions=null:(n[r]=n[a],n.pop())}}n===null&&(t.f&He)!==0&&(Se===null||!Se.includes(t))&&(Re(t,Pt),(t.f&(We|Mn))===0&&(t.f^=Mn),Rs(t),Fn(t,0))}function Fn(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)oo(e,n[r])}function Qt(e){var t=e.f;if((t&ln)===0){Re(e,be);var n=B,r=Kt;B=e,Kt=!0;try{(t&on)!==0?po(e):Bs(e),qs(e);var a=Hs(e);e.teardown=typeof a=="function"?a:null,e.wv=As;var o;_s&&Pa&&(e.f&Ge)!==0&&e.deps}finally{Kt=r,B=n}}}async function io(){await Promise.resolve(),Es()}function p(e){var t=e.f,n=(t&He)!==0;if(Jt?.add(e),q!==null&&!Qe){var r=B!==null&&(B.f&ln)!==0;if(!r&&!dt?.includes(e)){var a=q.deps;if((q.f&yr)!==0)e.rv<wn&&(e.rv=wn,Se===null&&a!==null&&a[Ae]===e?Ae++:Se===null?Se=[e]:(!St||!Se.includes(e))&&Se.push(e));else{(q.deps??=[]).push(e);var o=e.reactions;o===null?e.reactions=[q]:o.includes(q)||o.push(q)}}}else if(n&&e.deps===null&&e.effects===null){var i=e,u=i.parent;u!==null&&(u.f&We)===0&&(i.f^=We)}if(dn){if(Et.has(e))return Et.get(e);if(n){i=e;var l=i.v;return((i.f&be)===0&&i.reactions!==null||Ms(i))&&(l=Dr(i)),Et.set(i,l),l}}else n&&(i=e,Zn(i)&&Is(i));if((e.f&Ht)!==0)throw e.v;return e.v}function Ms(e){if(e.v===le)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Et.has(t)||(t.f&He)!==0&&Ms(t))return!0;return!1}function K(e){return e&&p(e)}function I(e){var t=Qe;try{return Qe=!0,e()}finally{Qe=t}}const lo=-7169;function Re(e,t){e.f=e.f&lo|t}function Ds(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ct in e)$r(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Ct in n&&$r(n)}}}function $r(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{$r(e[r],t)}catch{}const n=Ir(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=vs(n);for(let a in r){const o=r[a].get;if(o)try{o.call(e)}catch{}}}}}function js(e){B===null&&q===null&&xa(),q!==null&&(q.f&We)!==0&&B===null&&ka(),dn&&ya()}function uo(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function lt(e,t,n,r=!0){var a=B;a!==null&&(a.f&tt)!==0&&(e|=tt);var o={ctx:Q,deps:null,nodes_start:null,nodes_end:null,f:e|Ge,first:null,fn:t,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Qt(o),o.f|=Ar}catch(l){throw Ne(o),l}else t!==null&&sn(o);if(r){var i=o;if(n&&i.deps===null&&i.teardown===null&&i.nodes_start===null&&i.first===i.last&&(i.f&un)===0&&(i=i.first),i!==null&&(i.parent=a,a!==null&&uo(i,a),q!==null&&(q.f&He)!==0&&(e&Ft)===0)){var u=q;(u.effects??=[]).push(i)}}return o}function co(){return q!==null&&!Qe}function Kn(e){const t=lt(Gn,null,!1);return Re(t,be),t.teardown=e,t}function an(e){js();var t=B.f,n=!q&&(t&mt)!==0&&(t&Ar)===0;if(n){var r=Q;(r.e??=[]).push(e)}else return Fs(e)}function Fs(e){return lt(Tr|ps,e,!1)}function fo(e){return js(),lt(Gn|ps,e,!0)}function _o(e){ft.ensure();const t=lt(Ft|un,e,!0);return(n={})=>new Promise(r=>{n.outro?_t(t,()=>{Ne(t),r(void 0)}):(Ne(t),r(void 0))})}function Fr(e){return lt(Tr,e,!1)}function vo(e){return lt(Ur|un,e,!0)}function Sn(e,t=0){return lt(Gn|t,e,!0)}function V(e,t=[],n=[]){Ka(t,n,r=>{lt(Gn,()=>e(...r.map(p)),!0)})}function $n(e,t=0){var n=lt(on|t,e,!0);return n}function $e(e,t=!0){return lt(mt|un,e,!0,t)}function qs(e){var t=e.teardown;if(t!==null){const n=dn,r=q;ts(!0),we(null);try{t.call(null)}finally{ts(n),we(r)}}}function Bs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const a=n.ac;a!==null&&Yn(()=>{a.abort(Nr)});var r=n.next;(n.f&Ft)!==0?n.parent=null:Ne(n,t),n=r}}function po(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&mt)===0&&Ne(t),t=n}}function Ne(e,t=!0){var n=!1;(t||(e.f&ma)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(ho(e.nodes_start,e.nodes_end),n=!0),Bs(e,t&&!n),Fn(e,0),Re(e,ln);var r=e.transitions;if(r!==null)for(const o of r)o.stop();qs(e);var a=e.parent;a!==null&&a.first!==null&&Ws(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function ho(e,t){for(;e!==null;){var n=e===t?null:xn(e);e.remove(),e=n}}function Ws(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function _t(e,t){var n=[];qr(e,n,!0),Gs(n,()=>{Ne(e),t&&t()})}function Gs(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var a of e)a.out(r)}else t()}function qr(e,t,n){if((e.f&tt)===0){if(e.f^=tt,e.transitions!==null)for(const i of e.transitions)(i.is_global||n)&&t.push(i);for(var r=e.first;r!==null;){var a=r.next,o=(r.f&yn)!==0||(r.f&mt)!==0;qr(r,t,o?n:!1),r=a}}}function en(e){Vs(e,!0)}function Vs(e,t){if((e.f&tt)!==0){e.f^=tt,(e.f&be)===0&&(Re(e,Ge),sn(e));for(var n=e.first;n!==null;){var r=n.next,a=(n.f&yn)!==0||(n.f&mt)!==0;Vs(n,a?t:!1),n=r}if(e.transitions!==null)for(const o of e.transitions)(o.is_global||t)&&o.in()}}const go=["touchstart","touchmove"];function mo(e){return go.includes(e)}const zs=new Set,Cr=new Set;function bo(e,t,n,r={}){function a(o){if(r.capture||hn.call(t,o),!o.cancelBubble)return Yn(()=>n?.call(this,o))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?qt(()=>{t.addEventListener(e,a,r)}):t.addEventListener(e,a,r),a}function wo(e,t,n,r,a){var o={capture:r,passive:a},i=bo(e,t,n,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Kn(()=>{t.removeEventListener(e,i,o)})}function nt(e){for(var t=0;t<e.length;t++)zs.add(e[t]);for(var n of Cr)n(e)}let rs=null;function hn(e){var t=this,n=t.ownerDocument,r=e.type,a=e.composedPath?.()||[],o=a[0]||e.target;rs=e;var i=0,u=rs===e&&e.__root;if(u){var l=a.indexOf(u);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var c=a.indexOf(t);if(c===-1)return;l<=c&&(i=l)}if(o=a[i]||e.target,o!==t){Nn(e,"currentTarget",{configurable:!0,get(){return o||n}});var f=q,d=B;we(null),Ve(null);try{for(var h,_=[];o!==null;){var v=o.assignedSlot||o.parentNode||o.host||null;try{var g=o["__"+r];if(g!=null&&(!o.disabled||e.target===o))if(Wn(g)){var[b,...x]=g;b.apply(o,[e,...x])}else g.call(o,e)}catch(y){h?_.push(y):h=y}if(e.cancelBubble||v===t||v===null)break;o=v}if(h){for(let y of _)queueMicrotask(()=>{throw y});throw h}}finally{e.__root=t,delete e.currentTarget,we(f),Ve(d)}}}function yo(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function qn(e,t){var n=B;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function L(e,t){var n=(t&Oa)!==0,r=(t&Aa)!==0,a,o=!e.startsWith("<!>");return()=>{a===void 0&&(a=yo(o?e:"<!>"+e),n||(a=jn(a)));var i=r||ys?document.importNode(a,!0):a.cloneNode(!0);if(n){var u=jn(i),l=i.lastChild;qn(u,l)}else qn(i,i);return i}}function ss(e=""){{var t=fn(e+"");return qn(t,t),t}}function ot(){var e=document.createDocumentFragment(),t=document.createComment(""),n=fn();return e.append(t,n),qn(t,n),e}function S(e,t){e!==null&&e.before(t)}function me(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function as(e,t){return ko(e,t)}const Vt=new Map;function ko(e,{target:t,anchor:n,props:r={},events:a,context:o,intro:i=!0}){Ba();var u=new Set,l=d=>{for(var h=0;h<d.length;h++){var _=d[h];if(!u.has(_)){u.add(_);var v=mo(_);t.addEventListener(_,hn,{passive:v});var g=Vt.get(_);g===void 0?(document.addEventListener(_,hn,{passive:v}),Vt.set(_,1)):Vt.set(_,g+1)}}};l(Rr(zs)),Cr.add(l);var c=void 0,f=_o(()=>{var d=n??t.appendChild(fn());return Xa(d,{pending:()=>{}},h=>{if(o){ye({});var _=Q;_.c=o}a&&(r.$$events=a),c=e(h,r)||{},o&&ke()}),()=>{for(var h of u){t.removeEventListener(h,hn);var _=Vt.get(h);--_===0?(document.removeEventListener(h,hn),Vt.delete(h)):Vt.set(h,_)}Cr.delete(l),d!==n&&d.parentNode?.removeChild(d)}});return xo.set(c,f),c}let xo=new WeakMap;const cr=0,Rn=1,fr=2;function os(e,t,n,r,a){var o=e,i=cn(),u=Q,l=le,c,f,d,h=i?ht(void 0):Be(void 0,!1,!1),_=i?ht(void 0):Be(void 0,!1,!1),v=!1;function g(x,y){v=!0,y&&(Ve(b),we(b),Lt(u));try{x===cr&&n&&(c?en(c):c=$e(()=>n(o))),x===Rn&&r&&(f?en(f):f=$e(()=>r(o,h))),x===fr&&a&&(d?en(d):d=$e(()=>a(o,_))),x!==cr&&c&&_t(c,()=>c=null),x!==Rn&&f&&_t(f,()=>f=null),x!==fr&&d&&_t(d,()=>d=null)}finally{y&&(Lt(null),we(null),Ve(null),Es())}}var b=$n(()=>{if(l!==(l=t())){if(va(l)){var x=l;v=!1,x.then(y=>{x===l&&(it(h,y),g(Rn,!0))},y=>{if(x===l&&(it(_,y),g(fr,!0),!a))throw _.v}),qt(()=>{v||g(cr,!0)})}else it(h,l),g(Rn,!1);return()=>l=le}})}function X(e,t,n=!1){var r=e,a=null,o=null,i=le,u=n?yn:0,l=!1;const c=(_,v=!0)=>{l=!0,h(v,_)};var f=null;function d(){f!==null&&(f.lastChild.remove(),r.before(f),f=null);var _=i?a:o,v=i?o:a;_&&en(_),v&&_t(v,()=>{i?o=null:a=null})}const h=(_,v)=>{if(i!==(i=_)){var g=Ss(),b=r;if(g&&(f=document.createDocumentFragment(),f.append(b=fn())),i?a??=v&&$e(()=>v(b)):o??=v&&$e(()=>v(b)),g){var x=Z,y=i?a:o,U=i?o:a;y&&x.skipped_effects.delete(y),U&&x.skipped_effects.add(U),x.add_callback(d)}else d()}};$n(()=>{l=!1,t(c),l||h(null,null)},u)}function Ut(e,t){return t}function So(e,t,n){for(var r=e.items,a=[],o=t.length,i=0;i<o;i++)qr(t[i].e,a,!0);var u=o>0&&a.length===0&&n!==null;if(u){var l=n.parentNode;Wa(l),l.append(n),r.clear(),at(e,t[0].prev,t[o-1].next)}Gs(a,()=>{for(var c=0;c<o;c++){var f=t[c];u||(r.delete(f.k),at(e,f.prev,f.next)),Ne(f.e,!u)}})}function $t(e,t,n,r,a,o=null){var i=e,u={flags:t,items:new Map,first:null},l=(t&bs)!==0;if(l){var c=e;i=c.appendChild(fn())}var f=null,d=!1,h=new Map,_=Mr(()=>{var x=n();return Wn(x)?x:x==null?[]:Rr(x)}),v,g;function b(){$o(g,v,u,h,i,a,t,r,n),o!==null&&(v.length===0?f?en(f):f=$e(()=>o(i)):f!==null&&_t(f,()=>{f=null}))}$n(()=>{g??=B,v=p(_);var x=v.length;if(!(d&&x===0)){d=x===0;var y,U,M,j;if(Ss()){var $=new Set,C=Z;for(U=0;U<x;U+=1){M=v[U],j=r(M,U);var H=u.items.get(j)??h.get(j);H?(t&(Vn|zn))!==0&&Js(H,M,U,t):(y=Xs(null,u,null,null,M,j,U,a,t,n,!0),h.set(j,y)),$.add(j)}for(const[F,ue]of u.items)$.has(F)||C.skipped_effects.add(ue.e);C.add_callback(b)}else b();p(_)}})}function $o(e,t,n,r,a,o,i,u,l){var c=(i&Ia)!==0,f=(i&(Vn|zn))!==0,d=t.length,h=n.items,_=n.first,v=_,g,b=null,x,y=[],U=[],M,j,$,C;if(c)for(C=0;C<d;C+=1)M=t[C],j=u(M,C),$=h.get(j),$!==void 0&&($.a?.measure(),(x??=new Set).add($));for(C=0;C<d;C+=1){if(M=t[C],j=u(M,C),$=h.get(j),$===void 0){var H=r.get(j);if(H!==void 0){r.delete(j),h.set(j,H);var F=b?b.next:v;at(n,b,H),at(n,H,F),dr(H,F,a),b=H}else{var ue=v?v.e.nodes_start:a;b=Xs(ue,n,b,b===null?n.first:b.next,M,j,C,o,i,l)}h.set(j,b),y=[],U=[],v=b.next;continue}if(f&&Js($,M,C,i),($.e.f&tt)!==0&&(en($.e),c&&($.a?.unfix(),(x??=new Set).delete($))),$!==v){if(g!==void 0&&g.has($)){if(y.length<U.length){var te=U[0],D;b=te.prev;var oe=y[0],Me=y[y.length-1];for(D=0;D<y.length;D+=1)dr(y[D],te,a);for(D=0;D<U.length;D+=1)g.delete(U[D]);at(n,oe.prev,Me.next),at(n,b,oe),at(n,Me,te),v=te,b=Me,C-=1,y=[],U=[]}else g.delete($),dr($,v,a),at(n,$.prev,$.next),at(n,$,b===null?n.first:b.next),at(n,b,$),b=$;continue}for(y=[],U=[];v!==null&&v.k!==j;)(v.e.f&tt)===0&&(g??=new Set).add(v),U.push(v),v=v.next;if(v===null)continue;$=v}y.push($),b=$,v=$.next}if(v!==null||g!==void 0){for(var Ce=g===void 0?[]:Rr(g);v!==null;)(v.e.f&tt)===0&&Ce.push(v),v=v.next;var ce=Ce.length;if(ce>0){var ge=(i&bs)!==0&&d===0?a:null;if(c){for(C=0;C<ce;C+=1)Ce[C].a?.measure();for(C=0;C<ce;C+=1)Ce[C].a?.fix()}So(n,Ce,ge)}}c&&qt(()=>{if(x!==void 0)for($ of x)$.a?.apply()}),e.first=n.first&&n.first.e,e.last=b&&b.e;for(var rt of r.values())Ne(rt.e);r.clear()}function Js(e,t,n,r){(r&Vn)!==0&&it(e.v,t),(r&zn)!==0?it(e.i,n):e.i=n}function Xs(e,t,n,r,a,o,i,u,l,c,f){var d=(l&Vn)!==0,h=(l&Ta)===0,_=d?h?Be(a,!1,!1):ht(a):a,v=(l&zn)===0?i:ht(i),g={i:v,v:_,k:o,a:null,e:null,prev:n,next:r};try{if(e===null){var b=document.createDocumentFragment();b.append(e=fn())}return g.e=$e(()=>u(e,_,v,c),Fa),g.e.prev=n&&n.e,g.e.next=r&&r.e,n===null?f||(t.first=g):(n.next=g,n.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function dr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,a=t?t.e.nodes_start:n,o=e.e.nodes_start;o!==null&&o!==r;){var i=xn(o);a.before(o),o=i}}function at(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function Bn(e,t,...n){var r=e,a=et,o;$n(()=>{a!==(a=t())&&(o&&(Ne(o),o=null),o=$e(()=>a(r,...n)))},yn)}function Co(e,t,n){Fr(()=>{var r=I(()=>t(e,n?.())||{});if(n&&r?.update){var a=!1,o={};Sn(()=>{var i=n();Ds(i),a&&Hr(o,i)&&(o=i,r.update(i))}),a=!0}if(r?.destroy)return()=>r.destroy()})}function Ys(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Ys(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Eo(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Ys(e))&&(r&&(r+=" "),r+=t);return r}function An(e){return typeof e=="object"?Eo(e):e??""}const is=[...` 	
\r\f \v\uFEFF`];function Lo(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var o=a.length,i=0;(i=r.indexOf(a,i))>=0;){var u=i+o;(i===0||is.includes(r[i-1]))&&(u===r.length||is.includes(r[u]))?r=(i===0?"":r.substring(0,i))+r.substring(u+1):i=u}}return r===""?null:r}function Ie(e,t,n,r,a,o){var i=e.__className;if(i!==n||i===void 0){var u=Lo(n,r,o);u==null?e.removeAttribute("class"):e.className=u,e.__className=n}else if(o&&a!==o)for(var l in o){var c=!!o[l];(a==null||c!==!!a[l])&&e.classList.toggle(l,c)}return o}function Br(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Wn(t))return Da();for(var r of e.options)r.selected=t.includes(bn(r));return}for(r of e.options){var a=bn(r);if(qa(a,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Zs(e){var t=new MutationObserver(()=>{Br(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Kn(()=>{t.disconnect()})}function Wr(e,t,n=t){var r=!0;jr(e,"change",a=>{var o=a?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(o),bn);else{var u=e.querySelector(o)??e.querySelector("option:not([disabled])");i=u&&bn(u)}n(i)}),Fr(()=>{var a=t();if(Br(e,a,r),r&&a===void 0){var o=e.querySelector(":checked");o!==null&&(a=bn(o),n(a))}e.__value=a,r=!1}),Zs(e)}function bn(e){return"__value"in e?e.__value:e.value}const Po=Symbol("is custom element"),Ro=Symbol("is html");function vt(e,t,n,r){var a=Io(e);a[t]!==(a[t]=n)&&(t==="loading"&&(e[ba]=n),n==null?e.removeAttribute(t):typeof n!="string"&&To(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Io(e){return e.__attributes??={[Po]:e.nodeName.includes("-"),[Ro]:e.namespaceURI===Ua}}var ls=new Map;function To(e){var t=e.getAttribute("is")||e.nodeName,n=ls.get(t);if(n)return n;ls.set(t,n=[]);for(var r,a=e,o=Element.prototype;o!==a;){r=vs(a);for(var i in r)r[i].set&&n.push(i);a=Ir(a)}return n}function Nt(e,t,n=t){var r=new WeakSet;jr(e,"input",async a=>{var o=a?e.defaultValue:e.value;if(o=_r(e)?vr(o):o,n(o),Z!==null&&r.add(Z),await io(),o!==(o=t())){var i=e.selectionStart,u=e.selectionEnd;e.value=o??"",u!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(u,e.value.length))}}),I(t)==null&&e.value&&(n(_r(e)?vr(e.value):e.value),Z!==null&&r.add(Z)),Sn(()=>{var a=t();if(e===document.activeElement){var o=On??Z;if(r.has(o))return}_r(e)&&a===vr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function tn(e,t,n=t){jr(e,"change",r=>{var a=r?e.defaultChecked:e.checked;n(a)}),I(t)==null&&n(e.checked),Sn(()=>{var r=t();e.checked=!!r})}function _r(e){var t=e.type;return t==="number"||t==="range"}function vr(e){return e===""?null:+e}function Ks(e,t,n){var r=Zt(e,t);r&&r.set&&(e[t]=n,Kn(()=>{e[t]=null}))}function us(e,t){return e===t||e?.[Ct]===t}function gt(e={},t,n,r){return Fr(()=>{var a,o;return Sn(()=>{a=o,o=[],I(()=>{e!==n(...o)&&(t(e,...o),a&&us(n(...a),e)&&t(null,...a))})}),()=>{qt(()=>{o&&us(n(...o),e)&&t(null,...o)})}}),e}function Rt(e=!1){const t=Q,n=t.l.u;if(!n)return;let r=()=>Ds(t.s);if(e){let a=0,o={};const i=Xn(()=>{let u=!1;const l=t.s;for(const c in l)l[c]!==o[c]&&(o[c]=l[c],u=!0);return u&&a++,a});r=()=>p(i)}n.b.length&&fo(()=>{cs(t,r),Hn(n.b)}),an(()=>{const a=I(()=>n.m.map(pa));return()=>{for(const o of a)typeof o=="function"&&o()}}),n.a.length&&an(()=>{cs(t,r),Hn(n.a)})}function cs(e,t){if(e.l.s)for(const n of e.l.s)p(n);t()}let Er=Symbol();function he(e,t,n){const r=n[t]??={store:null,source:Be(void 0),unsubscribe:et};if(r.store!==e&&!(Er in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=et;else{var a=!0;r.unsubscribe=Qs(e,o=>{a?r.source.v=o:R(r.source,o)}),a=!1}return e&&Er in n?Le(e):p(r.source)}function In(e,t){return e.set(t),t}function ze(){const e={};function t(){Kn(()=>{for(var n in e)e[n].unsubscribe();Nn(e,Er,{enumerable:!1,value:!0})})}return[e,t]}function ae(e,t,n){return e.set(n),t}function nn(e,t,n,r){var a=r,o=!0,i=()=>(o&&(o=!1,a=r),a),u;u=e[t],u===void 0&&r!==void 0&&(u=i());var l;return l=()=>{var c=e[t];return c===void 0?i():(o=!0,c)},l}function Gr(e){Q===null&&ms(),kn&&Q.l!==null?Ao(Q).m.push(e):an(()=>{const t=I(e);if(typeof t=="function")return t})}function Oo(e){Q===null&&ms(),Gr(()=>()=>I(e))}function Ao(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}function Qs(e,t,n){if(e==null)return t(void 0),et;const r=I(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const zt=[];function Dt(e,t=et){let n=null;const r=new Set;function a(u){if(Hr(e,u)&&(e=u,n)){const l=!zt.length;for(const c of r)c[1](),zt.push(c,e);if(l){for(let c=0;c<zt.length;c+=2)zt[c][0](zt[c+1]);zt.length=0}}}function o(u){a(u(e))}function i(u,l=et){const c=[u,l];return r.add(c),r.size===1&&(n=t(a,o)||et),u(e),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:a,update:o,subscribe:i}}function Le(e){let t;return Qs(e,n=>t=n)(),t}var Lr=(e=>(e.info="info",e.warn="warn",e.error="error",e))(Lr||{});class Uo{logs=Dt([]);_addLog(t,n){this.logs.update(r=>(r.unshift({date:new Date,severity:t,content:n}),r))}info(t){this._addLog("info",t)}warn(t){this._addLog("warn",t)}error(t){this._addLog("error",t)}updateLogAtIndex(t,n){this.logs.update(r=>(r[t]&&(r[t].content=n),r))}}const A=new Uo;function No(e,t){let n=!1;return e.subscribe(r=>{n?t(r):n=!0})}const Ho={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,discard_expired_sessions:!0,rs_launch_command:null,osrs_launch_command:null,runelite_custom_jar:null,runelite_launch_command:null,hdos_launch_command:null,selected:{game:Ee.osrs,client:Yt.runelite,user_id:null},userDetails:{}};function Mo(){const t=new URLSearchParams(window.location.search).get("config");function n(a){return typeof a=="object"&&typeof a.use_dark_theme=="boolean"&&typeof a.rs_plugin_loader=="boolean"&&typeof a.close_after_launch=="boolean"&&typeof a.check_announcements=="boolean"&&typeof a.flatpak_rich_presence=="boolean"&&typeof a.runelite_use_custom_jar=="boolean"&&typeof a.selected=="object"&&Object.values(Ee).includes(a.selected.game)&&Object.values(Yt).includes(a.selected.client)&&(typeof a.selected.user_id=="string"||a.selected.user_id===null)&&typeof a.userDetails=="object"}const{config:r}=O;if(t)try{const a=JSON.parse(t);typeof a.check_announcements>"u"&&(a.check_announcements=!0,O.configHasPendingChanges=!0),typeof a.close_after_launch>"u"&&(a.close_after_launch=!1,O.configHasPendingChanges=!0),typeof a.discard_expired_sessions>"u"&&(a.discard_expired_sessions=!0,O.configHasPendingChanges=!0),n(a)?r.set(a):(A.error("The config saved on disk is not the correct format. It has been restored to default."),O.configHasPendingChanges=!0)}catch{A.error("Unable to parse config, restoring to default"),O.configHasPendingChanges=!0}else O.configHasPendingChanges=!0;No(O.config,()=>{O.configHasPendingChanges=!0})}const O={initialized:Dt(!1),configHasPendingChanges:!1,pluginConfigHasPendingChanges:!1,config:Dt(Ho),sessions:Dt([])};let pr=!1,hr=!1;class ee{static async login(t,n){const r=await Un.buildSession(t,n);if(!r.ok)return re(r.error);const a=r.value,i=Le(O.sessions).findIndex(u=>u.user.userId===t.sub);return i!==-1?O.sessions.update(u=>(u[i]=a,u)):(O.sessions.update(u=>(u.push(a),u)),O.config.update(u=>(u.selected.user_id=a.user.userId,u))),Ke(a)}static async logout(t){const{sessions:n,config:r}=O;return n.update(a=>{const o=a.findIndex(i=>i.user.userId===t);return o>-1&&(Pe.revokeOauthCreds(a[o].tokens.access_token),a.splice(o,1)),a}),r.update(a=>(typeof a.userDetails[t]<"u"&&delete a.userDetails[t],a.selected.user_id===t&&(a.selected.user_id=null),a)),Le(n)}static postJSON(t,n,r=null){const a=JSON.stringify(n);return fetch(t,{method:"POST",body:a,headers:{"Content-Type":"application/json"}}).then(i=>{i.ok||i.text().then(u=>A.error(`${t} error: ${i.status}: ${u}`)),r&&r(i)})}static saveConfig(t=!0){if(pr||t&&!O.configHasPendingChanges)return;pr=!0;const n=Le(O.config);return n.rs_launch_command===""&&(n.rs_launch_command=null),n.osrs_launch_command===""&&(n.osrs_launch_command=null),n.runelite_launch_command===""&&(n.runelite_launch_command=null),n.hdos_launch_command===""&&(n.hdos_launch_command=null),this.postJSON("/save-config",n,()=>pr=!1),n}static savePluginConfig(t=!0){hr||t&&!O.pluginConfigHasPendingChanges||(hr=!0,this.postJSON("/save-plugin-config",k.pluginConfig,()=>hr=!1))}static async saveCredentials(){return this.postJSON("/save-credentials",Le(O.sessions))}static async openFilePicker(){const t=await fetch("/jar-file-picker");return t.status===200?t.text():null}static findSession(t){return Le(O.sessions).find(r=>r.user.userId===t)}static findAccount(t,n){return t.find(r=>r.accountId==n)}}const Pr=Dt([]),Do="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Do);Ra();var jo=L("<main><!></main>");function ea(e,t){const n=()=>he(o,"$config",r),[r,a]=ze(),{config:o}=O;let i=qe(()=>n().use_dark_theme);var u=jo();let l;var c=P(u);Bn(c,()=>t.children??et),V(f=>l=Ie(u,1,"fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50",null,l,f),[()=>({dark:p(i)})]),S(e,u),a()}var Fo=L('<div class="flex h-full items-center justify-center"><img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/></div>');function qo(e,t){ye(t,!1);const n=window.opener;k.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function r(u){const l=Xt.get("auth_verifier");if(!l)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:c,redirect:f}=k.env,d=await Pe.getOAuthToken(k.env.origin,c,l,f,u);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function a(u){const l=Xt.get("auth_nonce"),c=Pe.validateIdToken(u,l??"");if(!c.ok)return o(c.error),null;const f=await Pe.getSessionId(k.env.auth_api,u);return f.ok?f.value:(o(`Unable to retreive session id. ${f.error}`),null)}function o(u){i({type:"authFailed",reason:u}),fetch("/close")}function i(u){n.postMessage(u,window.location.origin)}Gr(async()=>{const u=new URLSearchParams(window.location.search),l=u.get("code"),c=u.get("state"),f=u.get("id_token");if(f==null&&l&&c){const d=await r(l);if(!d)return o("tokens object is null.");i({type:"authTokenUpdate",tokens:d});const h=crypto.randomUUID();Pe.navigateToAuthConsent(k.env.origin,d.id_token,h)}else if(f&&l&&c){const d=await a(f);if(!d)return o("sessionId is null");i({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),Oo(()=>{Xt.remove("auth_verifier"),Xt.remove("auth_nonce")}),Rt(),ea(e,{children:(u,l)=>{var c=Fo();S(u,c)}}),ke()}var Bo=(e,t,n)=>{e.key==="Escape"&&(e.preventDefault(),t()&&n())},Wo=L('<button class="absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button>'),Go=L("<dialog><!> <!></dialog>");function Qn(e,t){ye(t,!0);const n=()=>he(o,"$config",r),[r,a]=ze(),{config:o}=O;let i=qe(()=>n().use_dark_theme),u=nn(t,"class",3,""),l=nn(t,"canSelfClose",3,!0),c=nn(t,"onClose",3,()=>{}),f,d=se(!1);function h(){f.showModal(),R(d,!0)}function _(){c()(),f.close(),R(d,!1)}var v={open:h,close:_},g=Go();g.__keydown=[Bo,l,_],g.__mousedown=$=>{f===$.target&&_()};let b;var x=P(g);{var y=$=>{var C=Wo();C.__click=_,S($,C)};X(x,$=>{l()&&$(y)})}var U=w(x,2);{var M=$=>{var C=ot(),H=G(C);Bn(H,()=>t.children??et),S($,C)};X(U,$=>{p(d)&&$(M)})}gt(g,$=>f=$,()=>f),V($=>b=Ie(g,1,`${u()??""} backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none`,"svelte-1nslvnn",b,$),[()=>({dark:p(i)})]),S(e,g);var j=ke(v);return a(),j}nt(["keydown","mousedown","click"]);var Vo=(e,t)=>p(t).close(),zo=L('<p class="p-2"></p> <p class="p-2"></p> <button class="m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75">I Understand</button>',1);function Jo(e,t){ye(t,!1);const n=()=>he(o,"$sessions",r),[r,a]=ze(),{sessions:o}=O;let i=Be();Gr(()=>{n().length==0&&p(i).open()}),Rt(),gt(Qn(e,{canSelfClose:!1,class:"w-1/2 text-center",children:(u,l)=>{var c=zo(),f=G(c);f.textContent=atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==");var d=w(f,2);d.textContent=atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu");var h=w(d,2);h.__click=[Vo,i],S(u,c)},$$slots:{default:!0},$$legacy:!0}),u=>R(i,u),()=>p(i)),ke(),a()}nt(["click"]);const Ue={method:"GET"},Xo={"Content-Type":"application/octet-stream"};let gr=null;const Yo=120*1e3,Zo="https://api.github.com/repos/runelite/launcher/releases",Ko="https://cdn.hdos.dev/client/getdown.txt",er=e=>e?{method:"POST",headers:Xo,body:e}:Ue,pt=(e,t,n,r)=>{fetch(e,t).then(a=>{a.ok?n(a):(a.text().then(o=>A.error(`request failed: ${a.url}: ${a.status}: ${o}`)),r())}).catch(()=>{A.error(`request failed: ${e}: connection error`),r()})},Vr=async(e,t,n,r,a)=>{const o=h=>{A.error(`error downloading: ${h}`),r()};A.info(t);const i=h=>A.updateLogAtIndex(0,`${t} ${h}`);if(!e.body)return o("no HTTP response body");const u=e.body.getReader();if(!u)return o("invalid HTTP response");const l=e.headers.get("content-length")??a;if(!l)return o("cannot estimate download size");const c=parseInt(l);if(!l)return o("cannot estimate download size");const f=new Uint8Array(c);let d=0;for(;;){const h=await u.read();if(h.done)break;const _=h.value;f.set(_,d),d+=_.length;const v=(Math.round(1e3*d/c)/10).toFixed(1);i(v)}i("done"),n(f)};function Qo(e,t,n){ee.saveConfig();const r=(u,l)=>{const c={},f=Le(O.config);u&&(c.hash=u),e&&(c.jx_session_id=e),t&&(c.jx_character_id=t),n&&(c.jx_display_name=n),f.rs_launch_command&&f.rs_launch_command.length>0&&(c.launch_command=f.rs_launch_command),f.rs_plugin_loader&&(c.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?c.config_uri=f.rs_config_uri:c.config_uri=k.env.default_config_uri,fetch("/launch-rs3-deb?".concat(new URLSearchParams(c).toString()),er(l)).then(d=>{d.text().then(h=>A.info(`game launch status: '${h.trim()}'`)),d.ok&&(u&&(k.rs3debInstalledHash=u),f.close_after_launch&&!f.rs_plugin_loader&&fetch("/close"))})},a=()=>{k.rs3debInstalledHash&&r()},o=k.env.content_url,i=o.concat("dists/trusty/non-free/binary-amd64/Packages");pt(i,Ue,u=>u.text().then(l=>{const c=Object.fromEntries(l.split(`
`).map(f=>f.split(": ")));if(!c.Filename||!c.Size||!c.SHA256){A.error(`could not parse package data from URL: ${i}`),a();return}if(c.SHA256===k.rs3debInstalledHash){A.info("game client is up-to-date"),r();return}pt(o.concat(c.Filename),Ue,f=>Vr(f,"downloading RS3 client...",d=>r(c.SHA256,d),r,c.Size),a)}),a)}function ta(e,t,n,r){ee.saveConfig();const a=r?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",o=Le(O.config),i=(l,c,f)=>{const d={};l&&(d.id=l),f&&(d.jar_path=f),e&&(d.jx_session_id=e),t&&(d.jx_character_id=t),n&&(d.jx_display_name=n),o.runelite_launch_command&&o.runelite_launch_command!==""&&(d.launch_command=o.runelite_launch_command),o.flatpak_rich_presence&&(d.flatpak_rich_presence=""),fetch(a.concat(new URLSearchParams(d).toString()),er(c)).then(h=>{h.text().then(_=>A.info(`game launch status: '${_.trim()}'`)),h.ok&&(l&&(k.runeLiteInstalledId=l),o.close_after_launch&&!r&&fetch("/close"))})},u=()=>{k.runeLiteInstalledId&&i()};if(o.runelite_use_custom_jar){i(null,null,o.runelite_custom_jar);return}if(k.runeLiteInstalledId!==null&&gr!==null&&gr+Yo>Date.now()){i();return}pt(Zo,Ue,l=>l.json().then(c=>{gr=Date.now();const f=c.map(d=>d.assets).flat().find(d=>d.name.toLowerCase()=="runelite.jar");if(!f){A.info("note: no runelite releases found, so skipping update check"),u();return}if(f.id==k.runeLiteInstalledId){A.info("game is up-to-date"),i();return}pt(f.browser_download_url,Ue,d=>Vr(d,"downloading RuneLite launcher...",h=>i(f.id,h),u,f.size),u)}),u)}function ei(e,t,n){ee.saveConfig();const r=Le(O.config),a=(i,u)=>{const l={};i&&(l.version=i),e&&(l.jx_session_id=e),t&&(l.jx_character_id=t),n&&(l.jx_display_name=n),r.hdos_launch_command&&r.hdos_launch_command.length>0&&(l.launch_command=r.hdos_launch_command),fetch("/launch-hdos-jar?".concat(new URLSearchParams(l).toString()),er(u)).then(c=>{c.text().then(f=>A.info(`game launch status: '${f.trim()}'`)),c.ok&&(i&&(k.hdosInstalledVersion=i),r.close_after_launch&&fetch("/close"))})},o=()=>{k.hdosInstalledVersion&&a()};pt(Ko,Ue,i=>i.text().then(u=>{const l=u.match(/^launcher\.version *= *(.*?)$/m);if(!l||l.length<2){A.error("couldn't parse latest launcher version"),o();return}const c=l[1];if(c===k.hdosInstalledVersion){A.info("game is up-to-date"),a();return}pt(`https://cdn.hdos.dev/launcher/v${c}/hdos-launcher.jar`,Ue,f=>Vr(f,"downloading HDOS launcher...",d=>a(c,d),o),o)}),o)}function mr(){fetch("/list-game-clients",Ue).then(e=>{e.ok||e.text().then(t=>A.error(`failed to get client list: ${e.status}: ${t}`))})}function fs(e,t,n,r,a){ee.saveConfig();const o=`${t?"osrs":k.env.provider}-${e?"win":"mac"}`,i=t?"osrs":"rs3",u=e?"exe":"app",l=`${i}${u}InstalledHash`,c=(d,h)=>{const _={},v=Le(O.config),g=t?v.osrs_launch_command:v.rs_launch_command;d&&(_.hash=d),n&&(_.jx_session_id=n),r&&(_.jx_character_id=r),a&&(_.jx_display_name=a),g&&g!==""&&(_.launch_command=g),t||(v.rs_plugin_loader&&(_.plugin_loader="1"),_.config_uri=v.use_custom_rs_config_uri&&v.rs_config_uri?v.rs_config_uri:k.env.default_config_uri);const b=x=>fetch(`/launch-${i}-${u}?${new URLSearchParams(_).toString()}`,x).then(y=>{y.text().then(U=>A.info(`game launch status: '${U.trim()}'`)),y.ok&&(d&&(k[l]=d),v.close_after_launch&&(t||!v.rs_plugin_loader)&&fetch("/close"))});h?h.then(x=>b(er(x))):b(Ue)},f=()=>{k.hdosInstalledVersion&&c()};pt(`${k.env.direct6_url}${o}/${o}.json`,Ue,d=>d.text().then(h=>{const _=JSON.parse(atob(h.split(".")[1])).environments.production;if(k[l]===_.id){A.info("game client is up-to-date"),c();return}A.info(`downloading client version ${_.version}...`),pt(`${k.env.direct6_url}${o}/catalog/${_.id}/catalog.json`,Ue,v=>v.text().then(g=>{const b=JSON.parse(atob(g.split(".")[1])),x=y=>y.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:");pt(x(b.metafile),Ue,y=>y.text().then(U=>{const M=JSON.parse(atob(U.split(".")[1])),j=M.pieces.digests.map(H=>{const F=atob(H).split("").map(te=>te.charCodeAt(0).toString(16).padStart(2,"0")).join(""),ue=x(b.config.remote.baseUrl).concat(b.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",F.substring(0,2)).replace("{TargetDigest}",F));return fetch(ue,Ue).then(te=>te.blob().then(D=>{const oe=new DecompressionStream("gzip");return new Response(D.slice(6).stream().pipeThrough(oe)).blob()}))});let $=0,C=null;for(let H=0;H<M.files.length;H+=1)if(e?M.files[H].name.endsWith(".exe"):M.files[H].name.includes(".app/Contents/MacOS/"))if(C!==null){A.error(`can't parse ${y.url}: file list has multiple possibilities for main exe`),f();return}else C=M.files[H].size;else C===null&&($+=M.files[H].size);if(C===null){A.error(`can't parse ${y.url}: file list has no possibilities for main exe`),f();return}Promise.all(j).then(H=>{const F=new Blob(H).slice($,$+C);c(M.id,F.arrayBuffer())})}),f)}),f)}),f)}var ti=(e,t)=>{p(t).close()},ni=(e,t,n,r,a)=>{p(t)(p(n),p(r)),p(a).close()},ri=L('<div><h2 class="text-3xl font-extrabold">Game is offline</h2> <br/> <p>This game appears to be offline for maintenance or an update. Launch anyway?</p> <div class="align-bottom"><button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">No</button> <button class="mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75">Yes</button></div></div>');function si(e,t){ye(t,!1);let n=Be(),r=Be(),a=Be(),o=Be();function i(l,c,f){R(o,l),R(r,c),R(a,f),p(n).open()}var u={open:i};return gt(Qn(e,{class:"h-fit w-3/5 px-5 py-3 text-center",children:(l,c)=>{var f=ri(),d=w(P(f),6),h=P(d);h.__click=[ti,n];var _=w(h,2);_.__click=[ni,o,r,a,n],S(l,f)},$$slots:{default:!0},$$legacy:!0}),l=>R(n,l),()=>p(n)),Ks(t,"open",i),ke(u)}nt(["click"]);const ai=()=>fetch("/open-external-url",{method:"POST",body:"https://bolt.adamcake.com/plugins"});var oi=(e,t)=>R(t,!1),ii=L("<p>(start an RS3 game client with plugins enabled and it will be listed here.)</p>"),li=(e,t,n,r,a,o,i)=>{R(t,p(n).uid,!0),R(r,!0),R(a,!1),R(o,""),R(i,null)},ui=L("<button> </button> <br/>",1),ci=(e,t)=>R(t,null),fi=L('<option class="dark:bg-slate-900"> </option>'),di=(e,t,n)=>{R(t,!p(t)),R(n,"")},_i=(e,t,n,r)=>{t(p(n)),R(r,!1),R(n,"")},vi=(e,t,n)=>{R(t,!1),R(n,"")},pi=L('<label for="plugin-updater-url-input">URL:</label> <textarea rows="1" id="plugin-updater-url-input" class="w-[50%] max-w-[60%] resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800"></textarea> <button title="Confirm" class="select-none rounded-sm bg-emerald-500 hover:opacity-75"><img src="svgs/check-solid.svg" class="h-5 w-5" alt="Confirm"/></button> <button title="Close URL entry" class="select-none rounded-sm bg-rose-500 hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/></button> <br/><br/>',1),hi=L('<br/> <span class="pb-4 text-xl font-bold italic text-slate-600"> </span>',1),gi=L('<p class="pb-4 text-xl font-bold"> <!></p> <p> </p> <br/>',1),mi=L("<p>error</p> <br/>",1),bi=L("<p>loading...</p>"),wi=(e,t)=>fetch("/browse-plugin-config?".concat(new URLSearchParams({id:K(t)}).toString())),yi=(e,t,n,r)=>t(p(n),K(r)),ki=L('<button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Check updates</button> &nbsp;',1),xi=L('<!> <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse data</button> &nbsp; <button class="mx-auto mb-1 w-[min(144px,_25%)] select-none rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Browse config</button> <br/> <!> <button class="m-1 mx-auto w-[min(144px,_25%)] select-none rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500">Remove</button>',1),Si=L(`<p>You have no plugins installed. You can install plugins either from an updater URL, or by
						downloading them onto your computer and selecting the "bolt.json" file.</p>`),$i=L('<span class="align-middle"><button class="mx-1 aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from updater URL"><img src="svgs/download-solid.svg" alt="Install plugin from updater URL"/></button> <button class="aspect-square w-9 select-none rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500" title="Install plugin from local directory"><img src="svgs/folder-solid.svg" alt="Install plugin from local directory"/></button></span> <br/> <!> <!>',1),Ci=(e,t,n,r,a,o,i)=>t(K(n),K(r),p(a)??null,p(o).main??i),Ei=L('<button class="mx-auto mb-1 w-auto select-none rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"> </button>'),Li=L("<p>(no plugins installed)</p>"),Pi=L("<p>can't start plugin: does not appear to be configured</p>"),Ri=(e,t,n,r)=>{t(K(n),p(r).uid)},Ii=L('<p> <button class="select-none rounded-sm bg-rose-500 shadow-lg hover:opacity-75"><img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/></button></p>'),Ti=L("<p> </p>"),Oi=L('<!> <br/> <br/> <hr class="p-1 dark:border-slate-700"/> <!>',1),Ai=L("<p>error</p>"),Ui=L("<p>loading...</p>"),Ni=L("<br/> <!>",1),Hi=L('<select class="mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select> <!>',1),Mi=L("<p>error</p>"),Di=L('<p class="text-red-500"> </p>'),ji=L("<p> </p>"),Fi=L("<br/><br/> <!>",1),qi=L('<div class="left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"><button>Manage Plugins</button> <hr class="p-1 dark:border-slate-700"/> <!></div> <div class="h-full pt-10"><!> <!></div> <div class="absolute bottom-2 right-4"><button class="m-0 cursor-pointer select-none border-none bg-transparent p-0 text-sm text-gray-500 underline">about plugins</button></div>',1);function Bi(e,t){ye(t,!0);const n=()=>he(Pr,"$clientList",r),[r,a]=ze();let o,i=se(null),u=se(!1);const l=k.platform==="windows"?"\\":"/",c="bolt.json",f=l.concat(c),d="main.lua";function h(){R(Ce,!1),o.open()}const _=m=>{console.log(m),R(i,m,!0),R(u,!1)},v=m=>{console.error(m),R(i,m,!0),R(u,!0)},g=m=>new Promise((E,N)=>{const W=m.concat(m.endsWith(l)?c:f);var T=new XMLHttpRequest;T.onreadystatechange=()=>{T.readyState==4&&(T.status==200?E(JSON.parse(T.responseText)):N(T.responseText))},T.open("GET","/read-json-file?".concat(new URLSearchParams({path:W}).toString()),!0),T.send()}),b=m=>fetch("/get-plugindir-json?".concat(new URLSearchParams({id:m}).toString())).then(E=>E.ok?E.json():null),x=m=>{const N=k.pluginConfig[m];if(!N)return null;const W=N.path;return W?g(W):b(m)},y=()=>{const m=Object.keys(k.pluginConfig);let E;do E=crypto.randomUUID();while(m.includes(E));return E},U="(unnamed)",M="(new character)",j=(m,E)=>{g(m).then(N=>{R(D,y(),!0),k.pluginConfig[K(D)]={name:N.name??U,path:m,version:N.version},O.pluginConfigHasPendingChanges=!0}).catch(N=>v(`config file '${E}' couldn't be fetched, reason: ${N}`))},$=m=>{_("downloading..."),fetch(m).then(async E=>{if(!E.ok){v(`can't install plugin: updater URL returned ${E.status}: ${E.statusText}`);return}const N=await E.json();if(N.url){const W=await fetch(N.url);if(!W.ok){v(`can't install plugin: remote download URL returned ${E.status}: ${E.statusText}`);return}const T=await W.arrayBuffer();if(N.sha256){const Je=await crypto.subtle.digest("SHA-256",T),Bt=Array.from(new Uint8Array(Je)).map(_n=>_n.toString(16).padStart(2,"0")).join("");if(N.sha256!==Bt){v("can't install plugin: incorrect file hash");return}}const J=y();if(!(await fetch("/install-plugin?".concat(new URLSearchParams({id:J}).toString()),{method:"POST",body:T})).ok){v(`can't install plugin: ${E.statusText}`);return}const _e=await b(J);_e?(R(D,J,!0),k.pluginConfig[K(D)]={name:_e.name??U,version:_e.version,updaterURL:m,sha256:N.sha256},O.pluginConfigHasPendingChanges=!0,_(`plugin '${_e.name}' installed`)):v(`can't install plugin: ${c} not found`)}}).catch(()=>{v("can't install plugin: unhandled exception")})};let C=se(!1);const H=()=>{R(C,!0);var m=new XMLHttpRequest;m.onreadystatechange=()=>{if(m.readyState==4&&(R(C,!1),m.status==200))if(m.responseText.endsWith(f)){const E=m.responseText.substring(0,m.responseText.length-c.length);j(E,m.responseText)}else v(`selection '${m.responseText}' is not named ${c}; ignored`)},m.open("GET","/json-file-picker",!0),m.send()};mr();const F=(m,E,N,W)=>{let T=null;if(N){const Y=k.platform==="windows"?N.replaceAll("\\","/"):N;T=Y.endsWith(l)?Y:Y.concat("/")}var J=new XMLHttpRequest;J.onreadystatechange=()=>{J.readyState==4&&(mr(),A.info(`Start-plugin status: ${J.statusText.trim()}`))},T?J.open("GET","/start-plugin?".concat(new URLSearchParams({client:m.toString(),id:E,main:W,path:T}).toString()),!0):J.open("GET","/start-plugin?".concat(new URLSearchParams({client:m.toString(),id:E,main:W}).toString()),!0),J.send()},ue=(m,E)=>{var N=new XMLHttpRequest;N.onreadystatechange=()=>{N.readyState==4&&(mr(),A.info(`Stop-plugin status: ${N.statusText.trim()}`))},N.open("GET","/stop-plugin?".concat(new URLSearchParams({client:m.toString(),uid:E.toString()}).toString()),!0),N.send()},te=(m,E)=>{const N=m.updaterURL;fetch(N).then(async W=>{if(!W.ok){v(`can't update plugin: updater URL returned ${W.status}: ${W.statusText}`);return}let T=await W.json();if(!T.url){_(`can't update plugin '${m.name}': no remote download URL is configured`);return}let J=!1;if(T.sha256?m.sha256!==T.sha256&&(J=!0):T.version&&m.version!==T.version&&(J=!0),J){const Y=await fetch(T.url);if(!Y.ok){v(`can't update plugin: remote download URL returned ${Y.status}: ${Y.statusText}`);return}const _e=await Y.arrayBuffer();if(T.sha256){const Bt=await crypto.subtle.digest("SHA-256",_e),_n=Array.from(new Uint8Array(Bt)).map(nr=>nr.toString(16).padStart(2,"0")).join("");if(T.sha256!==_n){v(`can't update plugin '${m.name}': incorrect file hash`);return}}fetch("/install-plugin?".concat(new URLSearchParams({id:E}).toString()),{method:"POST",body:_e});const Je=await b(E);Je?(T.sha256&&(m.sha256=T.sha256),Je.name&&(m.name=Je.name),Je.version&&(m.version=Je.version),O.pluginConfigHasPendingChanges=!0,_(`plugin '${Je.name}' updated`)):v(`can't update plugin '${m.name}': ${c} not found`)}else _(`plugin '${m.name}' is already up-to-date`)})};var D=se(""),oe=se(!1),Me=se(0);let Ce=se(!1),ce=se("");an(()=>{n().some(m=>m.uid===K(Me))||R(oe,!1)});let ge=qe(()=>k.pluginConfig[K(D)]),rt=qe(()=>x(K(D)));an(()=>{p(rt)&&p(rt).then(m=>{let E=!1;m.name!==p(ge).name&&(p(ge).name=m.name,E=!0),m.version!==p(ge).version&&(p(ge).version=m.version,E=!0),E&&(R(ge,p(ge)),O.pluginConfigHasPendingChanges=!0)})});let Cn=qe(()=>p(ge)?p(ge).path:null);var tr={open:h};gt(Qn(e,{class:"h-[90%] w-[90%] text-center",onClose:()=>ee.savePluginConfig(!0),children:(m,E)=>{var N=qi(),W=G(N),T=P(W);T.__click=[oi,oe];var J=w(T,4);{var Y=ve=>{var De=ii();S(ve,De)},_e=ve=>{var De=ot(),bt=G(De);$t(bt,1,n,Ut,(vn,It)=>{var Xe=ui(),ne=G(Xe);ne.__click=[li,Me,It,oe,Ce,ce,i];var Te=P(ne);V(()=>{Ie(ne,1,`m-1 h-[28px] w-[95%] select-none rounded-lg border-2 ${K(oe)&&K(Me)===p(It).uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white"} hover:opacity-75`),me(Te,p(It).identity||M)}),S(vn,Xe)}),S(ve,De)};X(J,ve=>{n().length==0?ve(Y):ve(_e,!1)})}var Je=w(W,2),Bt=P(Je);{var _n=ve=>{var De=Hi(),bt=G(De);bt.__change=[ci,i],$t(bt,21,()=>Object.entries(k.pluginConfig),Ut,(ne,Te)=>{var Tt=qe(()=>ga(p(Te),2));let je=()=>p(Tt)[0],Oe=()=>p(Tt)[1];var st=fi(),Wt=P(st),Gt={};V(()=>{me(Wt,Oe().name??U),Gt!==(Gt=je())&&(st.value=(st.__value=je())??"")}),S(ne,st)});var vn=w(bt,2);{var It=ne=>{var Te=$i(),Tt=G(Te),je=P(Tt);je.__click=[di,Ce,ce];var Oe=w(je,2);Oe.__click=H;var st=w(Tt,4);{var Wt=ie=>{var pe=pi(),Ye=w(G(pe),2),wt=w(Ye,2);wt.__click=[_i,$,ce,Ce];var ut=w(wt,2);ut.__click=[vi,Ce,ce],Nt(Ye,()=>p(ce),xe=>R(ce,xe)),S(ie,pe)};X(st,ie=>{p(Ce)&&ie(Wt)})}var Gt=w(st,2);{var rr=ie=>{var pe=ot(),Ye=G(pe);{var wt=ut=>{var xe=xi(),ct=G(xe);os(ct,()=>p(rt),fe=>{var de=bi();S(fe,de)},(fe,de)=>{var Ze=gi(),kt=G(Ze),Ot=P(kt),or=w(Ot);{var oa=ir=>{var Jr=hi(),la=w(G(Jr),2),ua=P(la);V(()=>me(ua,`v${p(de).version??""}`)),S(ir,Jr)};X(or,ir=>{p(de).version&&ir(oa)})}var zr=w(kt,2),ia=P(zr);V(()=>{me(Ot,`${p(de).name??U??""} `),Ie(zr,1,An(p(de).description?null:"italic")),me(ia,p(de).description??"no description")}),S(fe,Ze)},fe=>{var de=mi();S(fe,de)});var En=w(ct,2);En.__click=()=>{const fe=k.pluginConfig[K(D)].path;fetch(fe?"/browse-directory?".concat(new URLSearchParams({path:fe}).toString()):"/browse-plugin-data?".concat(new URLSearchParams({id:K(D)}).toString()))};var Ln=w(En,2);Ln.__click=[wi,D];var yt=w(Ln,4);{var Pn=fe=>{var de=ki(),Ze=G(de);Ze.__click=[yi,te,ge,D],S(fe,de)};X(yt,fe=>{p(ge).updaterURL&&fe(Pn)})}var ar=w(yt,2);ar.__click=()=>{R(rt,null),O.pluginConfigHasPendingChanges=!0;let fe=k.pluginConfig;const de=fe[K(D)];de&&(fetch("/uninstall-plugin?".concat(new URLSearchParams({id:K(D),delete_data_dir:typeof de.path=="string"?"0":"1"}).toString())),_(`plugin '${de.name}' uninstalled`),delete fe[K(D)],k.pluginConfig=fe)},S(ut,xe)};X(Ye,ut=>{Object.keys(k.pluginConfig).includes(K(D))&&p(rt)!==null&&ut(wt)})}S(ie,pe)},sr=ie=>{var pe=Si();S(ie,pe)};X(Gt,ie=>{Object.entries(k.pluginConfig).length!==0?ie(rr):ie(sr,!1)})}V(()=>{je.disabled=!k.hasLibArchive||p(C),Oe.disabled=p(C)}),S(ne,Te)},Xe=ne=>{var Te=Ni(),Tt=w(G(Te),2);os(Tt,()=>p(rt),je=>{var Oe=Ui();S(je,Oe)},(je,Oe)=>{var st=Oi(),Wt=G(st);{var Gt=ie=>{var pe=Ei();pe.__click=[Ci,F,Me,D,Cn,Oe,d];var Ye=P(pe);V(()=>me(Ye,`Start ${p(Oe).name??""}`)),S(ie,pe)},rr=ie=>{var pe=ot(),Ye=G(pe);{var wt=xe=>{var ct=Li();S(xe,ct)},ut=xe=>{var ct=Pi();S(xe,ct)};X(Ye,xe=>{Object.entries(k.pluginConfig).length===0?xe(wt):xe(ut,!1)},!0)}S(ie,pe)};X(Wt,ie=>{p(Oe)&&p(Oe).main&&Object.keys(k.pluginConfig).includes(K(D))?ie(Gt):ie(rr,!1)})}var sr=w(Wt,8);$t(sr,1,n,Ut,(ie,pe)=>{var Ye=ot(),wt=G(Ye);{var ut=xe=>{var ct=ot(),En=G(ct);$t(En,17,()=>p(pe).plugins,Ut,(Ln,yt)=>{var Pn=ot(),ar=G(Pn);{var fe=Ze=>{var kt=Ii(),Ot=P(kt),or=w(Ot);or.__click=[Ri,ue,Me,yt],V(()=>me(Ot,`${k.pluginConfig[p(yt).id].name??p(yt).id??""} `)),S(Ze,kt)},de=Ze=>{var kt=Ti(),Ot=P(kt);V(()=>me(Ot,p(yt).id)),S(Ze,kt)};X(ar,Ze=>{Object.keys(k.pluginConfig).includes(p(yt).id)?Ze(fe):Ze(de,!1)})}S(Ln,Pn)}),S(xe,ct)};X(wt,xe=>{p(pe).uid===K(Me)&&xe(ut)})}S(ie,Ye)}),S(je,st)},je=>{var Oe=Ai();S(je,Oe)}),S(ne,Te)};X(vn,ne=>{K(oe)?ne(Xe,!1):ne(It)})}Wr(bt,()=>K(D),ne=>R(D,ne)),S(ve,De)},nr=ve=>{var De=Mi();S(ve,De)};X(Bt,ve=>{k.hasBoltPlugins?ve(_n):ve(nr,!1)})}var na=w(Bt,2);{var ra=ve=>{var De=Fi(),bt=w(G(De),3);{var vn=Xe=>{var ne=Di(),Te=P(ne);V(()=>me(Te,`[error] ${p(i)??""}`)),S(Xe,ne)},It=Xe=>{var ne=ji(),Te=P(ne);V(()=>me(Te,`[info] ${p(i)??""}`)),S(Xe,ne)};X(bt,Xe=>{p(u)?Xe(vn):Xe(It,!1)})}S(ve,De)};X(na,ve=>{p(i)&&ve(ra)})}var sa=w(Je,2),aa=P(sa);aa.__click=[ai],V(()=>Ie(T,1,`mx-auto mb-2 w-[95%] select-none rounded-lg border-2 ${K(oe)?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black"} p-2 font-bold hover:opacity-75`)),S(m,N)},$$slots:{default:!0}}),m=>o=m,()=>o);var z=ke(tr);return a(),z}nt(["click","change"]);var Wi=L('<div class="absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black"> </div>'),Gi=L('<option class="dark:bg-slate-900"> </option>'),Vi=L('<label class="flex flex-col"><span class="text-sm">Game Client</span> <select id="game_client_select" class="w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"></select></label>'),zi=L('<button class="w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500">Plugin menu</button>'),Ji=L('<option class="dark:bg-slate-900"><!></option>'),Xi=L('<option class="dark:bg-slate-900" disabled selected>No characters</option>'),Yi=L('<!> <!> <div class="bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800"><!> <div class="flex flex-col items-center gap-4"><img src="svgs/rocket-solid.svg" alt="Launch icon" class="mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"/> <button class="w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500">Play</button> <!> <label class="flex flex-col"><span class="text-sm">Character</span> <select id="character_select" class="mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"><option disabled class="dark:bg-slate-900">Select an account</option><!></select></label></div></div>',1);function Zi(e,t){ye(t,!0);const n=()=>he(f,"$config",i),r=()=>he(g,"$psa",i),a=()=>he(b,"$gameEnabled",i),o=()=>he(d,"$initialized",i),[i,u]=ze();let l,c,{config:f,initialized:d}=O,h=qe(()=>n().selected.user_id),_=qe(()=>n().userDetails[p(h)??""]?.account_id),v=qe(()=>ee.findSession(n().selected.user_id)?.accounts??[]),g=Dt(null),b=Dt(!0);an(()=>{if(n().check_announcements){const z=n().selected.game==Ee.osrs?"osrs":k.env.provider,m=`${k.env.psa_url}${z}/${z}.json`;fetch(m,{method:"GET",cache:"no-store"}).then(E=>E.json()).then(E=>{In(g,E.psaEnabled&&E.psaMessage?E.psaMessage:null),In(b,!(E.playDisabled??!1))})}else In(g,null),In(b,!0)});function x(z,m){if(!p(h))return A.warn("Please log in or select a user to play.");if(!p(_))return A.warn("Please select a character from the select menu.");const E=ee.findSession(n().selected.user_id);if(!E)return A.warn("Unable to launch game, session was not found.");const{session_id:N}=E,W=ee.findAccount(E.accounts,p(_));if(!W)return A.warn("Unable to launch game, account was not found.");const{accountId:T,displayName:J}=W,Y=k.platform===wr.Windows,_e=k.platform===wr.Linux;switch(z){case Ee.osrs:switch(m){case Yt.official:fs(Y||_e,!0,N,T,J);break;case Yt.runelite:ta(N,T,J,!1);break;case Yt.hdos:ei(N,T,J);break}break;case Ee.rs3:_e?Qo(N,T,J):fs(Y,!1,N,T,J);break}}function y(z){const m=z.target.value;if(!p(h))return;const E=n().userDetails[p(h)];E?(E.account_id=m,ae(f,I(n).userDetails[p(h)]=E,I(n))):ae(f,I(n).userDetails[p(h)]={account_id:m},I(n))}var U={launch:x},M=Yi(),j=G(M);gt(si(j,{}),z=>l=z,()=>l);var $=w(j,2);gt(Bi($,{}),z=>c=z,()=>c);var C=w($,2),H=P(C);{var F=z=>{var m=Wi(),E=P(m);V(()=>me(E,r())),S(z,m)};X(H,z=>{r()&&z(F)})}var ue=w(H,2),te=w(P(ue),2);te.__click=()=>{a()?x(n().selected.game,n().selected.client):l.open(x,n().selected.game,n().selected.client)};var D=w(te,2);{var oe=z=>{var m=Vi(),E=w(P(m),2);$t(E,5,()=>ca[n().selected.game],Ut,(N,W)=>{var T=Gi(),J=P(T),Y={};V(()=>{me(J,p(W)),Y!==(Y=p(W))&&(T.value=(T.__value=p(W))??"")}),S(N,T)}),Wr(E,()=>n().selected.client,N=>ae(f,I(n).selected.client=N,I(n))),S(z,m)},Me=z=>{var m=ot(),E=G(m);{var N=W=>{var T=zi();T.__click=()=>{c.open()},V(()=>{T.disabled=!k.hasBoltPlugins,vt(T,"title",k.hasBoltPlugins?null:"This feature is disabled")}),S(W,T)};X(E,W=>{n().selected.game===Ee.rs3&&W(N)},!0)}S(z,m)};X(D,z=>{n().selected.game==Ee.osrs?z(oe):z(Me,!1)})}var Ce=w(D,2),ce=w(P(Ce),2);ce.__change=y;var ge=P(ce);ge.value=(ge.__value=void 0)??"";var rt=w(ge);$t(rt,17,()=>p(v),Ut,(z,m)=>{var E=Ji(),N=P(E);{var W=Y=>{var _e=ss();V(()=>me(_e,p(m).displayName)),S(Y,_e)},T=Y=>{var _e=ss("New Character");S(Y,_e)};X(N,Y=>{p(m).displayName?Y(W):Y(T,!1)})}var J={};V(()=>{J!==(J=p(m).accountId)&&(E.value=(E.__value=p(m).accountId)??"")}),S(z,E)},z=>{var m=Xi();S(z,m)});var Cn;Zs(ce),V(()=>{te.disabled=!o(),ce.disabled=!o()||n().selected.user_id===null,Cn!==(Cn=p(_))&&(ce.value=(ce.__value=p(_))??"",Br(ce,p(_)))}),S(e,M);var tr=ke(U);return u(),tr}nt(["click","change"]);var Ki=L("<li> </li>"),Qi=L('<div class="fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900"><div class="absolute right-6 top-2"><img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/></div> <ol id="message_list" class="h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"></ol></div>');function el(e,t){ye(t,!0);var n=Qi(),r=w(P(n),2);$t(r,21,()=>t.logs,Ut,(a,o)=>{let i=()=>p(o).date,u=()=>p(o).severity,l=()=>p(o).content;var c=Ki();let f;var d=P(c);V((h,_)=>{f=Ie(c,1,"",null,f,h),me(d,`${_??""}
				- ${l()??""}`)},[()=>({"text-rose-500":u()===Lr.error,"text-orange-700":u()===Lr.warn}),()=>i()?.toLocaleTimeString()]),S(a,c)}),S(e,n),ke()}var tl=L('<option class="dark:bg-slate-900"> </option>'),nl=()=>{const{origin:e,redirect:t,clientid:n}=k.env;Pe.openLoginWindow(e,t,n)},rl=async(e,t,n)=>{t().selected.user_id&&(await ee.logout(t().selected.user_id),ee.saveCredentials())},sl=L('<select class="w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"><option disabled class="dark:bg-slate-900">Select a user</option><!></select> <div class="mt-5 flex"><button class="mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75">Log In</button> <button class="mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75">Log Out</button></div>',1);function al(e,t){ye(t,!1);const n=()=>he(u,"$config",a),r=()=>he(i,"$sessions",a),[a,o]=ze(),{sessions:i,config:u}=O;Rt();var l=sl(),c=G(l);V(()=>{n(),ro(()=>{r()})});var f=P(c);f.value=(f.__value=null)??"";var d=w(f);$t(d,1,r,g=>g.user.userId,(g,b)=>{var x=tl(),y=P(x),U={};V(()=>{me(y,p(b).user.displayName),U!==(U=p(b).user.userId)&&(x.value=(x.__value=p(b).user.userId)??"")}),S(g,x)});var h=w(c,2),_=P(h);_.__click=[nl];var v=w(_,2);v.__click=[rl,n,u],V(()=>v.disabled=!n().selected.user_id),Wr(c,()=>n().selected.user_id,g=>ae(u,I(n).selected.user_id=g,I(n))),S(e,l),ke(),o()}nt(["click"]);function ol(e,{callback:t,ignore:n=[]}){const r=a=>{const o=n.some(i=>i.contains(a.target));e&&!e.contains(a.target)&&!a.defaultPrevented&&!o&&t()};return document.addEventListener("click",r,!0),document.addEventListener("contextmenu",r,!0),{destroy(){document.removeEventListener("click",r,!0),document.removeEventListener("contextmenu",r,!0)}}}function il(e,t,n,r){p(t)?n():r()}var ll=L("<div><!></div>"),ul=L("<div><button><!></button> <!></div>");function cl(e,t){ye(t,!0);const n=()=>he(o,"$config",r),[r,a]=ze(),{config:o}=O;let i=qe(()=>n().use_dark_theme),u=nn(t,"class",3,""),l=nn(t,"position",3,"bottom"),c=nn(t,"align",3,"start"),f=se(!1),d=se(void 0);function h(){R(f,!0)}function _(){R(f,!1)}var v={open:h,close:_},g=ul();let b;var x=P(g);x.__click=[il,f,_,h];var y=P(x);Bn(y,()=>t.children??et),gt(x,$=>R(d,$),()=>p(d));var U=w(x,2);{var M=$=>{var C=ll(),H=P(C);Bn(H,()=>t.content??et),Co(C,(F,ue)=>ol?.(F,ue),()=>({callback:_,ignore:[p(d)]})),V(()=>Ie(C,1,`dropdown-color absolute z-20 rounded-lg border-2 ${l()??""} ${c()??""}`,"svelte-11xj3vp")),S($,C)};X(U,$=>{p(f)&&$(M)})}V($=>b=Ie(g,1,`relative h-fit w-fit ${u()??""}`,"svelte-11xj3vp",b,$),[()=>({dark:p(i)})]),S(e,g);var j=ke(v);return a(),j}nt(["click"]);var fl=(e,t)=>{t()},dl=L('<button id="data_dir_button" class="p-2 hover:opacity-75"><div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/> Browse App Data</div></button> <div class="mx-auto p-2"><label for="check_announcements">Check game announcements:</label> <input id="check_announcements" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="close_after_launch">Close Bolt after launching a game:</label> <input id="close_after_launch" type="checkbox" class="ml-2"/></div> <div class="mx-auto p-2"><label for="discard_expired_logins">Discard expired login sessions:</label> <input id="discard_expired_logins" type="checkbox" class="ml-2"/></div>',1);function _l(e,t){ye(t,!1);const n=()=>he(i,"$config",r),[r,a]=ze();function o(){var y=new XMLHttpRequest;y.open("GET","/browse-data"),y.onreadystatechange=()=>{y.readyState==4&&A.info(`Browse status: '${y.responseText.trim()}'`)},y.send()}const{config:i}=O,u="Allow checking for official announcements about game status. These will be displayed above the 'play' button. Disabling will reduce the number of web requests made when opening the launcher.",l="Close the launcher immediately after launching a game",c="Discard login sessions if they're no longer valid, prompting the player to sign-in again. If unchecked, the only way to discard a login will be by manually pressing the 'log out' button, even if your login no longer works.";Rt();var f=dl(),d=G(f);d.__click=[fl,o];var h=w(d,2);vt(h,"title",u);var _=w(P(h),2),v=w(h,2);vt(v,"title",l);var g=w(P(v),2),b=w(v,2);vt(b,"title",c);var x=w(P(b),2);tn(_,()=>n().check_announcements,y=>ae(i,I(n).check_announcements=y,I(n))),tn(g,()=>n().close_after_launch,y=>ae(i,I(n).close_after_launch=y,I(n))),tn(x,()=>n().discard_expired_sessions,y=>ae(i,I(n).discard_expired_sessions=y,I(n))),S(e,f),ke(),a()}nt(["click"]);var vl=(e,t)=>t(),pl=(e,t)=>{t()},hl=L('<button class="p-2 pb-5 hover:opacity-75"><div class="flex"><img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/> Configure RuneLite</div></button> <div class="mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"><label for="use_custom_jar">Use custom RuneLite JAR:</label> <input id="use_custom_jar" type="checkbox" class="ml-2"/></div> <div><textarea class="h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"></textarea> <br/> <button class="mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 enabled:hover:opacity-75">Select File</button></div> <div class="p-2"><label for="osrs_custom_launch_command">OSRS launch command:</label> <br/> <textarea id="osrs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="runelite_custom_launch_command">RuneLite launch command:</label> <br/> <textarea id="runelite_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div> <div class="p-2"><label for="hdos_custom_launch_command">HDOS launch command:</label> <br/> <textarea id="hdos_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function gl(e,t){ye(t,!0);const n=()=>he(o,"$config",r),[r,a]=ze(),{config:o}=O;let i=qe(()=>ee.findSession(n().selected.user_id)),u=qe(()=>ee.findAccount(p(i)?.accounts??[],n().userDetails[n().selected.user_id??""]?.account_id)),l=se(!1);async function c(){R(l,!0),ae(o,I(n).runelite_custom_jar=await ee.openFilePicker(),I(n)),console.log("done picking"),R(l,!1)}function f(){!p(i)?.session_id||!p(u)?.accountId||!p(u)?.displayName||ta(p(i).session_id,p(u).accountId,p(u).displayName,!0)}var d=hl(),h=G(d);h.__click=[vl,f];var _=w(h,2),v=w(P(_),2),g=w(_,2);let b;var x=P(g),y=w(x,4);y.__click=[pl,c];var U=w(g,2),M=w(P(U),4);vt(M,"placeholder","%command%");var j=w(U,2),$=w(P(j),4);vt($,"placeholder","%command%");var C=w(j,2),H=w(P(C),4);vt(H,"placeholder","%command%"),V(F=>{h.disabled=!p(i)?.session_id||!p(u)?.accountId,b=Ie(g,1,"mx-auto p-2",null,b,F),x.disabled=!n().runelite_use_custom_jar,y.disabled=p(l)||!n().runelite_use_custom_jar},[()=>({"opacity-25":!n().runelite_use_custom_jar})]),tn(v,()=>n().runelite_use_custom_jar,F=>ae(o,I(n).runelite_use_custom_jar=F,I(n))),Nt(x,()=>n().runelite_custom_jar,F=>ae(o,I(n).runelite_custom_jar=F,I(n))),Nt(M,()=>n().osrs_launch_command,F=>ae(o,I(n).osrs_launch_command=F,I(n))),Nt($,()=>n().runelite_launch_command,F=>ae(o,I(n).runelite_launch_command=F,I(n))),Nt(H,()=>n().hdos_launch_command,F=>ae(o,I(n).hdos_launch_command=F,I(n))),S(e,d),ke(),a()}nt(["click"]);var ml=L('<div class="mx-auto p-2"><label for="enable_plugins">Enable Bolt plugin loader:</label> <input type="checkbox" name="enable_plugins" id="enable_plugins" class="ml-2"/></div>'),bl=L('<!> <div class="mx-auto p-2"><label for="use_custom_uri">Use custom config URI:</label> <input id="use_custom_uri" type="checkbox" class="ml-2"/></div> <div class="p-2"><textarea class="rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="4"></textarea></div> <div class="p-2"><label for="rs_custom_launch_command">Launch command:</label> <br/> <textarea id="rs_custom_launch_command" class="resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50" rows="1" cols="35"></textarea></div>',1);function wl(e,t){ye(t,!1);const n=()=>he(o,"$config",r),[r,a]=ze(),{config:o}=O;Rt();var i=bl(),u=G(i);{var l=g=>{var b=ml(),x=w(P(b),2);tn(x,()=>n().rs_plugin_loader,y=>ae(o,I(n).rs_plugin_loader=y,I(n))),S(g,b)};X(u,g=>{k.hasBoltPlugins&&g(l)})}var c=w(u,2),f=w(P(c),2),d=w(c,2),h=P(d),_=w(d,2),v=w(P(_),4);vt(v,"placeholder","%command%"),V(()=>{h.disabled=!n().use_custom_rs_config_uri,vt(h,"placeholder",k.env.default_config_uri)}),tn(f,()=>n().use_custom_rs_config_uri,g=>ae(o,I(n).use_custom_rs_config_uri=g,I(n))),Nt(h,()=>n().rs_config_uri,g=>ae(o,I(n).rs_config_uri=g,I(n))),Nt(v,()=>n().rs_launch_command,g=>ae(o,I(n).rs_launch_command=g,I(n))),S(e,i),ke(),a()}var yl=(e,t,n)=>{R(t,n.general)},kl=(e,t,n)=>{R(t,n.osrs)},xl=(e,t,n)=>{R(t,n.rs3)},Sl=L('<div class="grid h-full grid-cols-4"><div class="flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"><button>General</button> <button>OSRS</button> <button>RS3</button></div> <div class="col-span-3 p-5 pt-10 text-center"><!></div></div>');function $l(e,t){ye(t,!1);var n=(c=>(c[c.general=0]="general",c[c.osrs=1]="osrs",c[c.rs3=2]="rs3",c))(n||{});let r=Be(),a=Be(0),o="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",i="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function u(){p(r).open()}var l={open:u};return Rt(),gt(Qn(e,{class:"h-3/4 w-3/4 select-none",children:(c,f)=>{var d=Sl(),h=P(d),_=P(h);_.__click=[yl,a,n];var v=w(_,2);v.__click=[kl,a,n];var g=w(v,2);g.__click=[xl,a,n];var b=w(h,2),x=P(b);{var y=M=>{_l(M,{})},U=M=>{var j=ot(),$=G(j);{var C=F=>{gl(F,{})},H=F=>{var ue=ot(),te=G(ue);{var D=oe=>{wl(oe,{})};X(te,oe=>{p(a)==n.rs3&&oe(D)},!0)}S(F,ue)};X($,F=>{p(a)==n.osrs?F(C):F(H,!1)},!0)}S(M,j)};X(x,M=>{p(a)==n.general?M(y):M(U,!1)})}V(()=>{Ie(_,1,An(p(a)===n.general?o:i)),Ie(v,1,An(p(a)===n.osrs?o:i)),Ie(g,1,An(p(a)===n.rs3?o:i))}),S(c,d)},$$slots:{default:!0},$$legacy:!0}),c=>R(r,c),()=>p(r)),Ks(t,"open",u),ke(l)}nt(["click"]);var Cl=(e,t,n)=>{ae(n,I(t).selected.game=Ee.rs3,I(t))},El=(e,t,n)=>{ae(n,I(t).selected.game=Ee.osrs,I(t))},Ll=(e,t,n)=>ae(n,I(t).use_dark_theme=!t().use_dark_theme,I(t)),Pl=(e,t)=>p(t).open(),Rl=L('<div class="w-40"><!></div>'),Il=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50"> </button>'),Tl=()=>{const{origin:e,redirect:t,clientid:n}=k.env;Pe.openLoginWindow(e,t,n)},Ol=L('<button class="h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50">Login</button>'),Al=L('<!> <div class="fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900"><div class="m-3 ml-9 font-bold"><button>RS3</button> <button>OSRS</button></div> <div class="m-2 ml-auto flex gap-2"><button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/></button> <button class="h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"><img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/></button> <!></div></div>',1);function Ul(e,t){ye(t,!1);const n=()=>he(i,"$config",a),r=()=>he(u,"$sessions",a),[a,o]=ze(),{config:i,sessions:u}=O;let l=Be();Rt();var c=Al(),f=G(c);gt($l(f,{$$legacy:!0}),C=>R(l,C),()=>p(l));var d=w(f,2),h=P(d),_=P(h);let v;_.__click=[Cl,n,i];var g=w(_,2);let b;g.__click=[El,n,i];var x=w(h,2),y=P(x);y.__click=[Ll,n,i];var U=w(y,2);U.__click=[Pl,l];var M=w(U,2);{var j=C=>{const H=Mr(()=>ee.findSession(n().selected.user_id??""));cl(C,{align:"center",content:ue=>{var te=Rl(),D=P(te);al(D,{}),S(ue,te)},children:(ue,te)=>{var D=Il(),oe=P(D);V(()=>me(oe,p(H)?.user.displayName??"No user selected")),S(ue,D)},$$slots:{content:!0,default:!0}})},$=C=>{var H=Ol();H.__click=[Tl],S(C,H)};X(M,C=>{r().length>0?C(j):C($,!1)})}V((C,H)=>{v=Ie(_,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75",null,v,C),b=Ie(g,1,"mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75",null,b,H)},[()=>({"text-black":n().selected.game===Ee.rs3,"bg-blue-500":n().selected.game===Ee.rs3}),()=>({"text-black":n().selected.game===Ee.osrs,"bg-blue-500":n().selected.game===Ee.osrs})]),S(e,c),ke(),o()}nt(["click"]);var Nl=L('<!> <!> <div class="mt-16 grid h-full grid-flow-col grid-cols-3"><div></div> <!> <div></div></div> <!>',1);function Hl(e,t){ye(t,!1);const n=()=>he(o,"$logs",r),[r,a]=ze(),o=A.logs;Rt(),wo("beforeunload",kr,()=>{ee.saveConfig(),k.hasBoltPlugins&&ee.savePluginConfig(!0)}),ea(e,{children:(i,u)=>{var l=Nl(),c=G(l);Jo(c,{});var f=w(c,2);Ul(f,{});var d=w(f,2),h=w(P(d),2);Zi(h,{});var _=w(d,2);el(_,{get logs(){return n()}}),S(i,l)}}),ke(),a()}const ds={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?as(qo,ds):(Ml(),Mo(),Dl(),jl().finally(()=>{O.initialized.set(!0)}),as(Hl,ds));function Ml(){const e=new URLSearchParams(window.location.search);k.platform=e.get("platform"),k.isFlathub=e.get("flathub")==="1",k.hasLibArchive=e.get("has_libarchive")==="1",k.rs3debInstalledHash=e.get("rs3_deb_installed_hash"),k.rs3exeInstalledHash=e.get("rs3_exe_installed_hash"),k.rs3appInstalledHash=e.get("rs3_app_installed_hash"),k.osrsexeInstalledHash=e.get("osrs_exe_installed_hash"),k.osrsappInstalledHash=e.get("osrs_app_installed_hash"),k.runeLiteInstalledId=e.get("runelite_installed_id"),k.hdosInstalledVersion=e.get("hdos_installed_version");const t=e.get("plugins");if(k.hasBoltPlugins=t!==null,t!==null)try{k.pluginConfig=JSON.parse(t)}catch{A.error("Unable to parse plugin list")}const n=e.get("credentials");if(n)try{const r=JSON.parse(n),a=r.every(o=>typeof o.session_id=="string"&&typeof o.tokens=="object"&&typeof o.accounts=="object"&&typeof o.user=="object");a?O.sessions.set(r):(O.sessions.set([]),ee.saveCredentials(),A.warn("Credentials saved on disk are out of date. Please sign in again.")),O.sessions.set(a?r:[])}catch{O.sessions.set([]),ee.saveCredentials(),A.error("Unable to parse saved credentials. Please sign in again.")}}function Dl(){const{origin:e,origin_2fa:t}=k.env,n=[window.location.origin,e,t];let r=null;window.addEventListener("message",async a=>{if(!n.includes(a.origin)){A.info(`discarding window message from origin ${a.origin}`);return}switch(a.data.type){case"authTokenUpdate":{r=a.data.tokens;break}case"authSessionUpdate":{if(r===null)return A.error("auth is null. Please try again.");const o=a.data.sessionId,i=await ee.login(r,o);i.ok?A.info(`Added new user '${i.value.user.displayName}'`):A.error(`Unable to add new user. Please try again. ${i.error}`),ee.saveCredentials(),Pe.pendingLoginWindow=null,r=null;break}case"authFailed":{A.error(`Unable to authenticate: ${a.data.reason}`),Pe.pendingLoginWindow=null,r=null;break}case"externalUrl":{const o=new XMLHttpRequest;o.onreadystatechange=()=>{o.readyState==4&&A.info(`External URL status: '${o.responseText.trim()}'`)},o.open("POST","/open-external-url",!0),o.send(a.data.url);break}case"gameClientList":Le(O.config).close_after_launch&&a.data.clients.length>Le(Pr).length?fetch("/close"):Pr.set(a.data.clients);break;default:{const o=a.data?.type??"no type provided";A.info(`Unknown message type: ${o}`);break}}})}async function jl(){const e=Le(O.config).discard_expired_sessions,t=Le(O.sessions),n=[];t.length>0&&A.info("Logging in...");const r=t.map(i=>({promise:Pe.refreshOAuthToken(i.tokens),session:i})),a=[];for(const i of r){const u=i.session,l=await i.promise;if(!l.ok){l.error===0?A.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):l.error>=400&&l.error<500&&e?(A.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),n.push(u.tokens.sub)):A.error(`Unable to verify saved login due to HTTP error ${l.error}`);continue}const c=l.value;u.tokens=c,a.push({promise:ee.login(c,u.session_id),session:u})}for(const i of a){const u=i.session,l=await i.promise;l.ok?A.info(`Signed into saved user '${l.value.user.displayName}'`):(A.error(`Unable to sign into saved user '${u.user.displayName}' due to an error: ${l.error}`),e&&n.push(u.tokens.sub))}const o=n.map(ee.logout);for(const i of o)await i;O.sessions.set(t),await ee.saveCredentials()}
