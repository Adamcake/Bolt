var _n=Object.defineProperty;var gn=(n,e,t)=>e in n?_n(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Xe=(n,e,t)=>(gn(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();var mt=(n=>(n[n.SECOND=1e3]="SECOND",n[n.MINUTE=6e4]="MINUTE",n[n.HALF_HOUR=18e5]="HALF_HOUR",n[n.HOUR=36e5]="HOUR",n[n.DAY=864e5]="DAY",n[n.WEEK=6048e5]="WEEK",n[n.MONTH=2592e6]="MONTH",n))(mt||{});class De{static set(e,t,l,o){const r=new Date;r.setTime(r.getTime()+l*o);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${i};path=/`}static get(e){const t=`${e}=`,l=document.cookie.split(";");for(let o=0;o<l.length;o++){let r=l[o];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(t)===0)return r.substring(t.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function ye(n){return{ok:!0,value:n}}function V(n){return{ok:!1,error:n}}var te=(n=>(n.rs3="rs3",n.osrs="osrs",n))(te||{}),Pe=(n=>(n.official="Official",n.runelite="RuneLite",n.hdos="HDOS",n))(Pe||{});const $t={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class et{static parseTokenResponse(e){try{const t=JSON.parse(e),l=t.id_token.split(".");if(l.length!==3){const i=`Malformed id_token: ${l.length} sections, expected 3`;return V(i)}const o=JSON.parse(atob(l[0]));if(o.typ!=="JWT"){const i=`Bad id_token header: typ ${o.typ}, expected JWT`;return V(i)}const r=JSON.parse(atob(l[1]));return ye({access_token:t.access_token,id_token:t.id_token,refresh_token:t.refresh_token,sub:r.sub,expiry:Date.now()+t.expires_in*1e3})}catch{return V("Unable to parse token response")}}static parseSessionResponse(e){try{const t=JSON.parse(e);return t.sessionId?ye(t.sessionId):V("sessionId does not exist on parsed object")}catch{return V("Unable to parse session response")}}static decodeBolt(e){const t={};for(const l in e){const o=l,r=e[o];typeof r=="string"?t[o]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?t[o]=r.map(i=>atob(i)):t[o]=r}return t}}var We=(n=>(n.Windows="windows",n.Linux="linux",n.MacOS="mac",n))(We||{});const P={env:et.decodeBolt(s()),platform:null,rs3DebInstalledHash:null,rs3ExeInstalledHash:null,rs3AppInstalledHash:null,osrsExeInstalledHash:null,osrsAppInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasLibArchive:!1,hasBoltPlugins:!1,pluginList:{}};class ft{static async makeLoginUrl(e){const t=new TextEncoder().encode(e.pkceCodeVerifier),l=await crypto.subtle.digest("SHA-256",t);let o="";const r=new Uint8Array(l);for(let a=0;a<r.byteLength;a++)o+=String.fromCharCode(r[a]);const i=btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=new Uint32Array(43);return crypto.getRandomValues(t),Array.from(t,function(l){return e[l%e.length]}).join("")}static makeRandomState(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=t.length-1,o=crypto.getRandomValues(new Uint8Array(12));return Array.from(o).map(r=>Math.round(r*(l-0)/255+0)).map(r=>t[r]).join("")}}const qe=class qe{static async openLoginWindow(e,t,l){if(qe.pendingLoginWindow!==null)return qe.pendingLoginWindow.window.focus();const o=ft.makeRandomState(),r=ft.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let c="";const u=new Uint8Array(a);for(let g=0;g<u.byteLength;g++)c+=String.fromCharCode(u[g]);const d=btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:l,redirect_uri:t,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:o}),_=`${e}/oauth2/auth?${f.toString()}`;De.set("auth_verifier",r,10,mt.MINUTE),qe.pendingLoginWindow=window.open(_,"","width=480,height=720")}static navigateToAuthConsent(e,t,l){const o=ft.makeRandomState(),r=new URLSearchParams({id_token_hint:t,nonce:l,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:o,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;De.set("auth_nonce",l,10,mt.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(t=>{if(e.expiry-Date.now()<3e4){const l=new URLSearchParams({grant_type:"refresh_token",client_id:P.env.clientid,refresh_token:e.refresh_token}),o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=et.parseTokenResponse(o.response);i.ok?t(ye(i.value)):t(V(0))}else t(V(o.status))},o.onerror=()=>{t(V(0))};const r=P.env.origin.concat("/oauth2/token");o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Accept","application/json"),o.send(l)}else t(ye(e))})}static async getOAuthToken(e,t,l,o,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const d=et.parseTokenResponse(c.response);return d.ok?a(ye(d.value)):a(V(d.error))}else return a(V(`Error: from ${i}: ${c.status}: ${c.response}`))},c.open("POST",i,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("Accept","application/json");const u=new URLSearchParams({grant_type:"authorization_code",client_id:t,code:r,code_verifier:l,redirect_uri:o});c.send(u)})}static revokeOauthCreds(e){const t=`${P.env.origin}/oauth2/revoke`;return new Promise(l=>{const o=new XMLHttpRequest;o.open("POST",t,!0),o.onreadystatechange=()=>{o.readyState==4&&l(o.status)},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:P.env.clientid});o.send(r)})}static async getSessionId(e,t){const l=`${e}/sessions`;return new Promise(o=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=et.parseSessionResponse(r.response);return a.ok?o(ye(a.value)):o(V(a.error))}else V(`Error: from ${l}: ${r.status}: ${r.response}`)},r.open("POST",l,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:t};r.send(JSON.stringify(i))})}static validateIdToken(e,t){const l=e.split(".");if(l.length!==3)return V(`Malformed id_token: ${l.length} sections, expected 3`);const o=JSON.parse(atob(l[0]));return o.typ!=="JWT"?V(`Bad id_token header: typ ${o.typ}, expected JWT`):JSON.parse(atob(l[1])).nonce!==t?V("Incorrect nonce in id_token"):ye(void 0)}};Xe(qe,"pendingLoginWindow",null);let ke=qe;class nt{static async buildSession(e,t){const l=await nt.getUser(e.sub,e.access_token);if(!l.ok)return V(`Failed to fetch user. Status: ${l.error}`);const o=await nt.getUserAccounts(t);return o.ok?ye({user:l.value,accounts:o.value,tokens:e,session_id:t}):V(`Failed to fetch game accounts. Status: ${o.error}`)}static getUser(e,t){return new Promise(l=>{const o=`${P.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);l(ye(i))}else l(V(r.status))},r.open("GET",o,!0),r.setRequestHeader("Authorization","Bearer ".concat(t)),r.send()})}static getUserAccounts(e){const t=`${P.env.auth_api}/accounts`;return new Promise(l=>{const o=new XMLHttpRequest;o.onreadystatechange=async()=>{if(o.readyState==4)if(o.status==200){const r=JSON.parse(o.response);l(ye(r))}else l(V(o.status))},o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer ".concat(e)),o.send()})}}function D(){}function hn(n,e){for(const t in e)n[t]=e[t];return n}function mn(n){return!!n&&(typeof n=="object"||typeof n=="function")&&typeof n.then=="function"}function nn(n){return n()}function St(){return Object.create(null)}function ie(n){n.forEach(nn)}function lt(n){return typeof n=="function"}function ae(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ke;function bt(n,e){return n===e?!0:(Ke||(Ke=document.createElement("a")),Ke.href=e,n===Ke.href)}function bn(n){return Object.keys(n).length===0}function sn(n,...e){if(n==null){for(const l of e)l(void 0);return D}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function me(n){let e;return sn(n,t=>e=t)(),e}function pe(n,e,t){n.$$.on_destroy.push(sn(e,t))}function ot(n,e,t,l){if(n){const o=ln(n,e,t,l);return n[0](o)}}function ln(n,e,t,l){return n[1]&&l?hn(t.ctx.slice(),n[1](l(e))):t.ctx}function rt(n,e,t,l){if(n[2]&&l){const o=n[2](l(t));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|o[a];return r}return e.dirty|o}return e.dirty}function it(n,e,t,l,o,r){if(o){const i=ln(e,t,l,r);n.p(i,o)}}function at(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let l=0;l<t;l++)e[l]=-1;return e}return-1}function Se(n,e,t){return n.set(t),e}function kn(n){return n&&lt(n.destroy)?n.destroy:D}function y(n,e){n.appendChild(e)}function k(n,e,t){n.insertBefore(e,t||null)}function b(n){n.parentNode&&n.parentNode.removeChild(n)}function Oe(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function m(n){return document.createElement(n)}function F(n){return document.createTextNode(n)}function R(){return F(" ")}function Le(){return F("")}function N(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function wn(n){return function(e){e.target===this&&n.call(this,e)}}function h(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function yn(n){return Array.from(n.childNodes)}function _e(n,e){e=""+e,n.data!==e&&(n.data=e)}function re(n,e){n.value=e??""}function Ie(n,e,t){for(let l=0;l<n.options.length;l+=1){const o=n.options[l];if(o.__value===e){o.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function yt(n){const e=n.querySelector(":checked");return e&&e.__value}function ne(n,e,t){n.classList.toggle(e,!!t)}function vn(n,e,{bubbles:t=!1,cancelable:l=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:l})}let ze;function Ce(n){ze=n}function ct(){if(!ze)throw new Error("Function called outside component initialization");return ze}function on(n){ct().$$.on_mount.push(n)}function $n(n){ct().$$.on_destroy.push(n)}function Sn(){const n=ct();return(e,t,{cancelable:l=!1}={})=>{const o=n.$$.callbacks[e];if(o){const r=vn(e,t,{cancelable:l});return o.slice().forEach(i=>{i.call(n,r)}),!r.defaultPrevented}return!0}}const Ae=[],ve=[];let Be=[];const Lt=[],Ln=Promise.resolve();let kt=!1;function Cn(){kt||(kt=!0,Ln.then(vt))}function Ge(n){Be.push(n)}const pt=new Set;let xe=0;function vt(){if(xe!==0)return;const n=ze;do{try{for(;xe<Ae.length;){const e=Ae[xe];xe++,Ce(e),Rn(e.$$)}}catch(e){throw Ae.length=0,xe=0,e}for(Ce(null),Ae.length=0,xe=0;ve.length;)ve.pop()();for(let e=0;e<Be.length;e+=1){const t=Be[e];pt.has(t)||(pt.add(t),t())}Be.length=0}while(Ae.length);for(;Lt.length;)Lt.pop()();kt=!1,pt.clear(),Ce(n)}function Rn(n){if(n.fragment!==null){n.update(),ie(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ge)}}function Pn(n){const e=[],t=[];Be.forEach(l=>n.indexOf(l)===-1?e.push(l):t.push(l)),t.forEach(l=>l()),Be=e}const tt=new Set;let He;function Ve(){He={r:0,c:[],p:He}}function Ye(){He.r||ie(He.c),He=He.p}function B(n,e){n&&n.i&&(tt.delete(n),n.i(e))}function G(n,e,t,l){if(n&&n.o){if(tt.has(n))return;tt.add(n),He.c.push(()=>{tt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function st(n,e){const t=e.token={};function l(o,r,i,a){if(e.token!==t)return;e.resolved=a;let c=e.ctx;i!==void 0&&(c=c.slice(),c[i]=a);const u=o&&(e.current=o)(c);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==r&&f&&(Ve(),G(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),Ye())}):e.block.d(1),u.c(),B(u,1),u.m(e.mount(),e.anchor),d=!0),e.block=u,e.blocks&&(e.blocks[r]=u),d&&vt()}if(mn(n)){const o=ct();if(n.then(r=>{Ce(o),l(e.then,1,e.value,r),Ce(null)},r=>{if(Ce(o),l(e.catch,2,e.error,r),Ce(null),!e.hasCatch)throw r}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,n),!0;e.resolved=n}}function rn(n,e,t){const l=e.slice(),{resolved:o}=n;n.current===n.then&&(l[n.value]=o),n.current===n.catch&&(l[n.error]=o),n.block.p(l,t)}function ce(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Tn(n,e){n.d(1),e.delete(n.key)}function In(n,e,t,l,o,r,i,a,c,u,d,f){let _=n.length,g=r.length,p=_;const v={};for(;p--;)v[n[p].key]=p;const w=[],L=new Map,$=new Map,M=[];for(p=g;p--;){const C=f(o,r,p),S=t(C);let U=i.get(S);U?l&&M.push(()=>U.p(C,e)):(U=u(S,C),U.c()),L.set(S,w[p]=U),S in v&&$.set(S,Math.abs(p-v[S]))}const x=new Set,O=new Set;function T(C){B(C,1),C.m(a,d),i.set(C.key,C),d=C.first,g--}for(;_&&g;){const C=w[g-1],S=n[_-1],U=C.key,E=S.key;C===S?(d=C.first,_--,g--):L.has(E)?!i.has(U)||x.has(U)?T(C):O.has(E)?_--:$.get(U)>$.get(E)?(O.add(U),T(C)):(x.add(E),_--):(c(S,i),_--)}for(;_--;){const C=n[_];L.has(C.key)||c(C,i)}for(;g;)T(w[g-1]);return ie(M),w}function se(n){n&&n.c()}function Z(n,e,t){const{fragment:l,after_update:o}=n.$$;l&&l.m(e,t),Ge(()=>{const r=n.$$.on_mount.map(nn).filter(lt);n.$$.on_destroy?n.$$.on_destroy.push(...r):ie(r),n.$$.on_mount=[]}),o.forEach(Ge)}function K(n,e){const t=n.$$;t.fragment!==null&&(Pn(t.after_update),ie(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Un(n,e){n.$$.dirty[0]===-1&&(Ae.push(n),Cn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function ue(n,e,t,l,o,r,i=null,a=[-1]){const c=ze;Ce(n);const u=n.$$={fragment:null,ctx:[],props:r,update:D,not_equal:o,bound:St(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:St(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};i&&i(u.root);let d=!1;if(u.ctx=t?t(n,e.props||{},(f,_,...g)=>{const p=g.length?g[0]:_;return u.ctx&&o(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),d&&Un(n,f)),_}):[],u.update(),d=!0,ie(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const f=yn(e.target);u.fragment&&u.fragment.l(f),f.forEach(b)}else u.fragment&&u.fragment.c();e.intro&&B(n.$$.fragment),Z(n,e.target,e.anchor),vt()}Ce(c)}class de{constructor(){Xe(this,"$$");Xe(this,"$$set")}$destroy(){K(this,1),this.$destroy=D}$on(e,t){if(!lt(t))return D;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!bn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Hn="4",Ne=[];function Te(n,e=D){let t;const l=new Set;function o(a){if(ae(n,a)&&(n=a,t)){const c=!Ne.length;for(const u of l)u[1](),Ne.push(u,n);if(c){for(let u=0;u<Ne.length;u+=2)Ne[u][0](Ne[u+1]);Ne.length=0}}}function r(a){o(a(n))}function i(a,c=D){const u=[a,c];return l.add(u),l.size===1&&(t=e(o,r)||D),a(n),()=>{l.delete(u),l.size===0&&t&&(t(),t=null)}}return{set:o,update:r,subscribe:i}}var Je=(n=>(n.info="info",n.warn="warn",n.error="error",n))(Je||{});class On{constructor(){Xe(this,"logs",Te([]))}_addLog(e,t){this.logs.update(l=>(l.unshift({date:new Date,severity:e,content:t}),l))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,t){this.logs.update(l=>(l[e]&&(l[e].content=t),l))}}const H=new On;function En(n,e){let t=!1;return n.subscribe(l=>{t?e(l):t=!0})}const xn={use_dark_theme:!0,rs_plugin_loader:!1,close_after_launch:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,selected:{game:te.osrs,client:Pe.runelite,user_id:null},userDetails:{}};function Nn(){const e=new URLSearchParams(window.location.search).get("config");function t(o){return typeof o=="object"&&typeof o.use_dark_theme=="boolean"&&typeof o.rs_plugin_loader=="boolean"&&typeof o.close_after_launch=="boolean"&&typeof o.check_announcements=="boolean"&&typeof o.flatpak_rich_presence=="boolean"&&typeof o.runelite_use_custom_jar=="boolean"&&typeof o.selected=="object"&&Object.values(te).includes(o.selected.game)&&Object.values(Pe).includes(o.selected.client)&&(typeof o.selected.user_id=="string"||o.selected.user_id===null)&&typeof o.userDetails=="object"}const{config:l}=q;if(e)try{const o=JSON.parse(e);typeof o.check_announcements>"u"&&(o.check_announcements=!0,q.configHasPendingChanges=!0),typeof o.close_after_launch>"u"&&(o.close_after_launch=!1,q.configHasPendingChanges=!0),t(o)?l.set(o):(H.error("The config saved on disk is not the correct format. It has been restored to default."),q.configHasPendingChanges=!0)}catch{H.error("Unable to parse config, restoring to default"),q.configHasPendingChanges=!0}else q.configHasPendingChanges=!0;En(q.config,()=>{q.configHasPendingChanges=!0})}const q={initialized:Te(!1),configHasPendingChanges:!1,config:Te(xn),sessions:Te([])};let _t=!1;class z{static async login(e,t){const l=await nt.buildSession(e,t);if(!l.ok)return V(l.error);const o=l.value,i=me(q.sessions).findIndex(a=>a.user.userId===e.sub);return i!==-1?q.sessions.update(a=>(a[i]=o,a)):(q.sessions.update(a=>(a.push(o),a)),q.config.update(a=>(a.selected.user_id=o.user.userId,a))),ye(o)}static async logout(e){const{sessions:t,config:l}=q;return t.update(o=>{const r=o.findIndex(i=>i.user.userId===e);return r>-1&&(ke.revokeOauthCreds(o[r].tokens.access_token),o.splice(r,1)),o}),l.update(o=>(typeof o.userDetails[e]<"u"&&delete o.userDetails[e],o.selected.user_id===e&&(o.selected.user_id=null),o)),me(t)}static saveConfig(e=!0){if(_t||e&&!q.configHasPendingChanges)return;_t=!0;const t=new XMLHttpRequest;t.open("POST","/save-config",!0),t.onreadystatechange=()=>{t.readyState==4&&(H.info(`Save config status: '${t.responseText.trim()}'`),_t=!1)},t.setRequestHeader("Content-Type","application/json");const l=me(q.config);return t.send(JSON.stringify(l)),l}static async saveCredentials(){new Promise(e=>{const t=new XMLHttpRequest;t.open("POST","/save-credentials",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&e(void 0)};const l=me(q.sessions);t.send(JSON.stringify(l))})}static async openFilePicker(){return new Promise(e=>{const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(t.readyState==4)return t.status==200?e(t.responseText):e(void 0)},t.open("GET","/jar-file-picker",!0),t.send()})}static findSession(e){return me(q.sessions).find(l=>l.user.userId===e)}static findAccount(e,t){return e.find(l=>l.accountId==t)}}const wt=Te([]),gt=Te(null);typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Hn);function Mn(n){let e,t;const l=n[4].default,o=ot(l,n,n[3],null);return{c(){e=m("main"),o&&o.c(),h(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),ne(e,"dark",n[0])},m(r,i){k(r,e,i),o&&o.m(e,null),t=!0},p(r,[i]){o&&o.p&&(!t||i&8)&&it(o,l,r,r[3],t?rt(l,r[3],i,null):at(r[3]),null),(!t||i&1)&&ne(e,"dark",r[0])},i(r){t||(B(o,r),t=!0)},o(r){G(o,r),t=!1},d(r){r&&b(e),o&&o.d(r)}}}function jn(n,e,t){let l,o,{$$slots:r={},$$scope:i}=e;const{config:a}=q;return pe(n,a,c=>t(2,o=c)),n.$$set=c=>{"$$scope"in c&&t(3,i=c.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&t(0,l=o.use_dark_theme)},[l,a,o,i,r]}class an extends de{constructor(e){super(),ue(this,e,jn,Mn,ae,{})}}function An(n){let e;return{c(){e=m("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',h(e,"class","flex h-full items-center justify-center")},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function Dn(n){let e,t;return e=new an({props:{$$slots:{default:[An]},$$scope:{ctx:n}}}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),t=!0},p(l,[o]){const r={};o&32&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function qn(n){const e=window.opener;P.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function t(i){const a=De.get("auth_verifier");if(!a)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:c,redirect:u}=P.env,d=await ke.getOAuthToken(P.env.origin,c,a,u,i);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function l(i){const a=De.get("auth_nonce"),c=ke.validateIdToken(i,a??"");if(!c.ok)return o(c.error),null;const u=await ke.getSessionId(P.env.auth_api,i);return u.ok?u.value:(o(`Unable to retreive session id. ${u.error}`),null)}function o(i){r({type:"authFailed",reason:i}),fetch("/close")}function r(i){e.postMessage(i,window.location.origin)}return on(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),c=i.get("state"),u=i.get("id_token");if(u==null&&a&&c){const d=await t(a);if(!d)return o("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();ke.navigateToAuthConsent(P.env.origin,d.id_token,f)}else if(u&&a&&c){const d=await l(u);if(!d)return o("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),fetch("/close")}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),$n(()=>{De.remove("auth_verifier"),De.remove("auth_nonce")}),[]}class Bn extends de{constructor(e){super(),ue(this,e,qn,Dn,ae,{})}}function Ct(n){let e,t,l;return{c(){e=m("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',h(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(o,r){k(o,e,r),t||(l=N(e,"click",n[2]),t=!0)},p:D,d(o){o&&b(e),t=!1,l()}}}function Rt(n){let e;const t=n[7].default,l=ot(t,n,n[6],null);return{c(){l&&l.c()},m(o,r){l&&l.m(o,r),e=!0},p(o,r){l&&l.p&&(!e||r&64)&&it(l,t,o,o[6],e?rt(t,o[6],r,null):at(o[6]),null)},i(o){e||(B(l,o),e=!0)},o(o){G(l,o),e=!1},d(o){l&&l.d(o)}}}function Gn(n){let e,t,l,o,r,i,a=n[1]&&Ct(n),c=n[4]&&Rt(n);return{c(){e=m("dialog"),a&&a.c(),t=R(),c&&c.c(),h(e,"class",l=n[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),ne(e,"backdrop:cursor-pointer",n[1])},m(u,d){k(u,e,d),a&&a.m(e,null),y(e,t),c&&c.m(e,null),n[8](e),o=!0,r||(i=[N(e,"keydown",n[9]),N(e,"mousedown",wn(n[10]))],r=!0)},p(u,[d]){u[1]?a?a.p(u,d):(a=Ct(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u[4]?c?(c.p(u,d),d&16&&B(c,1)):(c=Rt(u),c.c(),B(c,1),c.m(e,null)):c&&(Ve(),G(c,1,1,()=>{c=null}),Ye()),(!o||d&1&&l!==(l=u[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&h(e,"class",l),(!o||d&3)&&ne(e,"backdrop:cursor-pointer",u[1])},i(u){o||(B(c),o=!0)},o(u){G(c),o=!1},d(u){u&&b(e),a&&a.d(),c&&c.d(),n[8](null),r=!1,ie(i)}}}function Fn(n,e,t){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,c=!1;const u=Sn();function d(){a.showModal(),t(4,c=!0)}function f(){u("close"),a.close(),t(4,c=!1)}function _(v){ve[v?"unshift":"push"](()=>{a=v,t(3,a)})}const g=v=>{v.key==="Escape"&&(v.preventDefault(),i&&f())},p=()=>{i&&f()};return n.$$set=v=>{"class"in v&&t(0,r=v.class),"canSelfClose"in v&&t(1,i=v.canSelfClose),"$$scope"in v&&t(6,o=v.$$scope)},[r,i,f,a,c,d,o,l,_,g,p]}class ut extends de{constructor(e){super(),ue(this,e,Fn,Gn,ae,{class:0,canSelfClose:1,open:5,close:2})}get open(){return this.$$.ctx[5]}get close(){return this.$$.ctx[2]}}function Xn(n){let e,t,l,o,r,i,a;return{c(){e=m("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,t=R(),l=m("p"),l.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,o=R(),r=m("button"),r.textContent="I Understand",h(e,"class","p-2"),h(l,"class","p-2"),h(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(c,u){k(c,e,u),k(c,t,u),k(c,l,u),k(c,o,u),k(c,r,u),i||(a=N(r,"click",n[2]),i=!0)},p:D,d(c){c&&(b(e),b(t),b(l),b(o),b(r)),i=!1,a()}}}function Jn(n){let e,t,l={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[Xn]},$$scope:{ctx:n}};return e=new ut({props:l}),n[3](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(B(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[3](null),K(e,o)}}}function Wn(n,e,t){let l;const{sessions:o}=q;pe(n,o,c=>t(4,l=c));let r;on(()=>{l.length==0&&r.open()});const i=()=>r.close();function a(c){ve[c?"unshift":"push"](()=>{r=c,t(0,r)})}return[r,o,i,a]}class zn extends de{constructor(e){super(),ue(this,e,Wn,Jn,ae,{})}}function Vn(n,e,t){z.saveConfig();const l=(a,c)=>{const u=new XMLHttpRequest,d={},f=me(q.config);a&&(d.hash=a),n&&(d.jx_session_id=n),e&&(d.jx_character_id=e),t&&(d.jx_display_name=t),f.rs_plugin_loader&&(d.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?d.config_uri=f.rs_config_uri:d.config_uri=P.env.default_config_uri,u.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(H.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&(a&&(P.rs3DebInstalledHash=a),f.close_after_launch&&!f.rs_plugin_loader&&fetch("/close")))},u.send(c)},o=new XMLHttpRequest,r=P.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");o.open("GET",i,!0),o.onreadystatechange=()=>{if(o.readyState==4&&o.status==200){const a=Object.fromEntries(o.response.split(`
`).map(c=>c.split(": ")));if(!a.Filename||!a.Size){H.error(`Could not parse package data from URL: ${i}`),l();return}if(a.SHA256!==P.rs3DebInstalledHash){H.info("Downloading RS3 client...");const c=new XMLHttpRequest;c.open("GET",r.concat(a.Filename),!0),c.responseType="arraybuffer",c.onprogress=u=>{if(u.loaded){const d=(Math.round(1e3*u.loaded/u.total)/10).toFixed(1);H.updateLogAtIndex(0,`Downloading RS3 client... ${d}%`)}},c.onreadystatechange=()=>{c.readyState==4&&c.status==200&&l(a.SHA256,c.response)},c.onerror=()=>{H.error(`Error downloading game client: from ${i}: non-http error`),l()},c.send()}else H.info("Latest client is already installed"),l()}},o.onerror=()=>{H.error(`Error: from ${i}: non-http error`),l()},o.send()}function cn(n,e,t,l){z.saveConfig();const o=l?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=me(q.config),i=(d,f,_)=>{const g=new XMLHttpRequest,p={};d&&(p.id=d),_&&(p.jar_path=_),n&&(p.jx_session_id=n),e&&(p.jx_character_id=e),t&&(p.jx_display_name=t),r.flatpak_rich_presence&&(p.flatpak_rich_presence=""),g.open(f?"POST":"GET",o.concat(new URLSearchParams(p).toString()),!0),g.onreadystatechange=()=>{g.readyState==4&&(H.info(`Game launch status: '${g.responseText.trim()}'`),g.status==200&&(d&&(P.runeLiteInstalledId=d),r.close_after_launch&&!l&&fetch("/close")))},g.send(f)};if(r.runelite_use_custom_jar){i(null,null,r.runelite_custom_jar);return}const a=2*60*1e3;if(P.runeLiteInstalledId!==null){const d=me(gt);if(d!==null&&d+a>Date.now()){i();return}}const c=new XMLHttpRequest;c.open("GET","https://api.github.com/repos/runelite/launcher/releases",!0),c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const d=JSON.parse(c.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");if(d.id!=P.runeLiteInstalledId){H.info("Downloading RuneLite...");const f=new XMLHttpRequest;f.open("GET",d.browser_download_url,!0),f.responseType="arraybuffer",f.onreadystatechange=()=>{f.readyState==4&&(f.status==200?(gt.set(Date.now()),i(d.id,f.response)):H.error(`Error downloading from ${d.url}: ${f.status}: ${f.responseText}`))},f.onprogress=_=>{if(_.loaded&&_.lengthComputable){const g=(Math.round(1e3*_.loaded/_.total)/10).toFixed(1);H.updateLogAtIndex(0,`Downloading RuneLite... ${g}%`)}},f.send()}else gt.set(Date.now()),i()}else H.error(`Failed to check for RuneLite updates: ${c.status}: ${c.responseText}`),i()},c.send()}function Yn(n,e,t){z.saveConfig();const l=me(q.config),o=(a,c)=>{const u=new XMLHttpRequest,d={};a&&(d.version=a),n&&(d.jx_session_id=n),e&&(d.jx_character_id=e),t&&(d.jx_display_name=t),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(d).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(H.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&(a&&(P.hdosInstalledVersion=a),l.close_after_launch&&fetch("/close")))},u.send(c)},r=new XMLHttpRequest,i="https://cdn.hdos.dev/client/getdown.txt";r.open("GET",i,!0),r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=r.responseText.match(/^launcher\.version *= *(.*?)$/m);if(a&&a.length>=2){const c=a[1];if(c!==P.hdosInstalledVersion){const u=`https://cdn.hdos.dev/launcher/v${c}/hdos-launcher.jar`;H.info("Downloading HDOS...");const d=new XMLHttpRequest;d.open("GET",u,!0),d.responseType="arraybuffer",d.onreadystatechange=()=>{if(d.readyState==4)if(d.status==200)o(c,d.response);else{const f=JSON.parse(r.responseText).map(_=>_.assets).flat().find(_=>_.name.toLowerCase()=="runelite.jar");H.error(`Error downloading from ${f.url}: ${d.status}: ${d.responseText}`)}},d.onprogress=f=>{if(f.loaded&&f.lengthComputable){const _=(Math.round(1e3*f.loaded/f.total)/10).toFixed(1);H.updateLogAtIndex(0,`Downloading HDOS... ${_}%`)}},d.send()}else H.info("Latest JAR is already installed"),o()}else H.info("Couldn't parse latest launcher version"),o()}else H.error(`Error from ${i}: ${r.status}: ${r.responseText}`)},r.send()}function ht(){const n=new XMLHttpRequest;n.open("GET","/list-game-clients",!0),n.onreadystatechange=()=>{n.readyState==4&&n.status!=200&&H.error(`Error requesting client list: ${n.status}: ${n.responseText}`)},n.send()}function Zn(){const n=new XMLHttpRequest;n.open("POST","/save-plugin-config",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=()=>{n.readyState==4&&H.info(`Save-plugin-config status: ${n.responseText.trim()}`)},n.send(JSON.stringify(P.pluginList))}async function Pt(n,e,t,l,o){z.saveConfig();const r=`${e?"osrs":P.env.provider}-${n?"win":"mac"}`;let i=n?e?P.osrsExeInstalledHash:P.rs3ExeInstalledHash:e?P.osrsAppInstalledHash:P.rs3AppInstalledHash;const a=async(S,U)=>{const E={},A=me(q.config);S&&(E.hash=S),t&&(E.jx_session_id=t),l&&(E.jx_character_id=l),o&&(E.jx_display_name=o),e||(A.rs_plugin_loader&&(E.plugin_loader="1"),E.config_uri=A.use_custom_rs_config_uri&&A.rs_config_uri?A.rs_config_uri:P.env.default_config_uri);const fe=await fetch(`/launch-${e?"osrs":"rs3"}-${n?"exe":"app"}?${new URLSearchParams(E).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:await U});fe.text().then(Q=>H.info(`Game launch status: '${Q.trim()}'`)),fe.status==200&&(S&&(i=S),A.close_after_launch&&(e||!A.rs_plugin_loader)&&fetch("/close"))},c=`${P.env.direct6_url}${r}/${r}.json`,u=await fetch(c,{method:"GET"}),d=await u.text();if(u.status!==200){H.error(`Error from ${c}: ${u.status}: ${d}`);return}const f=JSON.parse(atob(d.split(".")[1])).environments.production;if(i===f.id){H.info("Latest client is already installed"),a();return}H.info(`Downloading client version ${f.version}`);const _=`${P.env.direct6_url}${r}/catalog/${f.id}/catalog.json`,g=await fetch(_,{method:"GET"}),p=await g.text();if(g.status!==200){H.error(`Error from ${_}: ${g.status}: ${p}`);return}const v=JSON.parse(atob(p.split(".")[1])),w=S=>S.replace(/^http:\/\/(.{5})-akamai\.aws\.snxd\.com\//i,"https://$1.akamaized.net/").replace(/^http:/i,"https:"),L=w(v.metafile),$=await fetch(L,{method:"GET"}),M=await $.text();if($.status!==200){H.error(`Error from ${L}: ${$.status}: ${M}`);return}const x=JSON.parse(atob(M.split(".")[1])),O=x.pieces.digests.map(S=>{const U=atob(S).split("").map(A=>A.charCodeAt(0).toString(16).padStart(2,"0")).join(""),E=w(v.config.remote.baseUrl).concat(v.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",U.substring(0,2)).replace("{TargetDigest}",U));return fetch(E,{method:"GET"}).then(A=>A.blob().then(fe=>{const Q=new DecompressionStream("gzip");return new Response(fe.slice(6).stream().pipeThrough(Q)).blob()}))});let T=0,C=null;for(let S=0;S<x.files.length;S+=1)if(n?x.files[S].name.endsWith(".exe"):x.files[S].name.includes(".app/Contents/MacOS/"))if(C!==null){H.error(`Error parsing ${L}: file list has multiple possibilities for main exe`);return}else C=x.files[S].size;else C===null&&(T+=x.files[S].size);if(C===null){H.error(`Error parsing ${L}: file list has no possibilities for main exe`);return}Promise.all(O).then(S=>{const U=new Blob(S).slice(T,T+C);a(x.id,U.arrayBuffer())})}function Tt(n,e,t){const l=n.slice();return l[40]=e[t],l}function It(n,e,t){const l=n.slice();return l[43]=e[t],l}function Ut(n,e,t){const l=n.slice();return l[46]=e[t][0],l[39]=e[t][1],l}function Ht(n,e,t){const l=n.slice();return l[40]=e[t],l}function Kn(n){let e,t=ce(n[5]),l=[];for(let o=0;o<t.length;o+=1)l[o]=Ot(Ht(n,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=Le()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);k(o,e,r)},p(o,r){if(r[0]&1828){t=ce(o[5]);let i;for(i=0;i<t.length;i+=1){const a=Ht(o,t,i);l[i]?l[i].p(a,r):(l[i]=Ot(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(o){o&&b(e),Oe(l,o)}}}function Qn(n){let e;return{c(){e=m("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function Ot(n){let e,t=(n[40].identity||Bt)+"",l,o,r,i,a,c;function u(){return n[20](n[40])}return{c(){e=m("button"),l=F(t),r=R(),i=m("br"),h(e,"class",o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[8]&&n[2]===n[40].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){k(d,e,f),y(e,l),k(d,r,f),k(d,i,f),a||(c=N(e,"click",u),a=!0)},p(d,f){n=d,f[0]&32&&t!==(t=(n[40].identity||Bt)+"")&&_e(l,t),f[0]&292&&o!==(o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[8]&&n[2]===n[40].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&h(e,"class",o)},d(d){d&&(b(e),b(r),b(i)),a=!1,c()}}}function es(n){let e;return{c(){e=m("p"),e.textContent="error"},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function ts(n){let e,t,l,o,r,i=ce(Object.entries(n[0].pluginList)),a=[];for(let f=0;f<i.length;f+=1)a[f]=Et(Ut(n,i,f));function c(f,_){return f[8]?ns:ss}let u=c(n),d=u(n);return{c(){e=m("select");for(let f=0;f<a.length;f+=1)a[f].c();t=R(),d.c(),l=Le(),h(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[1]===void 0&&Ge(()=>n[21].call(e))},m(f,_){k(f,e,_);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(e,null);Ie(e,n[1],!0),k(f,t,_),d.m(f,_),k(f,l,_),o||(r=N(e,"change",n[21]),o=!0)},p(f,_){if(_[0]&1){i=ce(Object.entries(f[0].pluginList));let g;for(g=0;g<i.length;g+=1){const p=Ut(f,i,g);a[g]?a[g].p(p,_):(a[g]=Et(p),a[g].c(),a[g].m(e,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=i.length}_[0]&3&&Ie(e,f[1]),u===(u=c(f))&&d?d.p(f,_):(d.d(1),d=u(f),d&&(d.c(),d.m(l.parentNode,l)))},d(f){f&&(b(e),b(t),b(l)),Oe(a,f),d.d(f),o=!1,r()}}}function Et(n){let e,t=(n[39].name??Fe)+"",l,o;return{c(){e=m("option"),l=F(t),h(e,"class","dark:bg-slate-900"),e.__value=o=n[46],re(e,e.__value)},m(r,i){k(r,e,i),y(e,l)},p(r,i){i[0]&1&&t!==(t=(r[39].name??Fe)+"")&&_e(l,t),i[0]&1&&o!==(o=r[46])&&(e.__value=o,re(e,e.__value))},d(r){r&&b(e)}}}function ns(n){let e,t,l,o,r={ctx:n,current:null,token:null,hasCatch:!0,pending:ds,then:os,catch:ls,value:39};return st(o=n[4],r),{c(){e=m("br"),t=R(),l=Le(),r.block.c()},m(i,a){k(i,e,a),k(i,t,a),k(i,l,a),r.block.m(i,r.anchor=a),r.mount=()=>l.parentNode,r.anchor=l},p(i,a){n=i,r.ctx=n,a[0]&16&&o!==(o=n[4])&&st(o,r)||rn(r,n,a)},d(i){i&&(b(e),b(t),b(l)),r.block.d(i),r.token=null,r=null}}}function ss(n){let e,t,l,o,r,i,a,c,u,d,f,_,g,p,v,w,L,$=n[9]&&jt(n);function M(T,C){return C[0]&1&&(p=null),p==null&&(p=Object.entries(T[0].pluginList).length!==0),p?ps:fs}let x=M(n,[-1,-1]),O=x(n);return{c(){e=m("span"),t=m("button"),l=m("img"),i=R(),a=m("button"),c=m("img"),d=R(),f=m("br"),_=R(),$&&$.c(),g=R(),O.c(),v=Le(),bt(l.src,o="svgs/download-solid.svg")||h(l,"src",o),h(l,"alt","Install plugin from updater URL"),h(t,"class","mx-1 aspect-square w-9 rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),t.disabled=r=!n[0].hasLibArchive||n[7],h(t,"title","Install plugin from updater URL"),bt(c.src,u="svgs/folder-solid.svg")||h(c,"src",u),h(c,"alt","Install plugin from local directory"),h(a,"class","aspect-square w-9 rounded-md bg-blue-500 p-1 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),a.disabled=n[7],h(a,"title","Install plugin from local directory"),h(e,"class","align-middle")},m(T,C){k(T,e,C),y(e,t),y(t,l),y(e,i),y(e,a),y(a,c),k(T,d,C),k(T,f,C),k(T,_,C),$&&$.m(T,C),k(T,g,C),O.m(T,C),k(T,v,C),w||(L=[N(t,"click",n[22]),N(a,"click",n[14])],w=!0)},p(T,C){C[0]&129&&r!==(r=!T[0].hasLibArchive||T[7])&&(t.disabled=r),C[0]&128&&(a.disabled=T[7]),T[9]?$?$.p(T,C):($=jt(T),$.c(),$.m(g.parentNode,g)):$&&($.d(1),$=null),x===(x=M(T,C))&&O?O.p(T,C):(O.d(1),O=x(T),O&&(O.c(),O.m(v.parentNode,v)))},d(T){T&&(b(e),b(d),b(f),b(_),b(g),b(v)),$&&$.d(T),O.d(T),w=!1,ie(L)}}}function ls(n){let e;return{c(){e=m("p"),e.textContent="error"},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function os(n){let e,t,l,o,r,i,a,c,u,d;function f(w,L){return L[0]&19&&(e=null),L[0]&1&&(t=null),e==null&&(e=!!(w[39]&&w[39].main&&Object.keys(w[0].pluginList).includes(w[1]))),e?as:(t==null&&(t=Object.entries(w[0].pluginList).length===0),t?is:rs)}let _=f(n,[-1,-1]),g=_(n),p=ce(n[5]),v=[];for(let w=0;w<p.length;w+=1)v[w]=Mt(Tt(n,p,w));return{c(){g.c(),l=R(),o=m("br"),r=R(),i=m("br"),a=R(),c=m("hr"),u=R();for(let w=0;w<v.length;w+=1)v[w].c();d=Le(),h(c,"class","p-1 dark:border-slate-700")},m(w,L){g.m(w,L),k(w,l,L),k(w,o,L),k(w,r,L),k(w,i,L),k(w,a,L),k(w,c,L),k(w,u,L);for(let $=0;$<v.length;$+=1)v[$]&&v[$].m(w,L);k(w,d,L)},p(w,L){if(_===(_=f(w,L))&&g?g.p(w,L):(g.d(1),g=_(w),g&&(g.c(),g.m(l.parentNode,l))),L[0]&65573){p=ce(w[5]);let $;for($=0;$<p.length;$+=1){const M=Tt(w,p,$);v[$]?v[$].p(M,L):(v[$]=Mt(M),v[$].c(),v[$].m(d.parentNode,d))}for(;$<v.length;$+=1)v[$].d(1);v.length=p.length}},d(w){w&&(b(l),b(o),b(r),b(i),b(a),b(c),b(u),b(d)),g.d(w),Oe(v,w)}}}function rs(n){let e;return{c(){e=m("p"),e.textContent="can't start plugin: does not appear to be configured"},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function is(n){let e;return{c(){e=m("p"),e.textContent="(no plugins installed)"},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function as(n){let e,t,l=n[39].name+"",o,r,i;function a(){return n[28](n[39])}return{c(){e=m("button"),t=F("Start "),o=F(l),h(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(c,u){k(c,e,u),y(e,t),y(e,o),r||(i=N(e,"click",a),r=!0)},p(c,u){n=c,u[0]&16&&l!==(l=n[39].name+"")&&_e(o,l)},d(c){c&&b(e),r=!1,i()}}}function xt(n){let e,t=ce(n[40].plugins),l=[];for(let o=0;o<t.length;o+=1)l[o]=Nt(It(n,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=Le()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);k(o,e,r)},p(o,r){if(r[0]&65573){t=ce(o[40].plugins);let i;for(i=0;i<t.length;i+=1){const a=It(o,t,i);l[i]?l[i].p(a,r):(l[i]=Nt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(o){o&&b(e),Oe(l,o)}}}function cs(n){let e,t=n[43].id+"",l;return{c(){e=m("p"),l=F(t)},m(o,r){k(o,e,r),y(e,l)},p(o,r){r[0]&32&&t!==(t=o[43].id+"")&&_e(l,t)},d(o){o&&b(e)}}}function us(n){let e,t=(n[0].pluginList[n[43].id].name??n[43].id)+"",l,o,r,i,a,c;function u(){return n[29](n[43])}return{c(){e=m("p"),l=F(t),o=R(),r=m("button"),r.innerHTML='<img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/>',i=R(),h(r,"class","rounded-sm bg-rose-500 shadow-lg hover:opacity-75")},m(d,f){k(d,e,f),y(e,l),y(e,o),y(e,r),y(e,i),a||(c=N(r,"click",u),a=!0)},p(d,f){n=d,f[0]&33&&t!==(t=(n[0].pluginList[n[43].id].name??n[43].id)+"")&&_e(l,t)},d(d){d&&b(e),a=!1,c()}}}function Nt(n){let e,t;function l(i,a){return a[0]&33&&(e=null),e==null&&(e=!!Object.keys(i[0].pluginList).includes(i[43].id)),e?us:cs}let o=l(n,[-1,-1]),r=o(n);return{c(){r.c(),t=Le()},m(i,a){r.m(i,a),k(i,t,a)},p(i,a){o===(o=l(i,a))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(t.parentNode,t)))},d(i){i&&b(t),r.d(i)}}}function Mt(n){let e,t=n[40].uid===n[2]&&xt(n);return{c(){t&&t.c(),e=Le()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,o){l[40].uid===l[2]?t?t.p(l,o):(t=xt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&b(e),t&&t.d(l)}}}function ds(n){let e;return{c(){e=m("p"),e.textContent="loading..."},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function jt(n){let e,t,l,o,r,i,a,c,u,d,f,_;return{c(){e=m("label"),e.textContent="URL:",t=R(),l=m("textarea"),o=R(),r=m("button"),r.innerHTML='<img src="svgs/check-solid.svg" class="h-5 w-5" alt="Confirm"/>',i=R(),a=m("button"),a.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',c=R(),u=m("br"),d=m("br"),h(e,"for","plugin-updater-url-input"),h(l,"rows","1"),h(l,"id","plugin-updater-url-input"),h(l,"class","w-[50%] max-w-[60%] resize-x rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800"),h(r,"title","Confirm"),h(r,"class","rounded-sm bg-emerald-500 hover:opacity-75"),h(a,"title","Close URL entry"),h(a,"class","rounded-sm bg-rose-500 hover:opacity-75")},m(g,p){k(g,e,p),k(g,t,p),k(g,l,p),re(l,n[10]),k(g,o,p),k(g,r,p),k(g,i,p),k(g,a,p),k(g,c,p),k(g,u,p),k(g,d,p),f||(_=[N(l,"input",n[23]),N(r,"click",n[24]),N(a,"click",n[25])],f=!0)},p(g,p){p[0]&1024&&re(l,g[10])},d(g){g&&(b(e),b(t),b(l),b(o),b(r),b(i),b(a),b(c),b(u),b(d)),f=!1,ie(_)}}}function fs(n){let e;return{c(){e=m("p"),e.textContent=`You have no plugins installed. You can install plugins either from an updater URL, or by
						downloading them onto your computer and selecting the "bolt.json" file.`},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function ps(n){let e=Object.keys(n[0].pluginList).includes(n[1])&&n[4]!==null,t,l=e&&At(n);return{c(){l&&l.c(),t=Le()},m(o,r){l&&l.m(o,r),k(o,t,r)},p(o,r){r[0]&19&&(e=Object.keys(o[0].pluginList).includes(o[1])&&o[4]!==null),e?l?l.p(o,r):(l=At(o),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(o){o&&b(t),l&&l.d(o)}}}function At(n){let e,t,l,o,r,i,a,c={ctx:n,current:null,token:null,hasCatch:!0,pending:hs,then:gs,catch:_s,value:39};st(e=n[4],c);let u=n[3].updaterURL&&qt(n);return{c(){c.block.c(),t=R(),l=m("button"),l.textContent="Remove",o=R(),u&&u.c(),r=Le(),h(l,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(d,f){c.block.m(d,c.anchor=f),c.mount=()=>t.parentNode,c.anchor=t,k(d,t,f),k(d,l,f),k(d,o,f),u&&u.m(d,f),k(d,r,f),i||(a=N(l,"click",n[26]),i=!0)},p(d,f){n=d,c.ctx=n,f[0]&16&&e!==(e=n[4])&&st(e,c)||rn(c,n,f),n[3].updaterURL?u?u.p(n,f):(u=qt(n),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},d(d){d&&(b(t),b(l),b(o),b(r)),c.block.d(d),c.token=null,c=null,u&&u.d(d),i=!1,a()}}}function _s(n){let e,t,l;return{c(){e=m("p"),e.textContent="error",t=R(),l=m("br")},m(o,r){k(o,e,r),k(o,t,r),k(o,l,r)},p:D,d(o){o&&(b(e),b(t),b(l))}}}function gs(n){let e,t=(n[39].name??Fe)+"",l,o,r,i,a=(n[39].description??"no description")+"",c,u,d,f,_=n[39].version&&Dt(n);return{c(){e=m("p"),l=F(t),o=R(),_&&_.c(),r=R(),i=m("p"),c=F(a),d=R(),f=m("br"),h(e,"class","pb-4 text-xl font-bold"),h(i,"class",u=n[39].description?null:"italic")},m(g,p){k(g,e,p),y(e,l),y(e,o),_&&_.m(e,null),k(g,r,p),k(g,i,p),y(i,c),k(g,d,p),k(g,f,p)},p(g,p){p[0]&16&&t!==(t=(g[39].name??Fe)+"")&&_e(l,t),g[39].version?_?_.p(g,p):(_=Dt(g),_.c(),_.m(e,null)):_&&(_.d(1),_=null),p[0]&16&&a!==(a=(g[39].description??"no description")+"")&&_e(c,a),p[0]&16&&u!==(u=g[39].description?null:"italic")&&h(i,"class",u)},d(g){g&&(b(e),b(r),b(i),b(d),b(f)),_&&_.d()}}}function Dt(n){let e,t,l,o,r=n[39].version+"",i;return{c(){e=m("br"),t=R(),l=m("span"),o=F("v"),i=F(r),h(l,"class","pb-4 text-xl font-bold italic text-slate-600")},m(a,c){k(a,e,c),k(a,t,c),k(a,l,c),y(l,o),y(l,i)},p(a,c){c[0]&16&&r!==(r=a[39].version+"")&&_e(i,r)},d(a){a&&(b(e),b(t),b(l))}}}function hs(n){let e;return{c(){e=m("p"),e.textContent="loading..."},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function qt(n){let e,t,l,o;return{c(){e=F(` 
							`),t=m("button"),t.textContent="Check updates",h(t,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(r,i){k(r,e,i),k(r,t,i),l||(o=N(t,"click",n[27]),l=!0)},p:D,d(r){r&&(b(e),b(t)),l=!1,o()}}}function ms(n){let e,t,l,o,r,i,a,c,u,d,f;function _($,M){return $[5].length==0?Qn:Kn}let g=_(n),p=g(n);function v($,M){return $[0].hasBoltPlugins?ts:es}let w=v(n),L=w(n);return{c(){e=m("div"),t=m("button"),l=F("Manage Plugins"),r=R(),i=m("hr"),a=R(),p.c(),c=R(),u=m("div"),L.c(),h(t,"class",o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(n[8]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),h(i,"class","p-1 dark:border-slate-700"),h(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),h(u,"class","h-full pt-10")},m($,M){k($,e,M),y(e,t),y(t,l),y(e,r),y(e,i),y(e,a),p.m(e,null),k($,c,M),k($,u,M),L.m(u,null),d||(f=N(t,"click",n[19]),d=!0)},p($,M){M[0]&256&&o!==(o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+($[8]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&h(t,"class",o),g===(g=_($))&&p?p.p($,M):(p.d(1),p=g($),p&&(p.c(),p.m(e,null))),w===(w=v($))&&L?L.p($,M):(L.d(1),L=w($),L&&(L.c(),L.m(u,null)))},d($){$&&(b(e),b(c),b(u)),p.d(),L.d(),d=!1,f()}}}function bs(n){let e,t,l={class:"h-[90%] w-[90%] text-center",$$slots:{default:[ms]},$$scope:{ctx:n}};return e=new ut({props:l}),n[30](e),e.$on("close",n[31]),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,r){const i={};r[0]&8127|r[1]&1048576&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(B(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[30](null),K(e,o)}}}const Qe="bolt.json",ks="main.lua",Fe="(unnamed)",Bt="(new character)";function ws(n,e,t){let l,o,r,i;pe(n,wt,I=>t(5,i=I));let a;const c=P.platform==="windows"?"\\":"/",u=c.concat(Qe);function d(){t(9,U=!1),a.open()}const f=I=>new Promise((W,X)=>{const be=I.concat(I.endsWith(c)?Qe:u);var J=new XMLHttpRequest;J.onreadystatechange=()=>{J.readyState==4&&(J.status==200?W(JSON.parse(J.responseText)):X(J.responseText))},J.open("GET","/read-json-file?".concat(new URLSearchParams({path:be}).toString()),!0),J.send()}),_=I=>fetch("/get-plugindir-json?".concat(new URLSearchParams({id:I}).toString())).then(W=>W.ok?W.json():null),g=I=>{const X=P.pluginList[I];if(!X)return null;const be=X.path;return be?f(be):_(I)},p=()=>{let I;do I=crypto.randomUUID();while(Object.keys(P.pluginList).includes(I));return I},v=(I,W)=>{f(I).then(X=>{t(1,T=p()),t(0,P.pluginList[T]={name:X.name??Fe,path:I,version:X.version},P),t(11,A=!0)}).catch(X=>{console.error(`Config file '${W}' couldn't be fetched, reason: ${X}`)})},w=I=>{fetch(I).then(async W=>{if(!W.ok)return;const X=await W.json();if(X.url){const be=await fetch(X.url).then(Ee=>Ee.arrayBuffer());if(X.sha256){const Ee=await crypto.subtle.digest("SHA-256",be),Ue=Array.from(new Uint8Array(Ee)).map(dt=>dt.toString(16).padStart(2,"0")).join("");if(X.sha256!==Ue){console.error("not installing plugin: incorrect file hash");return}}const J=p();if(!(await fetch("/install-plugin?".concat(new URLSearchParams({id:J}).toString()),{method:"POST",body:be})).ok)return;const $e=await _(J);$e&&(t(1,T=J),t(0,P.pluginList[T]={name:$e.name??Fe,version:$e.version,updaterURL:I,sha256:X.sha256},P),t(11,A=!0))}})};let L=!1;const $=()=>{t(7,L=!0);var I=new XMLHttpRequest;I.onreadystatechange=()=>{if(I.readyState==4&&(t(7,L=!1),I.status==200))if(I.responseText.endsWith(u)){const W=I.responseText.substring(0,I.responseText.length-Qe.length);v(W,I.responseText)}else console.log(`Selection '${I.responseText}' is not named ${Qe}; ignored`)},I.open("GET","/json-file-picker",!0),I.send()};ht();const M=(I,W,X,be)=>{let J=null;if(X){const $e=P.platform==="windows"?X.replaceAll("\\","/"):X;J=$e.endsWith(c)?$e:$e.concat("/")}var we=new XMLHttpRequest;we.onreadystatechange=()=>{we.readyState==4&&(ht(),H.info(`Start-plugin status: ${we.statusText.trim()}`))},J?we.open("GET","/start-plugin?".concat(new URLSearchParams({client:I.toString(),id:W,main:be,path:J}).toString()),!0):we.open("GET","/start-plugin?".concat(new URLSearchParams({client:I.toString(),id:W,main:be}).toString()),!0),we.send()},x=(I,W)=>{var X=new XMLHttpRequest;X.onreadystatechange=()=>{X.readyState==4&&(ht(),H.info(`Stop-plugin status: ${X.statusText.trim()}`))},X.open("GET","/stop-plugin?".concat(new URLSearchParams({client:I.toString(),uid:W.toString()}).toString()),!0),X.send()},O=(I,W)=>{const X=I.updaterURL;fetch(X).then(async be=>{let J=await be.json(),we=!1;if(J.sha256?I.sha256!==J.sha256&&(we=!0):J.version&&I.version!==J.version&&(we=!0),we&&J.url){const $e=await fetch(J.url);if(!$e.ok)return null;const Ee=await $e.arrayBuffer();if(J.sha256){const dt=await crypto.subtle.digest("SHA-256",Ee),fn=Array.from(new Uint8Array(dt)).map(pn=>pn.toString(16).padStart(2,"0")).join("");if(J.sha256!==fn){console.error(`not updating plugin '${I.name}': incorrect file hash`);return}}fetch("/install-plugin?".concat(new URLSearchParams({id:W}).toString()),{method:"POST",body:Ee});const Ue=await _(W);Ue&&(J.sha256&&(I.sha256=J.sha256),Ue.name&&(I.name=Ue.name),Ue.version&&(I.version=Ue.version),t(11,A=!0))}})};var T,C=!1,S;let U=!1,E,A=!1;const fe=()=>t(8,C=!1),Q=I=>{t(2,S=I.uid),t(8,C=!0),t(9,U=!1),t(10,E="")};function Y(){T=yt(this),t(1,T),t(0,P)}const he=()=>{t(9,U=!U),t(10,E="")};function le(){E=this.value,t(10,E)}const oe=()=>{w(E),t(9,U=!1),t(10,E="")},j=()=>{t(9,U=!1),t(10,E="")},ee=()=>{t(4,r=null),t(11,A=!0);let I=P.pluginList;delete I[T],t(0,P.pluginList=I,P)},Re=()=>O(l,T),ge=I=>M(S,T,o??null,I.main??ks),Ze=I=>{x(S,I.uid)};function un(I){ve[I?"unshift":"push"](()=>{a=I,t(6,a)})}const dn=()=>{A&&(Zn(),t(11,A=!1))};return n.$$.update=()=>{n.$$.dirty[0]&36&&(i.some(I=>I.uid===S)||t(8,C=!1)),n.$$.dirty[0]&3&&t(3,l=P.pluginList[T]),n.$$.dirty[0]&2&&t(4,r=g(T)),n.$$.dirty[0]&24&&r&&r.then(I=>{let W=!1;I.name!==l.name&&(t(3,l.name=I.name,l),W=!0),I.version!==l.version&&(t(3,l.version=I.version,l),W=!0),W&&(t(3,l),t(0,P),t(1,T),t(4,r),t(11,A=!0))}),n.$$.dirty[0]&8&&t(12,o=l?l.path:null)},[P,T,S,l,r,i,a,L,C,U,E,A,o,w,$,M,x,O,d,fe,Q,Y,he,le,oe,j,ee,Re,ge,Ze,un,dn]}class ys extends de{constructor(e){super(),ue(this,e,ws,bs,ae,{open:18},null,[-1,-1])}get open(){return this.$$.ctx[18]}}function vs(n){let e,t,l,o,r,i,a,c,u,d,f,_,g;return{c(){e=m("div"),t=m("h2"),t.textContent="Game is offline",l=R(),o=m("br"),r=R(),i=m("p"),i.textContent="This game appears to be offline for maintenance or an update. Launch anyway?",a=R(),c=m("div"),u=m("button"),u.textContent="No",d=R(),f=m("button"),f.textContent="Yes",h(t,"class","text-3xl font-extrabold"),h(u,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(f,"class","mx-1 mb-2 mt-5 w-[45%] rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(c,"class","align-bottom")},m(p,v){k(p,e,v),y(e,t),y(e,l),y(e,o),y(e,r),y(e,i),y(e,a),y(e,c),y(c,u),y(c,d),y(c,f),_||(g=[N(u,"click",n[5]),N(f,"click",n[6])],_=!0)},p:D,d(p){p&&b(e),_=!1,ie(g)}}}function $s(n){let e,t,l={class:"h-fit w-3/5 px-5 py-3 text-center",$$slots:{default:[vs]},$$scope:{ctx:n}};return e=new ut({props:l}),n[7](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,[r]){const i={};r&271&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(B(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[7](null),K(e,o)}}}function Ss(n,e,t){let l,o,r,i;function a(f,_,g){t(3,i=f),t(1,o=_),t(2,r=g),l.open()}const c=()=>{l.close()},u=()=>{i(o,r),l.close()};function d(f){ve[f?"unshift":"push"](()=>{l=f,t(0,l)})}return[l,o,r,i,a,c,u,d]}class Ls extends de{constructor(e){super(),ue(this,e,Ss,$s,ae,{open:4})}get open(){return this.$$.ctx[4]}}function Gt(n,e,t){const l=n.slice();return l[20]=e[t],l}function Ft(n,e,t){const l=n.slice();return l[23]=e[t],l}function Cs(n){let e,t,l={};return e=new ys({props:l}),n[16](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,r){const i={};e.$set(i)},i(o){t||(B(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[16](null),K(e,o)}}}function Xt(n){let e,t;return{c(){e=m("div"),t=F(n[7]),h(e,"class","absolute left-[2%] w-[96%] rounded-lg bg-blue-400 px-2 text-black")},m(l,o){k(l,e,o),y(e,t)},p(l,o){o&128&&_e(t,l[7])},d(l){l&&b(e)}}}function Rs(n){let e,t,l;return{c(){e=m("button"),e.textContent="Plugin menu",e.disabled=!P.hasBoltPlugins,h(e,"title",P.hasBoltPlugins?null:"Coming soon..."),h(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(o,r){k(o,e,r),t||(l=N(e,"click",n[19]),t=!0)},p:D,d(o){o&&b(e),t=!1,l()}}}function Ps(n){let e,t,l,o,r,i,a=ce($t[n[1].selected.game]),c=[];for(let u=0;u<a.length;u+=1)c[u]=Jt(Ft(n,a,u));return{c(){e=m("label"),t=m("span"),t.textContent="Game Client",l=R(),o=m("select");for(let u=0;u<c.length;u+=1)c[u].c();h(t,"class","text-sm"),h(o,"id","game_client_select"),h(o,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[1].selected.client===void 0&&Ge(()=>n[18].call(o)),h(e,"class","flex flex-col")},m(u,d){k(u,e,d),y(e,t),y(e,l),y(e,o);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(o,null);Ie(o,n[1].selected.client,!0),r||(i=N(o,"change",n[18]),r=!0)},p(u,d){if(d&2){a=ce($t[u[1].selected.game]);let f;for(f=0;f<a.length;f+=1){const _=Ft(u,a,f);c[f]?c[f].p(_,d):(c[f]=Jt(_),c[f].c(),c[f].m(o,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=a.length}d&2&&Ie(o,u[1].selected.client)},d(u){u&&b(e),Oe(c,u),r=!1,i()}}}function Jt(n){let e,t=n[23]+"",l,o,r;return{c(){e=m("option"),l=F(t),h(e,"class","dark:bg-slate-900"),e.disabled=o=n[23]===Pe.official&&P.platform==We.Linux,e.__value=r=n[23],re(e,e.__value)},m(i,a){k(i,e,a),y(e,l)},p(i,a){a&2&&t!==(t=i[23]+"")&&_e(l,t),a&2&&o!==(o=i[23]===Pe.official&&P.platform==We.Linux)&&(e.disabled=o),a&2&&r!==(r=i[23])&&(e.__value=r,re(e,e.__value))},d(i){i&&b(e)}}}function Wt(n){let e;return{c(){e=m("option"),e.textContent="No characters",h(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",re(e,e.__value)},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function Ts(n){let e;return{c(){e=F("New Character")},m(t,l){k(t,e,l)},p:D,d(t){t&&b(e)}}}function Is(n){let e=n[20].displayName+"",t;return{c(){t=F(e)},m(l,o){k(l,t,o)},p(l,o){o&32&&e!==(e=l[20].displayName+"")&&_e(t,e)},d(l){l&&b(t)}}}function zt(n){let e,t,l;function o(a,c){return a[20].displayName?Is:Ts}let r=o(n),i=r(n);return{c(){e=m("option"),i.c(),t=R(),e.__value=l=n[20].accountId,re(e,e.__value),h(e,"class","dark:bg-slate-900")},m(a,c){k(a,e,c),i.m(e,null),y(e,t)},p(a,c){r===(r=o(a))&&i?i.p(a,c):(i.d(1),i=r(a),i&&(i.c(),i.m(e,t))),c&32&&l!==(l=a[20].accountId)&&(e.__value=l,re(e,e.__value))},d(a){a&&b(e),i.d()}}}function Us(n){let e,t,l,o,r,i,a,c,u,d,f,_,g,p,v,w,L,$,M,x,O,T,C,S,U={};e=new Ls({props:U}),n[15](e);let E=P.hasBoltPlugins&&Cs(n),A=n[7]&&Xt(n);function fe(j,ee){if(j[1].selected.game==te.osrs)return Ps;if(j[1].selected.game===te.rs3)return Rs}let Q=fe(n),Y=Q&&Q(n),he=ce(n[5]),le=[];for(let j=0;j<he.length;j+=1)le[j]=zt(Gt(n,he,j));let oe=null;return he.length||(oe=Wt()),{c(){se(e.$$.fragment),t=R(),E&&E.c(),l=R(),o=m("div"),A&&A.c(),r=R(),i=m("div"),a=m("img"),u=R(),d=m("button"),f=F("Play"),g=R(),Y&&Y.c(),p=R(),v=m("label"),w=m("span"),w.textContent="Character",L=R(),$=m("select"),M=m("option"),x=F("Select an account");for(let j=0;j<le.length;j+=1)le[j].c();oe&&oe.c(),bt(a.src,c="svgs/rocket-solid.svg")||h(a,"src",c),h(a,"alt","Launch icon"),h(a,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),h(d,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 enabled:hover:opacity-75 disabled:bg-gray-500"),d.disabled=_=!n[8],h(w,"class","text-sm"),M.__value=void 0,re(M,M.__value),M.disabled=!0,h(M,"class","dark:bg-slate-900"),h($,"id","character_select"),h($,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),$.disabled=O=!n[8]||n[1].selected.user_id===null,h(v,"class","flex flex-col"),h(i,"class","flex flex-col items-center gap-4"),h(o,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(j,ee){Z(e,j,ee),k(j,t,ee),E&&E.m(j,ee),k(j,l,ee),k(j,o,ee),A&&A.m(o,null),y(o,r),y(o,i),y(i,a),y(i,u),y(i,d),y(d,f),y(i,g),Y&&Y.m(i,null),y(i,p),y(i,v),y(v,w),y(v,L),y(v,$),y($,M),y(M,x);for(let Re=0;Re<le.length;Re+=1)le[Re]&&le[Re].m($,null);oe&&oe.m($,null),Ie($,n[4]),T=!0,C||(S=[N(d,"click",n[17]),N($,"change",n[13])],C=!0)},p(j,[ee]){const Re={};if(e.$set(Re),P.hasBoltPlugins&&E.p(j,ee),j[7]?A?A.p(j,ee):(A=Xt(j),A.c(),A.m(o,r)):A&&(A.d(1),A=null),(!T||ee&256&&_!==(_=!j[8]))&&(d.disabled=_),Q===(Q=fe(j))&&Y?Y.p(j,ee):(Y&&Y.d(1),Y=Q&&Q(j),Y&&(Y.c(),Y.m(i,p))),ee&32){he=ce(j[5]);let ge;for(ge=0;ge<he.length;ge+=1){const Ze=Gt(j,he,ge);le[ge]?le[ge].p(Ze,ee):(le[ge]=zt(Ze),le[ge].c(),le[ge].m($,null))}for(;ge<le.length;ge+=1)le[ge].d(1);le.length=he.length,!he.length&&oe?oe.p(j,ee):he.length?oe&&(oe.d(1),oe=null):(oe=Wt(),oe.c(),oe.m($,null))}(!T||ee&258&&O!==(O=!j[8]||j[1].selected.user_id===null))&&($.disabled=O),(!T||ee&48)&&Ie($,j[4])},i(j){T||(B(e.$$.fragment,j),B(E),T=!0)},o(j){G(e.$$.fragment,j),G(E),T=!1},d(j){j&&(b(t),b(l),b(o)),n[15](null),K(e,j),E&&E.d(j),A&&A.d(),Y&&Y.d(),Oe(le,j),oe&&oe.d(),C=!1,ie(S)}}}function Hs(n,e,t){let l,o,r,i,a,c,u,d,f,{config:_,initialized:g}=q;pe(n,_,C=>t(1,i=C)),pe(n,g,C=>t(8,u=C));let p=Te(null);pe(n,p,C=>t(7,c=C));let v=Te(!0);pe(n,v,C=>t(6,a=C));function w(C,S){if(!l)return H.warn("Please log in or select a user to play.");if(!o)return H.warn("Please select a character from the select menu.");const U=z.findSession(i.selected.user_id);if(!U)return H.warn("Unable to launch game, session was not found.");const{session_id:E}=U,A=z.findAccount(U.accounts,o);if(!A)return H.warn("Unable to launch game, account was not found.");const{accountId:fe,displayName:Q}=A,Y=P.platform===We.Windows,he=P.platform===We.Linux;switch(C){case te.osrs:switch(S){case Pe.official:Pt(Y,!0,E,fe,Q);break;case Pe.runelite:cn(E,fe,Q,!1);break;case Pe.hdos:Yn(E,fe,Q);break}break;case te.rs3:he?Vn(E,fe,Q):Pt(Y,!1,E,fe,Q);break}}function L(C){const S=C.target.value;if(!l)return;const U=i.userDetails[l];U?(U.account_id=S,Se(_,i.userDetails[l]=U,i)):Se(_,i.userDetails[l]={account_id:S},i)}function $(C){ve[C?"unshift":"push"](()=>{d=C,t(2,d)})}function M(C){ve[C?"unshift":"push"](()=>{f=C,t(3,f)})}const x=()=>{a?w(i.selected.game,i.selected.client):d.open(w,i.selected.game,i.selected.client)};function O(){i.selected.client=yt(this),_.set(i)}const T=()=>{f.open()};return n.$$.update=()=>{var C,S;if(n.$$.dirty&2&&t(14,l=i.selected.user_id),n.$$.dirty&16386&&t(4,o=(C=i.userDetails[l??""])==null?void 0:C.account_id),n.$$.dirty&2&&t(5,r=((S=z.findSession(i.selected.user_id))==null?void 0:S.accounts)??[]),n.$$.dirty&2)if(i.check_announcements){const U=`${P.env.psa_url}${i.selected.game==te.osrs?"osrs":P.env.provider}.json`;fetch(U,{method:"GET"}).then(E=>E.json()).then(E=>{Se(p,c=E.psa&&E.psa.length>0?E.psa:null,c),Se(v,a=!(E.isDisabled??!1),a)})}else Se(p,c=null,c),Se(v,a=!0,a)},[w,i,d,f,o,r,a,c,u,_,g,p,v,L,l,$,M,x,O,T]}class Os extends de{constructor(e){super(),ue(this,e,Hs,Us,ae,{launch:0})}get launch(){return this.$$.ctx[0]}}function Vt(n,e,t){const l=n.slice();return l[1]=e[t].date,l[2]=e[t].severity,l[3]=e[t].content,l}function Yt(n){var c;let e,t=((c=n[1])==null?void 0:c.toLocaleTimeString())+"",l,o,r=n[3]+"",i,a;return{c(){e=m("li"),l=F(t),o=F(`
				- `),i=F(r),a=R(),ne(e,"text-rose-500",n[2]===Je.error),ne(e,"text-orange-700",n[2]===Je.warn)},m(u,d){k(u,e,d),y(e,l),y(e,o),y(e,i),y(e,a)},p(u,d){var f;d&1&&t!==(t=((f=u[1])==null?void 0:f.toLocaleTimeString())+"")&&_e(l,t),d&1&&r!==(r=u[3]+"")&&_e(i,r),d&1&&ne(e,"text-rose-500",u[2]===Je.error),d&1&&ne(e,"text-orange-700",u[2]===Je.warn)},d(u){u&&b(e)}}}function Es(n){let e,t,l,o,r=ce(n[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=Yt(Vt(n,r,a));return{c(){e=m("div"),t=m("div"),t.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',l=R(),o=m("ol");for(let a=0;a<i.length;a+=1)i[a].c();h(t,"class","absolute right-6 top-2"),h(o,"id","message_list"),h(o,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),h(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,c){k(a,e,c),y(e,t),y(e,l),y(e,o);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(o,null)},p(a,[c]){if(c&1){r=ce(a[0]);let u;for(u=0;u<r.length;u+=1){const d=Vt(a,r,u);i[u]?i[u].p(d,c):(i[u]=Yt(d),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},i:D,o:D,d(a){a&&b(e),Oe(i,a)}}}function xs(n,e,t){let{logs:l}=e;return n.$$set=o=>{"logs"in o&&t(0,l=o.logs)},[l]}class Ns extends de{constructor(e){super(),ue(this,e,xs,Es,ae,{logs:0})}}function Zt(n,e,t){const l=n.slice();return l[7]=e[t],l}function Kt(n,e){let t,l=e[7].user.displayName+"",o,r;return{key:n,first:null,c(){t=m("option"),o=F(l),t.__value=r=e[7].user.userId,re(t,t.__value),h(t,"class","dark:bg-slate-900"),this.first=t},m(i,a){k(i,t,a),y(t,o)},p(i,a){e=i,a&2&&l!==(l=e[7].user.displayName+"")&&_e(o,l),a&2&&r!==(r=e[7].user.userId)&&(t.__value=r,re(t,t.__value))},d(i){i&&b(t)}}}function Ms(n){let e,t,l=[],o=new Map,r,i,a,c,u,d,f,_,g,p=ce(n[1]);const v=w=>w[7].user.userId;for(let w=0;w<p.length;w+=1){let L=Zt(n,p,w),$=v(L);o.set($,l[w]=Kt($,L))}return{c(){e=m("select"),t=m("option"),t.textContent="Select a user";for(let w=0;w<l.length;w+=1)l[w].c();r=R(),i=m("div"),a=m("button"),a.textContent="Log In",c=R(),u=m("button"),d=F("Log Out"),t.__value=null,re(t,t.__value),t.disabled=!0,h(t,"class","dark:bg-slate-900"),h(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),n[0].selected.user_id===void 0&&Ge(()=>n[4].call(e)),h(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),h(u,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),u.disabled=f=!n[0].selected.user_id,h(i,"class","mt-5 flex")},m(w,L){k(w,e,L),y(e,t);for(let $=0;$<l.length;$+=1)l[$]&&l[$].m(e,null);Ie(e,n[0].selected.user_id,!0),k(w,r,L),k(w,i,L),y(i,a),y(i,c),y(i,u),y(u,d),_||(g=[N(e,"change",n[4]),N(a,"click",n[5]),N(u,"click",n[6])],_=!0)},p(w,[L]){L&2&&(p=ce(w[1]),l=In(l,L,v,1,w,p,o,e,Tn,Kt,null,Zt)),L&3&&Ie(e,w[0].selected.user_id),L&3&&f!==(f=!w[0].selected.user_id)&&(u.disabled=f)},i:D,o:D,d(w){w&&(b(e),b(r),b(i));for(let L=0;L<l.length;L+=1)l[L].d();_=!1,ie(g)}}}function js(n,e,t){let l,o;const{sessions:r,config:i}=q;pe(n,r,d=>t(1,o=d)),pe(n,i,d=>t(0,l=d));function a(){l.selected.user_id=yt(this),i.set(l)}return[l,o,r,i,a,()=>{const{origin:d,redirect:f,clientid:_}=P.env;ke.openLoginWindow(d,f,_)},async()=>{l.selected.user_id&&(await z.logout(l.selected.user_id),z.saveCredentials())}]}class As extends de{constructor(e){super(),ue(this,e,js,Ms,ae,{})}}function Ds(n,{callback:e,ignore:t=[]}){const l=o=>{const r=t.some(i=>i.contains(o.target));n&&!n.contains(o.target)&&!o.defaultPrevented&&!r&&e()};return document.addEventListener("click",l,!0),document.addEventListener("contextmenu",l,!0),{destroy(){document.removeEventListener("click",l,!0),document.removeEventListener("contextmenu",l,!0)}}}const qs=n=>({}),Qt=n=>({});function en(n){let e,t,l,o,r,i;const a=n[9].content,c=ot(a,n,n[8],Qt);return{c(){e=m("div"),c&&c.c(),h(e,"class",t="dropdown-color absolute z-20 rounded-lg border-2 "+n[1]+" "+n[2]+" svelte-xifudk")},m(u,d){k(u,e,d),c&&c.m(e,null),o=!0,r||(i=kn(l=Ds.call(null,e,{callback:n[3],ignore:[n[5]]})),r=!0)},p(u,d){c&&c.p&&(!o||d&256)&&it(c,a,u,u[8],o?rt(a,u[8],d,qs):at(u[8]),Qt),(!o||d&6&&t!==(t="dropdown-color absolute z-20 rounded-lg border-2 "+u[1]+" "+u[2]+" svelte-xifudk"))&&h(e,"class",t),l&&lt(l.update)&&d&32&&l.update.call(null,{callback:u[3],ignore:[u[5]]})},i(u){o||(B(c,u),o=!0)},o(u){G(c,u),o=!1},d(u){u&&b(e),c&&c.d(u),r=!1,i()}}}function Bs(n){let e,t,l,o,r,i,a;const c=n[9].default,u=ot(c,n,n[8],null);let d=n[4]&&en(n);return{c(){e=m("div"),t=m("button"),u&&u.c(),l=R(),d&&d.c(),h(e,"class",o="relative h-fit w-fit "+n[0]+" svelte-xifudk")},m(f,_){k(f,e,_),y(e,t),u&&u.m(t,null),n[10](t),y(e,l),d&&d.m(e,null),r=!0,i||(a=N(t,"click",n[6]),i=!0)},p(f,[_]){u&&u.p&&(!r||_&256)&&it(u,c,f,f[8],r?rt(c,f[8],_,null):at(f[8]),null),f[4]?d?(d.p(f,_),_&16&&B(d,1)):(d=en(f),d.c(),B(d,1),d.m(e,null)):d&&(Ve(),G(d,1,1,()=>{d=null}),Ye()),(!r||_&1&&o!==(o="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&h(e,"class",o)},i(f){r||(B(u,f),B(d),r=!0)},o(f){G(u,f),G(d),r=!1},d(f){f&&b(e),u&&u.d(f),n[10](null),d&&d.d(),i=!1,a()}}}function Gs(n,e,t){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,c=!1,u;function d(){t(4,c=!0)}function f(){t(4,c=!1)}function _(){c?f():d()}function g(p){ve[p?"unshift":"push"](()=>{u=p,t(5,u)})}return n.$$set=p=>{"class"in p&&t(0,r=p.class),"position"in p&&t(1,i=p.position),"align"in p&&t(2,a=p.align),"$$scope"in p&&t(8,o=p.$$scope)},[r,i,a,f,c,u,_,d,o,l,g]}class Fs extends de{constructor(e){super(),ue(this,e,Gs,Bs,ae,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function Xs(n){let e,t,l,o,r,i,a,c,u,d,f,_,g;return{c(){e=m("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,t=R(),l=m("div"),o=m("label"),o.textContent="Check game announcements:",r=R(),i=m("input"),a=R(),c=m("div"),u=m("label"),u.textContent="Close Bolt after launching a game:",d=R(),f=m("input"),h(e,"id","data_dir_button"),h(e,"class","p-2 hover:opacity-75"),h(o,"for","check_announcements"),h(i,"id","check_announcements"),h(i,"type","checkbox"),h(i,"class","ml-2"),h(l,"class","mx-auto p-2"),h(u,"for","close_after_launch"),h(f,"id","close_after_launch"),h(f,"type","checkbox"),h(f,"class","ml-2"),h(c,"class","mx-auto p-2")},m(p,v){k(p,e,v),k(p,t,v),k(p,l,v),y(l,o),y(l,r),y(l,i),i.checked=n[0].check_announcements,k(p,a,v),k(p,c,v),y(c,u),y(c,d),y(c,f),f.checked=n[0].close_after_launch,_||(g=[N(e,"click",n[3]),N(i,"change",n[4]),N(f,"change",n[5])],_=!0)},p(p,[v]){v&1&&(i.checked=p[0].check_announcements),v&1&&(f.checked=p[0].close_after_launch)},i:D,o:D,d(p){p&&(b(e),b(t),b(l),b(a),b(c)),_=!1,ie(g)}}}function Js(n,e,t){let l;function o(){var u=new XMLHttpRequest;u.open("GET","/browse-data"),u.onreadystatechange=()=>{u.readyState==4&&H.info(`Browse status: '${u.responseText.trim()}'`)},u.send()}const{config:r}=q;pe(n,r,u=>t(0,l=u));const i=()=>{o()};function a(){l.check_announcements=this.checked,r.set(l)}function c(){l.close_after_launch=this.checked,r.set(l)}return[l,o,r,i,a,c]}class Ws extends de{constructor(e){super(),ue(this,e,Js,Xs,ae,{})}}function zs(n){let e,t,l,o,r,i,a,c,u,d,f,_,g,p,v,w,L,$,M;return{c(){var x,O;e=m("button"),t=m("div"),t.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,o=R(),r=m("div"),i=m("label"),i.textContent="Use custom RuneLite JAR:",a=R(),c=m("input"),u=R(),d=m("div"),f=m("textarea"),g=R(),p=m("br"),v=R(),w=m("button"),L=F("Select File"),h(t,"class","flex"),e.disabled=l=!((x=n[0])!=null&&x.session_id)||!((O=n[3])!=null&&O.accountId),h(e,"class","p-2 pb-5 hover:opacity-75"),h(i,"for","use_custom_jar"),h(c,"id","use_custom_jar"),h(c,"type","checkbox"),h(c,"class","ml-2"),h(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),h(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=_=!n[1].runelite_use_custom_jar,h(w,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),w.disabled=n[2],h(d,"class","mx-auto p-2"),ne(d,"opacity-25",!n[1].runelite_use_custom_jar)},m(x,O){k(x,e,O),y(e,t),k(x,o,O),k(x,r,O),y(r,i),y(r,a),y(r,c),c.checked=n[1].runelite_use_custom_jar,k(x,u,O),k(x,d,O),y(d,f),re(f,n[1].runelite_custom_jar),y(d,g),y(d,p),y(d,v),y(d,w),y(w,L),$||(M=[N(e,"click",n[7]),N(c,"change",n[8]),N(f,"input",n[9]),N(w,"click",n[10])],$=!0)},p(x,[O]){var T,C;O&9&&l!==(l=!((T=x[0])!=null&&T.session_id)||!((C=x[3])!=null&&C.accountId))&&(e.disabled=l),O&2&&(c.checked=x[1].runelite_use_custom_jar),O&2&&_!==(_=!x[1].runelite_use_custom_jar)&&(f.disabled=_),O&2&&re(f,x[1].runelite_custom_jar),O&4&&(w.disabled=x[2]),O&2&&ne(d,"opacity-25",!x[1].runelite_use_custom_jar)},i:D,o:D,d(x){x&&(b(e),b(o),b(r),b(u),b(d)),$=!1,ie(M)}}}function Vs(n,e,t){let l,o,r;const{config:i}=q;pe(n,i,p=>t(1,r=p));let a=!1;async function c(){t(2,a=!0),Se(i,r.runelite_custom_jar=await z.openFilePicker(),r),console.log("done picking"),t(2,a=!1)}function u(){!(l!=null&&l.session_id)||!(o!=null&&o.accountId)||!(o!=null&&o.displayName)||cn(l.session_id,o.accountId,o.displayName,!0)}const d=()=>u();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function _(){r.runelite_custom_jar=this.value,i.set(r)}const g=()=>{c()};return n.$$.update=()=>{var p;n.$$.dirty&2&&t(0,l=z.findSession(r.selected.user_id)),n.$$.dirty&3&&t(3,o=z.findAccount((l==null?void 0:l.accounts)??[],(p=r.userDetails[r.selected.user_id??""])==null?void 0:p.account_id))},[l,r,a,o,i,c,u,d,f,_,g]}class Ys extends de{constructor(e){super(),ue(this,e,Vs,zs,ae,{})}}function Zs(n){let e,t,l,o,r,i;return{c(){e=m("div"),t=m("label"),t.textContent="Enable Bolt plugin loader:",l=R(),o=m("input"),h(t,"for","enable_plugins"),h(o,"type","checkbox"),h(o,"name","enable_plugins"),h(o,"id","enable_plugins"),h(o,"class","ml-2"),h(e,"class","mx-auto p-2")},m(a,c){k(a,e,c),y(e,t),y(e,l),y(e,o),o.checked=n[0].rs_plugin_loader,r||(i=N(o,"change",n[2]),r=!0)},p(a,c){c&1&&(o.checked=a[0].rs_plugin_loader)},d(a){a&&b(e),r=!1,i()}}}function Ks(n){let e,t,l,o,r,i,a,c,u,d,f,_=P.hasBoltPlugins&&Zs(n);return{c(){_&&_.c(),e=R(),t=m("div"),l=m("label"),l.textContent="Use custom config URI:",o=R(),r=m("input"),i=R(),a=m("div"),c=m("textarea"),h(l,"for","use_custom_uri"),h(r,"id","use_custom_uri"),h(r,"type","checkbox"),h(r,"class","ml-2"),h(t,"class","mx-auto p-2"),h(c,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),c.disabled=u=!n[0].use_custom_rs_config_uri,h(c,"rows","4"),h(c,"placeholder",P.env.default_config_uri),h(a,"class","p-2")},m(g,p){_&&_.m(g,p),k(g,e,p),k(g,t,p),y(t,l),y(t,o),y(t,r),r.checked=n[0].use_custom_rs_config_uri,k(g,i,p),k(g,a,p),y(a,c),re(c,n[0].rs_config_uri),d||(f=[N(r,"change",n[3]),N(c,"input",n[4])],d=!0)},p(g,[p]){P.hasBoltPlugins&&_.p(g,p),p&1&&(r.checked=g[0].use_custom_rs_config_uri),p&1&&u!==(u=!g[0].use_custom_rs_config_uri)&&(c.disabled=u),p&1&&re(c,g[0].rs_config_uri)},i:D,o:D,d(g){g&&(b(e),b(t),b(i),b(a)),_&&_.d(g),d=!1,ie(f)}}}function Qs(n,e,t){let l;const{config:o}=q;pe(n,o,c=>t(0,l=c));function r(){l.rs_plugin_loader=this.checked,o.set(l)}function i(){l.use_custom_rs_config_uri=this.checked,o.set(l)}function a(){l.rs_config_uri=this.value,o.set(l)}return[l,o,r,i,a]}class el extends de{constructor(e){super(),ue(this,e,Qs,Ks,ae,{})}}function tl(n){let e,t;return e=new el({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),t=!0},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function nl(n){let e,t;return e=new Ys({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),t=!0},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function sl(n){let e,t;return e=new Ws({}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),t=!0},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function ll(n){let e,t,l,o,r,i,a,c,u,d,f,_,g,p,v,w,L,$,M,x;const O=[sl,nl,tl],T=[];function C(S,U){return S[1]==S[2].general?0:S[1]==S[2].osrs?1:S[1]==S[2].rs3?2:-1}return~(w=C(n))&&(L=T[w]=O[w](n)),{c(){e=m("div"),t=m("div"),l=m("button"),o=F("General"),i=R(),a=m("button"),c=F("OSRS"),d=R(),f=m("button"),_=F("RS3"),p=R(),v=m("div"),L&&L.c(),h(l,"class",r=n[1]===n[2].general?Me:je),h(a,"class",u=n[1]===n[2].osrs?Me:je),h(f,"class",g=n[1]===n[2].rs3?Me:je),h(t,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),h(v,"class","col-span-3 p-5 pt-10 text-center"),h(e,"class","grid h-full grid-cols-4")},m(S,U){k(S,e,U),y(e,t),y(t,l),y(l,o),y(t,i),y(t,a),y(a,c),y(t,d),y(t,f),y(f,_),y(e,p),y(e,v),~w&&T[w].m(v,null),$=!0,M||(x=[N(l,"click",n[4]),N(a,"click",n[5]),N(f,"click",n[6])],M=!0)},p(S,U){(!$||U&2&&r!==(r=S[1]===S[2].general?Me:je))&&h(l,"class",r),(!$||U&2&&u!==(u=S[1]===S[2].osrs?Me:je))&&h(a,"class",u),(!$||U&2&&g!==(g=S[1]===S[2].rs3?Me:je))&&h(f,"class",g);let E=w;w=C(S),w!==E&&(L&&(Ve(),G(T[E],1,1,()=>{T[E]=null}),Ye()),~w?(L=T[w],L||(L=T[w]=O[w](S),L.c()),B(L,1),L.m(v,null)):L=null)},i(S){$||(B(L),$=!0)},o(S){G(L),$=!1},d(S){S&&b(e),~w&&T[w].d(),M=!1,ie(x)}}}function ol(n){let e,t,l={class:"h-3/4 w-3/4 select-none",$$slots:{default:[ll]},$$scope:{ctx:n}};return e=new ut({props:l}),n[7](e),{c(){se(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(B(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[7](null),K(e,o)}}}let Me="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",je="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function rl(n,e,t){let l;function o(){l.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=0;const a=()=>{t(1,i=r.general)},c=()=>{t(1,i=r.osrs)},u=()=>{t(1,i=r.rs3)};function d(f){ve[f?"unshift":"push"](()=>{l=f,t(0,l)})}return[l,i,r,o,a,c,u,d]}class il extends de{constructor(e){super(),ue(this,e,rl,ol,ae,{open:3})}get open(){return this.$$.ctx[3]}}function al(n){const e=n.slice(),t=z.findSession(e[1].selected.user_id??"");return e[11]=t,e}function cl(n){let e,t,l;return{c(){e=m("button"),e.textContent="Login",h(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(o,r){k(o,e,r),t||(l=N(e,"click",n[10]),t=!0)},p:D,i:D,o:D,d(o){o&&b(e),t=!1,l()}}}function ul(n){let e,t;return e=new Fs({props:{align:"center",$$slots:{content:[fl],default:[dl]},$$scope:{ctx:n}}}),{c(){se(e.$$.fragment)},m(l,o){Z(e,l,o),t=!0},p(l,o){const r={};o&4098&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function dl(n){var o;let e,t=(((o=n[11])==null?void 0:o.user.displayName)??"No user selected")+"",l;return{c(){e=m("button"),l=F(t),h(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){k(r,e,i),y(e,l)},p(r,i){var a;i&2&&t!==(t=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&_e(l,t)},d(r){r&&b(e)}}}function fl(n){let e,t,l;return t=new As({}),{c(){e=m("div"),se(t.$$.fragment),h(e,"slot","content"),h(e,"class","w-40")},m(o,r){k(o,e,r),Z(t,e,null),l=!0},p:D,i(o){l||(B(t.$$.fragment,o),l=!0)},o(o){G(t.$$.fragment,o),l=!1},d(o){o&&b(e),K(t)}}}function pl(n){let e,t,l,o,r,i,a,c,u,d,f,_,g,p,v,w,L,$,M={};e=new il({props:M}),n[5](e);const x=[ul,cl],O=[];function T(S,U){return S[2].length>0?0:1}function C(S,U){return U===0?al(S):S}return p=T(n),v=O[p]=x[p](C(n,p)),{c(){se(e.$$.fragment),t=R(),l=m("div"),o=m("div"),r=m("button"),r.textContent="RS3",i=R(),a=m("button"),a.textContent="OSRS",c=R(),u=m("div"),d=m("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=R(),_=m("button"),_.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',g=R(),v.c(),h(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),ne(r,"text-black",n[1].selected.game===te.rs3),ne(r,"bg-blue-500",n[1].selected.game===te.rs3),h(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),ne(a,"text-black",n[1].selected.game===te.osrs),ne(a,"bg-blue-500",n[1].selected.game===te.osrs),h(o,"class","m-3 ml-9 font-bold"),h(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),h(_,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),h(u,"class","m-2 ml-auto flex gap-2"),h(l,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(S,U){Z(e,S,U),k(S,t,U),k(S,l,U),y(l,o),y(o,r),y(o,i),y(o,a),y(l,c),y(l,u),y(u,d),y(u,f),y(u,_),y(u,g),O[p].m(u,null),w=!0,L||($=[N(r,"click",n[6]),N(a,"click",n[7]),N(d,"click",n[8]),N(_,"click",n[9])],L=!0)},p(S,[U]){const E={};e.$set(E),(!w||U&2)&&ne(r,"text-black",S[1].selected.game===te.rs3),(!w||U&2)&&ne(r,"bg-blue-500",S[1].selected.game===te.rs3),(!w||U&2)&&ne(a,"text-black",S[1].selected.game===te.osrs),(!w||U&2)&&ne(a,"bg-blue-500",S[1].selected.game===te.osrs);let A=p;p=T(S),p===A?O[p].p(C(S,p),U):(Ve(),G(O[A],1,1,()=>{O[A]=null}),Ye(),v=O[p],v?v.p(C(S,p),U):(v=O[p]=x[p](C(S,p)),v.c()),B(v,1),v.m(u,null))},i(S){w||(B(e.$$.fragment,S),B(v),w=!0)},o(S){G(e.$$.fragment,S),G(v),w=!1},d(S){S&&(b(t),b(l)),n[5](null),K(e,S),O[p].d(),L=!1,ie($)}}}function _l(n,e,t){let l,o;const{config:r,sessions:i}=q;pe(n,r,p=>t(1,l=p)),pe(n,i,p=>t(2,o=p));let a;function c(p){ve[p?"unshift":"push"](()=>{a=p,t(0,a)})}return[a,l,o,r,i,c,()=>{Se(r,l.selected.game=te.rs3,l)},()=>{Se(r,l.selected.game=te.osrs,l)},()=>Se(r,l.use_dark_theme=!l.use_dark_theme,l),()=>a.open(),()=>{const{origin:p,redirect:v,clientid:w}=P.env;ke.openLoginWindow(p,v,w)}]}class gl extends de{constructor(e){super(),ue(this,e,_l,pl,ae,{})}}function hl(n){let e,t,l,o,r,i,a,c,u,d,f,_,g;return e=new zn({}),l=new gl({}),c=new Os({}),_=new Ns({props:{logs:n[0]}}),{c(){se(e.$$.fragment),t=R(),se(l.$$.fragment),o=R(),r=m("div"),i=m("div"),a=R(),se(c.$$.fragment),u=R(),d=m("div"),f=R(),se(_.$$.fragment),h(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,v){Z(e,p,v),k(p,t,v),Z(l,p,v),k(p,o,v),k(p,r,v),y(r,i),y(r,a),Z(c,r,null),y(r,u),y(r,d),k(p,f,v),Z(_,p,v),g=!0},p(p,v){const w={};v&1&&(w.logs=p[0]),_.$set(w)},i(p){g||(B(e.$$.fragment,p),B(l.$$.fragment,p),B(c.$$.fragment,p),B(_.$$.fragment,p),g=!0)},o(p){G(e.$$.fragment,p),G(l.$$.fragment,p),G(c.$$.fragment,p),G(_.$$.fragment,p),g=!1},d(p){p&&(b(t),b(o),b(r),b(f)),K(e,p),K(l,p),K(c),K(_,p)}}}function ml(n){let e,t,l,o;return e=new an({props:{$$slots:{default:[hl]},$$scope:{ctx:n}}}),{c(){se(e.$$.fragment)},m(r,i){Z(e,r,i),t=!0,l||(o=N(window,"beforeunload",n[2]),l=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){K(e,r),l=!1,o()}}}function bl(n,e,t){let l;const o=H.logs;return pe(n,o,i=>t(0,l=i)),[l,o,()=>z.saveConfig()]}class kl extends de{constructor(e){super(),ue(this,e,bl,ml,ae,{})}}const tn={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new Bn(tn):(wl(),Nn(),yl(),vl().finally(()=>{q.initialized.set(!0)}),new kl(tn));function wl(){const n=new URLSearchParams(window.location.search);P.platform=n.get("platform"),P.isFlathub=n.get("flathub")==="1",P.hasLibArchive=n.get("has_libarchive")==="1",P.rs3DebInstalledHash=n.get("rs3_deb_installed_hash"),P.rs3ExeInstalledHash=n.get("rs3_exe_installed_hash"),P.rs3AppInstalledHash=n.get("rs3_app_installed_hash"),P.osrsExeInstalledHash=n.get("osrs_exe_installed_hash"),P.osrsAppInstalledHash=n.get("osrs_app_installed_hash"),P.runeLiteInstalledId=n.get("runelite_installed_id"),P.hdosInstalledVersion=n.get("hdos_installed_version");const e=n.get("plugins");if(P.hasBoltPlugins=e!==null,e!==null)try{P.pluginList=JSON.parse(e)}catch{H.error("Unable to parse plugin list")}const t=n.get("credentials");if(t)try{const l=JSON.parse(t),o=l.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");o?q.sessions.set(l):(q.sessions.set([]),z.saveCredentials(),H.warn("Credentials saved on disk are out of date. Please sign in again.")),q.sessions.set(o?l:[])}catch{q.sessions.set([]),z.saveCredentials(),H.error("Unable to parse saved credentials. Please sign in again.")}}function yl(){const{origin:n,origin_2fa:e}=P.env,t=[window.location.origin,n,e];let l=null;window.addEventListener("message",async o=>{var r;if(!t.includes(o.origin)){H.info(`discarding window message from origin ${o.origin}`);return}switch(o.data.type){case"authTokenUpdate":{l=o.data.tokens;break}case"authSessionUpdate":{if(l===null)return H.error("auth is null. Please try again.");const i=o.data.sessionId,a=await z.login(l,i);a.ok?H.info(`Added new user '${a.value.user.displayName}'`):H.error(`Unable to add new user. Please try again. ${a.error}`),z.saveCredentials(),ke.pendingLoginWindow=null,l=null;break}case"authFailed":{H.error(`Unable to authenticate: ${o.data.reason}`),ke.pendingLoginWindow=null,l=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&H.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(o.data.url);break}case"gameClientList":me(q.config).close_after_launch&&o.data.clients.length>me(wt).length?fetch("/close"):wt.set(o.data.clients);break;default:{const i=((r=o.data)==null?void 0:r.type)??"no type provided";H.info(`Unknown message type: ${i}`);break}}})}async function vl(){const n=me(q.sessions),e=[];n.length>0&&H.info("Logging in...");for(const t of n){const l=await ke.refreshOAuthToken(t.tokens);if(!l.ok){l.error===0?H.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):(H.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),e.push(t.tokens.sub));continue}const o=l.value;t.tokens=o;const r=await z.login(o,t.session_id);r.ok?H.info(`Signed into saved user '${r.value.user.displayName}'`):(H.error(`Unable to sign into saved user '${t.user.displayName}' - please sign in again. ${r.error}`),e.push(t.tokens.sub))}e.forEach(async t=>{await z.logout(t)}),q.sessions.set(n),await z.saveCredentials()}
